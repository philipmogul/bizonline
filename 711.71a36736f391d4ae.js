"use strict";(self.webpackChunkmatngular=self.webpackChunkmatngular||[]).push([[711],{3711:(H,u,a)=>{a.r(u),a.d(u,{LocationsModule:()=>B});var f=a(4397),m=a(2318),c=a(7340),t=a(4650),g=a(8423),b=a(3166),v=a(7185),T=a(1927),C=a(1932),p=a(805),h=a(6895),r=a(4006),y=a(1493),x=a(2137),M=a(5593),Z=a(3087),w=a(1740),L=a(5369);function I(i,l){if(1&i){const o=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(o);const n=t.oxw(2);return t.KtG(n.displayNewItemDialog=!0)}),t.qZA()}}function S(i,l){1&i&&(t.TgZ(0,"tr",30)(1,"th"),t._uU(2,"Location name"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Color "),t.qZA(),t._UZ(5,"th",31),t.qZA())}function E(i,l){if(1&i){const o=t.EpF();t.TgZ(0,"button",36),t.NdJ("click",function(){t.CHM(o);const n=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.confirmDelete(n))}),t.qZA()}}function D(i,l){if(1&i){const o=t.EpF();t.TgZ(0,"tr",32)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td")(5,"p-colorPicker",33),t.NdJ("ngModelChange",function(n){const d=t.CHM(o).$implicit;return t.KtG(d.color=n)}),t.qZA()(),t.TgZ(6,"td")(7,"button",34),t.NdJ("click",function(){const s=t.CHM(o).$implicit,d=t.oxw(2);return t.KtG(d.edit(s))}),t.qZA(),t.YNc(8,E,1,0,"button",35),t.qZA()()}if(2&i){const o=l.$implicit,e=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,3,o.name)," "),t.xp6(3),t.Q6J("ngModel",o.color),t.xp6(3),t.Q6J("ngIf",e.showNewButton)}}const J=function(){return[10,25,50]},A=function(){return["name","description"]};function N(i,l){if(1&i&&(t.TgZ(0,"div",4),t._UZ(1,"div",18),t.TgZ(2,"div",19)(3,"div",20)(4,"div",21)(5,"h4",22),t._uU(6," Stock locations "),t.YNc(7,I,1,0,"button",23),t.qZA()(),t.TgZ(8,"div",24)(9,"p-table",25,26),t.YNc(11,S,6,0,"ng-template",27),t.YNc(12,D,9,5,"ng-template",28),t.qZA()()()()()),2&i){const o=t.oxw();t.xp6(3),t.Q6J("@enter",void 0),t.xp6(4),t.Q6J("ngIf",o.showNewButton),t.xp6(2),t.Q6J("value",o.locations)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(10,J))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(11,A))}}const _=function(){return{width:"25vw"}};function k(i,l){if(1&i){const o=t.EpF();t.TgZ(0,"p-dialog",37),t.NdJ("visibleChange",function(n){t.CHM(o);const s=t.oxw();return t.KtG(s.displayEditItemDialog=n)}),t.TgZ(1,"form",2,3),t.NdJ("ngSubmit",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.updateItem())}),t.TgZ(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7)(7,"label",8),t._uU(8,"Location name"),t.qZA(),t.TgZ(9,"input",9),t.NdJ("ngModelChange",function(n){t.CHM(o);const s=t.oxw();return t.KtG(s.itemToEditModel.name=n)}),t.qZA()(),t.TgZ(10,"div",7)(11,"label",8),t._uU(12,"Location color"),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"p-colorPicker",10),t.NdJ("ngModelChange",function(n){t.CHM(o);const s=t.oxw();return t.KtG(s.itemToEditModel.color=n)})("onChange",function(n){t.CHM(o);const s=t.oxw();return t.KtG(s.changeColor2(n))}),t.qZA()()()()(),t.TgZ(15,"p-footer"),t._UZ(16,"button",11),t.TgZ(17,"button",12),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.hideEditDialog())}),t.qZA()()(),t.TgZ(18,"ngx-spinner",38),t._UZ(19,"p",14),t.qZA()()}if(2&i){const o=t.MAs(2),e=t.oxw();t.Akn(t.DdM(9,_)),t.Q6J("closable",!1)("visible",e.displayEditItemDialog)("baseZIndex",1e4),t.xp6(9),t.Q6J("ngModel",e.itemToEditModel.name),t.xp6(5),t.Q6J("ngModel",e.itemToEditModel.color),t.xp6(2),t.Q6J("disabled",!o.valid||null==e.itemToEditModel.name||null==e.itemToEditModel.color),t.xp6(2),t.Q6J("fullScreen",!1)}}const P=function(){return{width:"30vw"}},U=[{path:"",component:(()=>{class i{constructor(o,e,n,s,d,Y,F){this.spinner=o,this.cryptoSrv=e,this.toastr=n,this.authSrv=s,this.apiSrv=d,this.confirmationService=Y,this.cdr=F,this.loading=!0,this.displayNewItemDialog=!1,this.newItemModel={},this.displayEditItemDialog=!1,this.showNewButton=!1}ngOnInit(){this.loading=!0,"1"===this.cryptoSrv.decryptEncodedText(this.authSrv.getRoleToken("managing_shop_locations"))||"admin"===this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("role"))?this.getLocations():(this.toastr.error("You have no rights to access that page!"),this.authSrv.logout())}getLocations(){this.spinner.show();const o={action:this.cryptoSrv.encodeEncryptText("get-shop-locations"),uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(o).then(e=>{"error"!=e.status?"error2"!=e.status?(this.locations=e.locations,this.spinner.hide(),this.loading=!1):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(e.message))}).catch(e=>{this.toastr.error(e),this.spinner.hide()})}changeColor(o){this.newItemModel.color=o.value}addItem(){this.spinner.show("new");const o={action:this.cryptoSrv.encodeEncryptText("add_shop_location"),added_by:this.authSrv.getUserDetailToken("uid"),location:this.cryptoSrv.encodeEncryptText(this.newItemModel.name),color:this.cryptoSrv.encodeEncryptText(this.newItemModel.color)};this.apiSrv.post(o).then(e=>{if("error"!=e.status)if("error2"!=e.status){const n=new Date;this.locations.push({id:e.id,name:this.newItemModel.name,color:this.newItemModel.color,date_created:n}),this.toastr.success("Location added!"),this.newItemModel={},this.displayNewItemDialog=!1}else this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.toastr.error(e.message);this.spinner.hide("new")}).catch(e=>{this.toastr.error(e),this.spinner.hide("new")})}edit(o){this.itemToEditModelDefault=this.apiSrv.deepCopy(o),this.itemToEditModel=o,this.displayEditItemDialog=!0}hideNewItemDialog(){this.displayNewItemDialog=!1,this.newItemModel={},this.newItemModel.color=null}hideEditDialog(){const o=this.locations.find(({id:n})=>n===this.itemToEditModel.id),e=this.locations.indexOf(o);this.locations[e]=this.itemToEditModelDefault,this.displayEditItemDialog=!1}confirmDelete(o){this.confirmationService.confirm({message:"Are you sure you want to delete this location? Any prevoius sales for this location will retain the location name!",acceptButtonStyleClass:"p-button-primary p-button-sm",rejectButtonStyleClass:"p-button-danger p-button-sm",acceptLabel:"Delete",rejectLabel:"Cancel",accept:()=>{this.delete(o)},reject:()=>{}})}delete(o){this.spinner.show();const e={action:this.cryptoSrv.encodeEncryptText("delete_shop_location"),added_by:this.authSrv.getUserDetailToken("uid"),id:o.id,name:this.cryptoSrv.encodeEncryptText(o.name)};this.apiSrv.post(e).then(n=>{"error"!=n.status?"error2"!=n.status?(this.toastr.success("Location deleted!"),this.locations=this.locations.filter(s=>s.id!==o.id)):(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):this.toastr.error(n.message),this.spinner.hide()}).catch(n=>{this.toastr.error(n),this.spinner.hide()})}changeColor2(o){this.itemToEditModel.color=o.value}updateItem(){this.spinner.show("edit");const o={action:this.cryptoSrv.encodeEncryptText("update_shop_location"),added_by:this.authSrv.getUserDetailToken("uid"),id:this.itemToEditModel.id,location:this.cryptoSrv.encodeEncryptText(this.itemToEditModel.name),color:this.cryptoSrv.encodeEncryptText(this.itemToEditModel.color)};this.apiSrv.post(o).then(e=>{"error"!=e.status?"error2"!=e.status?(this.toastr.success("Location updated!"),this.displayEditItemDialog=!1):(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):this.toastr.error(e.message),this.spinner.hide("edit")}).catch(e=>{this.toastr.error(e),this.spinner.hide("edit")})}}return i.\u0275fac=function(o){return new(o||i)(t.Y36(g.t2),t.Y36(b.$),t.Y36(v._W),t.Y36(T.e),t.Y36(C.s),t.Y36(p.YP),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-locations"]],decls:25,vars:17,consts:[["class","row",4,"ngIf"],["appendTo","body","modal","true","header","New location",3,"closable","visible","baseZIndex","visibleChange"],["autocomplete","off",3,"ngSubmit"],["form2","ngForm"],[1,"row"],[1,"col-md-12"],[1,"ui-fluid"],[1,"p-field","pb-3"],["for","firstname3"],["id","firstname3","name","name","required","","type","text","pInputText","",1,"form-control",3,"ngModel","ngModelChange"],["appendTo","body","format","hex","name","color","styleClass","p-colorpicker-preview",3,"ngModel","ngModelChange","onChange"],["type","submit","pButton","","icon","pi pi-check","label","Save",1,"p-button-success","p-button-sm","float-right",3,"disabled"],["type","button","pButton","","icon","pi pi-times","label","Cancel",1,"ui-button-danger","p-button-danger","mr-3","p-button-sm","float-right",3,"click"],["bdOpacity","#fff","name","new","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[2,"color","#02926e"],["appendTo","body","modal","true","header","Edit location",3,"closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],["bdOpacity","#fff","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["header","Confirm","icon","pi pi-exclamation-triangle","appendTo","body",3,"baseZIndex"],[1,"col-md-3"],[1,"col-md-6"],[1,"card"],[1,"card-header"],[1,"card-title","mb-4"],["pButton","","type","button","icon","pi pi-plus","label","Add a new location","class","p-button-success p-button-sm float-right mb-2",3,"click",4,"ngIf"],[1,"card-body","p-0","m-0"],["styleClass","p-datatable-customers","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","filterDelay","globalFilterFields"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pButton","","type","button","icon","pi pi-plus","label","Add a new location",1,"p-button-success","p-button-sm","float-right","mb-2",3,"click"],[1,"ui-selectable-row"],[2,"width","20rem"],[2,"word-wrap","normal"],["disabled","true",3,"ngModel","ngModelChange"],["pButton","","type","button","icon","pi pi-pencil","label","Edit",1,"p-button-success","p-button-sm","p-button-outlined",3,"click"],["pButton","","type","button","icon","pi pi-trash","label","Delete","class","p-button-danger p-button-sm p-button-outlined float-right",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-trash","label","Delete",1,"p-button-danger","p-button-sm","p-button-outlined","float-right",3,"click"],["appendTo","body","modal","true","header","Edit location",3,"closable","visible","baseZIndex","visibleChange"],["bdOpacity","#fff","name","edit","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"]],template:function(o,e){if(1&o&&(t.YNc(0,N,13,12,"div",0),t.TgZ(1,"p-dialog",1),t.NdJ("visibleChange",function(s){return e.displayNewItemDialog=s}),t.TgZ(2,"form",2,3),t.NdJ("ngSubmit",function(){return e.addItem()}),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"label",8),t._uU(9,"Location name"),t.qZA(),t.TgZ(10,"input",9),t.NdJ("ngModelChange",function(s){return e.newItemModel.name=s}),t.qZA()(),t.TgZ(11,"div",7)(12,"label",8),t._uU(13,"Location color"),t.qZA(),t._UZ(14,"br"),t.TgZ(15,"p-colorPicker",10),t.NdJ("ngModelChange",function(s){return e.newItemModel.color=s})("onChange",function(s){return e.changeColor(s)}),t.qZA()()()()(),t.TgZ(16,"p-footer"),t._UZ(17,"button",11),t.TgZ(18,"button",12),t.NdJ("click",function(){return e.hideNewItemDialog()}),t.qZA()()(),t.TgZ(19,"ngx-spinner",13),t._UZ(20,"p",14),t.qZA()(),t.YNc(21,k,20,10,"p-dialog",15),t.TgZ(22,"ngx-spinner",16),t._UZ(23,"p",14),t.qZA(),t._UZ(24,"p-confirmDialog",17)),2&o){const n=t.MAs(3);t.Q6J("ngIf",!e.loading),t.xp6(1),t.Akn(t.DdM(15,_)),t.Q6J("closable",!1)("visible",e.displayNewItemDialog)("baseZIndex",1e4),t.xp6(9),t.Q6J("ngModel",e.newItemModel.name),t.xp6(5),t.Q6J("ngModel",e.newItemModel.color),t.xp6(2),t.Q6J("disabled",!n.valid||null==e.newItemModel.name||null==e.newItemModel.color),t.xp6(2),t.Q6J("fullScreen",!1),t.xp6(2),t.Q6J("ngIf",e.displayEditItemDialog),t.xp6(1),t.Q6J("fullScreen",!0),t.xp6(2),t.Akn(t.DdM(16,P)),t.Q6J("baseZIndex",1e4)}},dependencies:[h.O5,g.Ro,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.On,r.F,y.V,p.$_,p.jx,x.Q,M.Hq,Z.iA,w.o,L.zH,h.rS],styles:["label[_ngcontent-%COMP%]{text-transform:none}[_nghost-%COMP%]     p-colorpicker .p-colorpicker .p-colorpicker-preview{border-radius:30px}[_nghost-%COMP%]     p-dialog .p-dialog-header{border-radius:30px!important}[_nghost-%COMP%]     .p-dialog .p-dialog-footer{border-bottom-right-radius:30px}"],data:{animation:[(0,c.X$)("enter",[(0,c.eR)("void => *",[(0,c.oB)({opacity:0}),(0,c.jt)(1e3,(0,c.oB)({opacity:1}))])])]}}),i})(),data:{title:"Locations"}}];let Q=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[m.Bz.forChild(U),m.Bz]}),i})(),B=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[Q,f.U]}),i})()}}]);