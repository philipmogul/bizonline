"use strict";(self.webpackChunkmatngular=self.webpackChunkmatngular||[]).push([[725],{6725:(je,q,r)=>{r.r(q),r.d(q,{InterlocationModule:()=>Fe});var M=r(2318),t=r(4650),T=r(7340),k=r(2340),u=r(6895),v=r(2841),R=r(6498),U=r(8423),P=r(3166),G=r(7185),O=r(1927),H=r(1932),w=r(805),K=r(9775),m=r(4006),B=r(1493),$=r(2137),E=r(5593),h=r(3087),V=r(5722),j=r(1740),z=r(666),X=r(3608),W=r(2435),tt=r(8558),et=r(8271),ot=r(2665),it=r(613);const nt=["op"],lt=["op1"];function at(i,a){if(1&i&&(t.TgZ(0,"div",42)(1,"span"),t._uU(2),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.name)}}function st(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",32)(1,"th",33),t._uU(2,"Item "),t._UZ(3,"p-sortIcon",34),t.qZA(),t.TgZ(4,"th",35),t._uU(5,"Category "),t._UZ(6,"p-sortIcon",36),t.qZA(),t.TgZ(7,"th",37),t._uU(8,"Locations "),t.qZA(),t._UZ(9,"th",38),t.qZA(),t.TgZ(10,"tr")(11,"th")(12,"input",39),t.NdJ("input",function(n){t.CHM(e),t.oxw();const l=t.MAs(10);return t.KtG(l.filter(n.target.value,"name","contains"))}),t.qZA()(),t.TgZ(13,"th")(14,"p-multiSelect",40),t.NdJ("onChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.onCategoryChange(n))}),t.YNc(15,at,3,1,"ng-template",41),t.qZA()(),t._UZ(16,"th")(17,"th"),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(14),t.Q6J("options",e.categories)}}const p=function(i){return{"background-color":i,color:"#ffffff",cursor:"pointer"}};function rt(i,a){if(1&i&&t._UZ(0,"p-avatar",50),2&i){const e=a.index,o=t.oxw(4);t.Akn(t.VKq(2,p,o.locations[e].color))}}const b=function(){return[]};function ct(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-avatarGroup",48),t.NdJ("click",function(n){t.CHM(e);const l=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.showLocationsQuantity(l,n))}),t.YNc(1,rt,1,4,"p-avatar",49),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",t.DdM(1,b).constructor(e.locations_count))}}function _t(i,a){1&i&&(t.TgZ(0,"small",51),t._uU(1," Missing units "),t.qZA())}function pt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-button",52),t.NdJ("onClick",function(){t.CHM(e);const n=t.oxw().$implicit,l=t.oxw(2);return t.KtG(l.selectItem(n))}),t.qZA()}if(2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.Q6J("loading",null!=o.itemToViewLocations&&o.itemToViewLocations.id===e.id&&o.loading2)}}function dt(i,a){1&i&&t._UZ(0,"p-message",53)}function ut(i,a){if(1&i&&(t.TgZ(0,"tr",43)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"titlecase"),t.qZA(),t.TgZ(7,"td"),t.YNc(8,ct,2,2,"p-avatarGroup",44),t.YNc(9,_t,2,0,"small",45),t.qZA(),t.TgZ(10,"td"),t.YNc(11,pt,1,1,"p-button",46),t.YNc(12,dt,1,0,"p-message",47),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,6,e.name)," "),t.xp6(3),t.hij(" ",t.lcZ(6,8,e.category.name)," "),t.xp6(3),t.Q6J("ngIf",e.locations_count>0&&1==e.min_unit_ok),t.xp6(1),t.Q6J("ngIf",e.units<1||0==e.min_unit_ok),t.xp6(2),t.Q6J("ngIf",e.locations_count>0&&e.units>0&&1==e.min_unit_ok),t.xp6(1),t.Q6J("ngIf",e.units<1||e.locations_count<1||0==e.min_unit_ok)}}function mt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",32)(1,"th",54),t._uU(2,"Item "),t._UZ(3,"p-sortIcon",34),t.qZA(),t.TgZ(4,"th",37),t._uU(5,"Location from "),t.qZA(),t.TgZ(6,"th",37),t._uU(7,"Location to "),t.qZA(),t.TgZ(8,"th",37),t._uU(9,"Unit "),t.qZA(),t.TgZ(10,"th",37),t._uU(11,"Qty "),t.qZA(),t._UZ(12,"th",38),t.qZA(),t.TgZ(13,"tr")(14,"th")(15,"input",39),t.NdJ("input",function(n){t.CHM(e),t.oxw();const l=t.MAs(20);return t.KtG(l.filter(n.target.value,"item.name","contains"))}),t.qZA()(),t._UZ(16,"th")(17,"th")(18,"th")(19,"th")(20,"th"),t.qZA()}}function ht(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",43)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td")(5,"p-avatarGroup"),t._UZ(6,"p-avatar",55),t.qZA()(),t.TgZ(7,"td")(8,"p-avatarGroup"),t._UZ(9,"p-avatar",56),t.qZA()(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"titlecase"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"number"),t.qZA(),t.TgZ(16,"td")(17,"p-button",57),t.NdJ("onClick",function(){const l=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.confirmDelete(l))}),t.qZA()()()}if(2&i){const e=a.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,7,e.item.name)," "),t.xp6(4),t.Akn(t.VKq(13,p,e.location_from.color)),t.xp6(3),t.Akn(t.VKq(15,p,e.location_to.color)),t.xp6(2),t.hij(" ",t.lcZ(12,9,e.unit.unit_name)," "),t.xp6(3),t.hij(" ",t.lcZ(15,11,e.unit_quantity)," ")}}function gt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",58)(1,"div",59)(2,"div",60)(3,"div",61)(4,"p-radioButton",62),t.NdJ("ngModelChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.printReceipt=n)}),t.qZA(),t.TgZ(5,"label",63),t._uU(6,"Print receipt"),t.qZA()(),t.TgZ(7,"div",61)(8,"p-radioButton",64),t.NdJ("ngModelChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.printReceipt=n)}),t.qZA(),t.TgZ(9,"label",65),t._uU(10,"No receipt"),t.qZA()()(),t.TgZ(11,"div",66)(12,"button",67),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.complete())}),t.qZA()()()()}if(2&i){const e=t.oxw(2);t.xp6(4),t.Q6J("ngModel",e.printReceipt),t.xp6(4),t.Q6J("ngModel",e.printReceipt)}}const Z=function(){return[10,25,50]},I=function(){return["name","description"]};function ft(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",7)(1,"div",18)(2,"p-button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.getReprintData())}),t.qZA()(),t.TgZ(3,"div",20)(4,"div",21)(5,"div",22)(6,"h4",23),t._uU(7," Select item to transfer "),t.qZA()(),t.TgZ(8,"div",24)(9,"p-table",25,26),t.YNc(11,st,18,1,"ng-template",27),t.YNc(12,ut,13,10,"ng-template",28),t.qZA()()()(),t.TgZ(13,"div",20)(14,"div",21)(15,"div",22)(16,"h4",23),t._uU(17," Items selected "),t.qZA()(),t.TgZ(18,"div",24)(19,"p-table",25,29),t.YNc(21,mt,21,0,"ng-template",27),t.YNc(22,ht,18,17,"ng-template",28),t.qZA(),t.TgZ(23,"div",30),t.YNc(24,gt,13,2,"div",31),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("@enter",void 0),t.xp6(3),t.Q6J("@enter",void 0),t.xp6(5),t.Q6J("value",e.allStock)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(20,Z))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(21,I)),t.xp6(5),t.Q6J("@enter",void 0),t.xp6(5),t.Q6J("value",e.cartItems)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(22,Z))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(23,I)),t.xp6(5),t.Q6J("ngIf",e.cartItems.length>0)}}function xt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"th",72),t._uU(2,"Name"),t.qZA(),t.TgZ(3,"th",73),t._uU(4,"Quantity"),t.qZA(),t.TgZ(5,"th",37),t._uU(6,"From"),t.qZA(),t.TgZ(7,"th",37),t._uU(8,"To"),t.qZA(),t.TgZ(9,"th",73),t._uU(10,"Unit"),t.qZA(),t.TgZ(11,"th",37),t._uU(12,"Unit Qty"),t.qZA(),t._UZ(13,"th",38),t.qZA(),t.TgZ(14,"tr")(15,"th")(16,"input",74),t.NdJ("input",function(n){t.CHM(e),t.oxw();const l=t.MAs(10);return t.KtG(l.filterGlobal(n.target.value,"contains"))}),t.qZA()(),t._UZ(17,"th",75),t.qZA()}}function Tt(i,a){if(1&i&&t._UZ(0,"p-avatar",50),2&i){const e=a.index,o=t.oxw(4);t.Akn(t.VKq(2,p,o.locations[e].color))}}function vt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-avatarGroup",48),t.NdJ("click",function(n){t.CHM(e);const l=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.showLocationsQuantityNew(l,n))}),t.YNc(1,Tt,1,4,"p-avatar",49),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",t.DdM(1,b).constructor(e.locations_count))}}function Zt(i,a){1&i&&(t.TgZ(0,"small",51),t._uU(1," Missing units "),t.qZA())}function yt(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.location.name))}}function It(i,a){if(1&i&&(t.TgZ(0,"div",83)(1,"div"),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,e.location.name))}}function St(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-dropdown",81),t.NdJ("onChange",function(n){t.CHM(e);const l=t.oxw(4);return t.KtG(l.newLocationSelected1(n))})("ngModelChange",function(n){t.CHM(e);const l=t.oxw(4);return t.KtG(l.selectedItem.location1=n)}),t.YNc(1,yt,3,3,"ng-template",82),t.YNc(2,It,4,3,"ng-template",41),t.qZA()}if(2&i){const e=t.oxw(2).$implicit,o=t.oxw(2);t.Q6J("options",o.selectedItem.locations)("disabled",0==e.min_unit_ok)("ngModel",o.selectedItem.location1)("filter",!1)}}function Ct(i,a){if(1&i&&(t._uU(0),t.ALo(1,"titlecase")),2&i){const e=t.oxw(4);t.hij(" ",e.selectedItem.location1?t.lcZ(1,1,e.selectedItem.location1.location.name):""," ")}}function wt(i,a){1&i&&(t.TgZ(0,"p-cellEditor"),t.YNc(1,St,3,4,"ng-template",79),t.YNc(2,Ct,2,3,"ng-template",80),t.qZA())}function bt(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.name))}}function At(i,a){if(1&i&&(t.TgZ(0,"div",83)(1,"div"),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,e.name))}}function qt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-dropdown",84),t.NdJ("onChange",function(n){t.CHM(e);const l=t.oxw(4);return t.KtG(l.newLocationSelected2(n))})("ngModelChange",function(n){t.CHM(e);const l=t.oxw(4);return t.KtG(l.selectedItem.location2=n)}),t.YNc(1,bt,3,3,"ng-template",82),t.YNc(2,At,4,3,"ng-template",41),t.qZA()}if(2&i){const e=t.oxw(2).$implicit,o=t.oxw(2);t.Q6J("options",o.locations)("disabled",0==e.min_unit_ok||null==o.selectedItem.location1)("ngModel",o.selectedItem.location2)("filter",!1)}}function Mt(i,a){if(1&i&&(t._uU(0),t.ALo(1,"titlecase")),2&i){const e=t.oxw(4);t.hij(" ",e.selectedItem.location2?t.lcZ(1,1,e.selectedItem.location2.name):""," ")}}function kt(i,a){1&i&&(t.TgZ(0,"p-cellEditor"),t.YNc(1,qt,3,4,"ng-template",79),t.YNc(2,Mt,2,3,"ng-template",80),t.qZA())}function Ut(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Oqu(e.unit_name)}}function Et(i,a){if(1&i&&(t.TgZ(0,"div",83)(1,"div"),t._uU(2),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.unit_name)}}function Nt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-dropdown",85),t.NdJ("onChange",function(n){t.CHM(e);const l=t.oxw(4);return t.KtG(l.newUnitSelected(n))})("ngModelChange",function(n){t.CHM(e);const l=t.oxw(4);return t.KtG(l.selectedItem.unit=n)})("keydown.enter",function(n){t.CHM(e);const l=t.oxw(2).$implicit,s=t.oxw(2);return t.KtG(s.focusNext1(n,"qty2"+s.getName(l.name)))}),t.YNc(1,Ut,2,1,"ng-template",82),t.YNc(2,Et,3,1,"ng-template",41),t.qZA()}if(2&i){const e=t.oxw(4);t.Q6J("options",e.selectedItem.selling_units)("disabled",e.selectedItem.selling_units.length<1||null==e.selectedItem.location1||null==e.selectedItem.location2)("ngModel",e.selectedItem.unit)("filter",!1)}}function Dt(i,a){if(1&i&&t._uU(0),2&i){const e=t.oxw(4);t.hij(" ",e.selectedItem.unit?e.selectedItem.unit.unit_name:""," ")}}function Lt(i,a){1&i&&(t.TgZ(0,"p-cellEditor"),t.YNc(1,Nt,3,4,"ng-template",79),t.YNc(2,Dt,1,1,"ng-template",80),t.qZA())}function Jt(i,a){if(1&i&&(t.TgZ(0,"p",88)(1,"small",89)(2,"i",90),t._uU(3),t.qZA()()()),2&i){const e=t.oxw(5);t.xp6(3),t.Oqu(e.quantityError)}}function Qt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"input",86),t.NdJ("ngModelChange",function(n){t.CHM(e);const l=t.oxw(4);return t.KtG(l.selectedItem.sell_qty=n)})("input",function(){t.CHM(e);const n=t.oxw(4);return t.KtG(n.confirmQuantityNew())}),t.qZA(),t.YNc(1,Jt,4,1,"p",87)}if(2&i){const e=t.oxw(2).$implicit,o=t.oxw(2);t.MGl("id","qty2",o.getName(e.name),""),t.Q6J("ngModel",o.selectedItem.sell_qty),t.xp6(1),t.Q6J("ngIf",""!=o.quantityError)}}function Ft(i,a){if(1&i&&(t._uU(0),t.ALo(1,"number")),2&i){const e=t.oxw(4);t.hij(" ",t.lcZ(1,1,e.selectedItem.sell_qty)," ")}}function Yt(i,a){1&i&&(t.TgZ(0,"p-cellEditor"),t.YNc(1,Qt,2,3,"ng-template",79),t.YNc(2,Ft,2,3,"ng-template",80),t.qZA())}function Rt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",96),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,l=t.oxw(2);return t.KtG(l.onRowEditInit(n))}),t.qZA()}}function Pt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",97),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,l=t.oxw(2);return t.KtG(l.onRowEditSave(n))}),t.qZA()}if(2&i){const e=t.oxw(2).$implicit,o=t.oxw(2);t.MGl("id","save2",o.getName(e.name),""),t.Q6J("disabled",""!=o.quantityError||o.selectedItem.sell_qty<1||null==o.selectedItem.location1||null==o.selectedItem.location2||!o.confirmQuantityIsNumber())}}function Gt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",98),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2),l=n.$implicit,s=n.rowIndex,_=t.oxw(2);return t.KtG(_.onRowEditCancel(l,s))}),t.qZA()}}function Ot(i,a){1&i&&t._UZ(0,"div",99)}function Ht(i,a){if(1&i&&(t.TgZ(0,"div",91),t.YNc(1,Rt,1,0,"button",92),t.YNc(2,Pt,1,2,"button",93),t.YNc(3,Gt,1,0,"button",94),t.YNc(4,Ot,1,0,"div",95),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.id!=o.selectedItem.id&&o.loaderToShow!=e.id),t.xp6(1),t.Q6J("ngIf",e.id==o.selectedItem.id&&o.loaderToShow!=e.id),t.xp6(1),t.Q6J("ngIf",e.id==o.selectedItem.id&&o.loaderToShow!=e.id),t.xp6(1),t.Q6J("ngIf",o.loaderToShow==e.id)}}function Kt(i,a){if(1&i&&(t.TgZ(0,"tr",76)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t.YNc(5,vt,2,2,"p-avatarGroup",44),t.YNc(6,Zt,2,0,"small",45),t.qZA(),t.TgZ(7,"td"),t.YNc(8,wt,3,0,"p-cellEditor",77),t.qZA(),t.TgZ(9,"td"),t.YNc(10,kt,3,0,"p-cellEditor",77),t.qZA(),t.TgZ(11,"td"),t.YNc(12,Lt,3,0,"p-cellEditor",77),t.qZA(),t.TgZ(13,"td"),t.YNc(14,Yt,3,0,"p-cellEditor",77),t.qZA(),t.TgZ(15,"td"),t.YNc(16,Ht,5,4,"div",78),t.qZA()()),2&i){const e=a.$implicit,o=t.oxw(2);t.Q6J("pEditableRow",e),t.xp6(2),t.hij(" ",t.lcZ(3,9,e.name)," "),t.xp6(3),t.Q6J("ngIf",e.locations_count>0&&1==e.min_unit_ok),t.xp6(1),t.Q6J("ngIf",0==e.min_unit_ok),t.xp6(2),t.Q6J("ngIf",e.id==o.selectedItem.id),t.xp6(2),t.Q6J("ngIf",e.id==o.selectedItem.id),t.xp6(2),t.Q6J("ngIf",e.id==o.selectedItem.id&&o.selectedItem.selling_units),t.xp6(2),t.Q6J("ngIf",e.id==o.selectedItem.id),t.xp6(2),t.Q6J("ngIf",e.locations_count>0)}}function Bt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",32)(1,"th",54),t._uU(2,"Item "),t._UZ(3,"p-sortIcon",34),t.qZA(),t.TgZ(4,"th",37),t._uU(5,"Location from "),t.qZA(),t.TgZ(6,"th",37),t._uU(7,"Location to "),t.qZA(),t.TgZ(8,"th",37),t._uU(9,"Unit "),t.qZA(),t.TgZ(10,"th",37),t._uU(11,"Qty "),t.qZA(),t._UZ(12,"th",38),t.qZA(),t.TgZ(13,"tr")(14,"th")(15,"input",39),t.NdJ("input",function(n){t.CHM(e),t.oxw();const l=t.MAs(20);return t.KtG(l.filter(n.target.value,"item.name","contains"))}),t.qZA()(),t._UZ(16,"th")(17,"th")(18,"th")(19,"th")(20,"th"),t.qZA()}}function $t(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",43)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td")(5,"p-avatarGroup"),t._UZ(6,"p-avatar",55),t.qZA()(),t.TgZ(7,"td")(8,"p-avatarGroup"),t._UZ(9,"p-avatar",56),t.qZA()(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"titlecase"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"number"),t.qZA(),t.TgZ(16,"td")(17,"p-button",57),t.NdJ("onClick",function(){const l=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.confirmDelete(l))}),t.qZA()()()}if(2&i){const e=a.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,7,e.item.name)," "),t.xp6(4),t.Akn(t.VKq(13,p,e.location_from.color)),t.xp6(3),t.Akn(t.VKq(15,p,e.location_to.color)),t.xp6(2),t.hij(" ",t.lcZ(12,9,e.unit.unit_name)," "),t.xp6(3),t.hij(" ",t.lcZ(15,11,e.unit_quantity)," ")}}function Vt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",58)(1,"div",59)(2,"div",60)(3,"div",61)(4,"p-radioButton",62),t.NdJ("ngModelChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.printReceipt=n)}),t.qZA(),t.TgZ(5,"label",63),t._uU(6,"Print receipt"),t.qZA()(),t.TgZ(7,"div",61)(8,"p-radioButton",64),t.NdJ("ngModelChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.printReceipt=n)}),t.qZA(),t.TgZ(9,"label",65),t._uU(10,"No receipt"),t.qZA()()(),t.TgZ(11,"div",66)(12,"button",67),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.complete())}),t.qZA()()()()}if(2&i){const e=t.oxw(2);t.xp6(4),t.Q6J("ngModel",e.printReceipt),t.xp6(4),t.Q6J("ngModel",e.printReceipt)}}const jt=function(){return[15,25,50]},zt=function(){return["name"]};function Xt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",7)(1,"div",18)(2,"p-button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.getReprintData())}),t.qZA()(),t.TgZ(3,"div",68)(4,"div",21)(5,"div",22)(6,"h4",23),t._uU(7," Select item to sell "),t.qZA()(),t.TgZ(8,"div",24)(9,"p-table",69,70),t.YNc(11,xt,18,0,"ng-template",27),t.YNc(12,Kt,17,11,"ng-template",28),t.qZA()()()(),t.TgZ(13,"div",71)(14,"div",21)(15,"div",22)(16,"h4",23),t._uU(17," Items selected "),t.qZA()(),t.TgZ(18,"div",24)(19,"p-table",25,29),t.YNc(21,Bt,21,0,"ng-template",27),t.YNc(22,$t,18,17,"ng-template",28),t.qZA(),t.TgZ(23,"div",30),t.YNc(24,Vt,13,2,"div",31),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("@enter",void 0),t.xp6(3),t.Q6J("@enter",void 0),t.xp6(5),t.Q6J("value",e.newStock)("rows",15)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(19,jt))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(20,zt)),t.xp6(5),t.Q6J("@enter",void 0),t.xp6(5),t.Q6J("value",e.cartItems)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(21,Z))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(22,I)),t.xp6(5),t.Q6J("ngIf",e.cartItems.length>0)}}function Wt(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Oqu(e.location.name)}}function te(i,a){if(1&i&&(t.TgZ(0,"div",83)(1,"div"),t._uU(2),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.location.name)}}function ee(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Oqu(e.unit_name)}}function oe(i,a){if(1&i&&(t.TgZ(0,"div",83)(1,"div"),t._uU(2),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.unit_name)}}function ie(i,a){1&i&&(t.TgZ(0,"tr")(1,"th",121),t._uU(2,"Available"),t.qZA()())}function ne(i,a){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"number"),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,2,e[0])),t.xp6(3),t.Oqu(t.lcZ(6,4,e[1]))}}function le(i,a){if(1&i&&(t.TgZ(0,"div",106)(1,"p-table",120),t.YNc(2,ie,3,0,"ng-template",27),t.YNc(3,ne,7,6,"ng-template",28),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("value",e.availableUnits)("paginator",!1)("rows",10)}}function ae(i,a){if(1&i&&(t.TgZ(0,"small",122),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.quantityError," ")}}function se(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Oqu(e.name)}}function re(i,a){if(1&i&&(t.TgZ(0,"div",83)(1,"div"),t._uU(2),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.Oqu(e.name)}}function ce(i,a){if(1&i&&(t.TgZ(0,"small",123),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.locationError," ")}}function _e(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"form",103,104),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.addToCart())}),t.TgZ(2,"div",7)(3,"div",10)(4,"div",105)(5,"div",7)(6,"div",106)(7,"div",107)(8,"label",108),t._uU(9,"Location to sell item"),t.qZA(),t._UZ(10,"br"),t.TgZ(11,"p-dropdown",109),t.NdJ("onChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.updateLocationSelected(n))})("ngModelChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.itemToSellModel.location_from=n)}),t.YNc(12,Wt,2,1,"ng-template",82),t.YNc(13,te,3,1,"ng-template",41),t.qZA()(),t.TgZ(14,"div",107)(15,"label",110),t._uU(16,"Unit to sell"),t.qZA(),t._UZ(17,"br"),t.TgZ(18,"p-dropdown",111),t.NdJ("onChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.updateUnitSelected(n))})("ngModelChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.itemToSellModel.unit=n)}),t.YNc(19,ee,2,1,"ng-template",82),t.YNc(20,oe,3,1,"ng-template",41),t.qZA()()(),t.YNc(21,le,4,3,"div",112),t.qZA(),t.TgZ(22,"div",107)(23,"label",113),t._uU(24,"Unit quantity to transfer"),t.qZA(),t.TgZ(25,"input",114),t.NdJ("input",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.checkQuantity())})("ngModelChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.itemToSellModel.unit_quantity=n)}),t.qZA(),t.YNc(26,ae,2,1,"small",115),t.qZA(),t.TgZ(27,"div",107)(28,"label",108),t._uU(29,"Location to"),t.qZA(),t._UZ(30,"br"),t.TgZ(31,"p-dropdown",116),t.NdJ("onChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.updateLocationToSelected(n))})("ngModelChange",function(n){t.CHM(e);const l=t.oxw(2);return t.KtG(l.itemToSellModel.location_to=n)}),t.YNc(32,se,2,1,"ng-template",82),t.YNc(33,re,3,1,"ng-template",41),t.qZA(),t.YNc(34,ce,2,1,"small",117),t.qZA()()()(),t.TgZ(35,"p-footer")(36,"button",118),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.hideSellForm())}),t.qZA(),t._UZ(37,"button",119),t.qZA()()}if(2&i){const e=t.MAs(1),o=t.oxw(2);t.xp6(11),t.Q6J("options",o.itemToSellModel.locations_qty)("ngModel",o.itemToSellModel.location_from),t.xp6(7),t.Q6J("options",o.itemToSellModel.selling_units)("disabled",!o.activateSellForm)("ngModel",o.itemToSellModel.unit),t.xp6(3),t.Q6J("ngIf",o.availableUnits!=t.DdM(14,b)),t.xp6(4),t.Q6J("disabled",!o.activateSellForm||null==o.itemToSellModel.unit)("ngModel",o.itemToSellModel.unit_quantity),t.xp6(1),t.Q6J("ngIf",""!=o.quantityError),t.xp6(5),t.Q6J("options",o.locations)("disabled",!o.activateSellForm||o.itemToSellModel.unit_quantity<1)("ngModel",o.itemToSellModel.location_to),t.xp6(3),t.Q6J("ngIf",""!=o.locationError),t.xp6(3),t.Q6J("disabled",!e.valid||null==o.itemToSellModel.location_from||null==o.itemToSellModel.location_to||o.itemToSellModel.unit_quantity<1||null==o.itemToSellModel.unit||""!=o.quantityError||""!=o.locationError||!o.activateSellForm)}}const N=function(){return{width:"30vw"}};function pe(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-dialog",100),t.NdJ("visibleChange",function(n){t.CHM(e);const l=t.oxw();return t.KtG(l.displaySellDialog=n)}),t.YNc(1,_e,38,15,"form",101),t.TgZ(2,"ngx-spinner",102),t._UZ(3,"p",5),t.qZA()()}if(2&i){const e=t.oxw();t.Akn(t.DdM(8,N)),t.s9C("header",e.itemToSellModel.name),t.Q6J("closable",!1)("visible",e.displaySellDialog)("baseZIndex",1e4),t.xp6(1),t.Q6J("ngIf",!e.showNotification),t.xp6(1),t.Q6J("fullScreen",!1)}}function de(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",32)(1,"th",37),t._uU(2,"Receipt number "),t.qZA(),t.TgZ(3,"th",37),t._uU(4,"Date sold "),t.qZA(),t._UZ(5,"th",38),t.qZA(),t.TgZ(6,"tr")(7,"th",125)(8,"input",126),t.NdJ("input",function(n){t.CHM(e),t.oxw();const l=t.MAs(1);return t.KtG(l.filterGlobal(n.target.value,"contains"))}),t.qZA()()()}}function ue(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",43)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"td")(7,"p-button",127),t.NdJ("onClick",function(){const l=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.selectReceipt(l,!0))}),t.qZA(),t.TgZ(8,"p-button",128),t.NdJ("onClick",function(){const l=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.selectReceipt(l,!1))}),t.qZA()()()}if(2&i){const e=a.$implicit;t.xp6(2),t.hij(" ",e.transaction_code," "),t.xp6(2),t.hij(" ",t.lcZ(5,2,e.date_transfered)," ")}}const me=function(){return["transaction_code"]};function he(i,a){if(1&i&&(t.TgZ(0,"p-table",25,124),t.YNc(2,de,9,0,"ng-template",27),t.YNc(3,ue,9,4,"ng-template",28),t.qZA()),2&i){const e=t.oxw();t.Q6J("value",e.locationTransactions)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(8,Z))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(9,me))}}function ge(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",32)(1,"th",54),t._uU(2,"Item "),t._UZ(3,"p-sortIcon",34),t.qZA(),t.TgZ(4,"th",37),t._uU(5,"Location from "),t.qZA(),t.TgZ(6,"th",37),t._uU(7,"Location to "),t.qZA(),t.TgZ(8,"th",37),t._uU(9,"Unit "),t.qZA(),t.TgZ(10,"th",37),t._uU(11,"Qty "),t.qZA()(),t.TgZ(12,"tr")(13,"th",129)(14,"input",39),t.NdJ("input",function(n){t.CHM(e),t.oxw();const l=t.MAs(1);return t.KtG(l.filter(n.target.value,"item.name","contains"))}),t.qZA()()()}}function fe(i,a){if(1&i&&(t.TgZ(0,"tr",43)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td")(5,"p-avatarGroup"),t._UZ(6,"p-avatar",55),t.qZA()(),t.TgZ(7,"td")(8,"p-avatarGroup"),t._UZ(9,"p-avatar",56),t.qZA()(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"titlecase"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"number"),t.qZA()()),2&i){const e=a.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,7,e.item.name)," "),t.xp6(4),t.Akn(t.VKq(13,p,e.location_from.color)),t.xp6(3),t.Akn(t.VKq(15,p,e.location_to.color)),t.xp6(2),t.hij(" ",t.lcZ(12,9,e.unit.unit_name)," "),t.xp6(3),t.hij(" ",t.lcZ(15,11,e.unit_quantity)," ")}}function xe(i,a){if(1&i&&(t.TgZ(0,"p-table",25,29),t.YNc(2,ge,15,0,"ng-template",27),t.YNc(3,fe,16,17,"ng-template",28),t.qZA()),2&i){const e=t.oxw();t.Q6J("value",e.transactionToView.items)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(8,Z))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(9,I))}}function Te(i,a){1&i&&(t.TgZ(0,"tr",32)(1,"th",72),t._uU(2,"Item "),t.qZA(),t.TgZ(3,"th",37),t._uU(4,"Quantity ordered "),t.qZA(),t.TgZ(5,"th",72),t._uU(6,"Quantity available "),t.qZA()())}const ve=function(i){return{"word-wrap":"normal",color:i}};function Ze(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td")(5,"p-avatarGroup",48),t.NdJ("click",function(n){const s=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(_.showLocationsQuantityOrdered(s.item,s,n))}),t._UZ(6,"p-avatar",50),t.qZA()(),t.TgZ(7,"td")(8,"p-avatarGroup",48),t.NdJ("click",function(n){const s=t.CHM(e).$implicit,_=t.oxw(2);return t.KtG(_.showLocationsQuantityNew(s.item,n))}),t._UZ(9,"p-avatar",50),t.qZA()()()}if(2&i){const e=a.$implicit;t.Akn(t.VKq(9,ve,e.location.color)),t.xp6(2),t.hij(" ",t.lcZ(3,7,e.item.name)," "),t.xp6(4),t.Akn(t.VKq(11,p,e.location.color)),t.xp6(3),t.Akn(t.VKq(13,p,e.location.color))}}const D=function(){return{width:"50vw"}},ye=function(){return[500]},Ie=function(){return["item.name"]};function Se(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-dialog",130),t.NdJ("visibleChange",function(n){t.CHM(e);const l=t.oxw();return t.KtG(l.showQuantityError=n)}),t.TgZ(1,"div",7)(2,"div",131)(3,"p-table",25,29),t.YNc(5,Te,7,0,"ng-template",27),t.YNc(6,Ze,10,15,"ng-template",28),t.qZA()()()()}if(2&i){const e=t.oxw();t.Akn(t.DdM(13,D)),t.Q6J("closable",!0)("visible",e.showQuantityError)("baseZIndex",1e4),t.xp6(3),t.Q6J("value",e.lessItems)("rowHover",!0)("rows",10)("showCurrentPageReport",!1)("rowsPerPageOptions",t.DdM(14,ye))("paginator",!1)("filterDelay",0)("globalFilterFields",t.DdM(15,Ie))}}function Ce(i,a){if(1&i&&(t.TgZ(0,"th"),t._uU(1),t.ALo(2,"titlecase"),t.ALo(3,"number"),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,e.unit_name)," (",t.lcZ(3,4,e.unit_quantity),") ")}}function we(i,a){if(1&i&&(t.TgZ(0,"tr"),t._UZ(1,"th"),t.TgZ(2,"th"),t._uU(3,"Location"),t.qZA(),t.YNc(4,Ce,4,6,"th",132),t.qZA()),2&i){const e=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",e.itemToViewLocations.selling_units)}}function be(i,a){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=a.$implicit,o=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.hij(" ",n.getLocationUnitQuantityOrdered(o.location_quantity,n.itemToViewLocations.selling_units)[e.unit_name]," ")}}const L=function(i){return{"background-color":i,color:"#ffffff"}};function Ae(i,a){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"p-avatar",50),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.YNc(6,be,2,1,"td",132),t.qZA()),2&i){const e=a.$implicit,o=t.oxw(2);t.xp6(2),t.Akn(t.VKq(6,L,e.location.color)),t.xp6(2),t.Oqu(t.lcZ(5,4,e.location.name)),t.xp6(2),t.Q6J("ngForOf",o.itemToViewLocations.selling_units)}}function qe(i,a){if(1&i&&(t.TgZ(0,"p-table",120),t.YNc(1,we,5,1,"ng-template",27),t.YNc(2,Ae,7,8,"ng-template",28),t.qZA()),2&i){const e=t.oxw();t.Q6J("value",e.itemToViewLocations.locations_qty)("paginator",!1)("rows",5)}}function Me(i,a){if(1&i&&(t.TgZ(0,"th"),t._uU(1),t.ALo(2,"titlecase"),t.ALo(3,"number"),t.TgZ(4,"p",133)(5,"i",134),t._uU(6),t.ALo(7,"number"),t.qZA()()()),2&i){const e=a.$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,3,e.unit_name)," (",t.lcZ(3,5,e.unit_quantity),") "),t.xp6(5),t.hij("@Ksh ",t.lcZ(7,7,e.recom_selling_price),"")}}function ke(i,a){if(1&i&&(t.TgZ(0,"tr"),t._UZ(1,"th"),t.TgZ(2,"th"),t._uU(3,"Location"),t.qZA(),t.YNc(4,Me,8,9,"th",132),t.qZA()),2&i){const e=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",e.itemToViewLocations.selling_units)}}function Ue(i,a){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=a.$implicit,o=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.hij(" ",n.getLocationUnitQuantity(o.location_quantity,n.itemToViewLocations.selling_units)[e.unit_name]," ")}}function Ee(i,a){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"p-avatar",50),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.YNc(6,Ue,2,1,"td",132),t.qZA()),2&i){const e=a.$implicit,o=t.oxw(2);t.xp6(2),t.Akn(t.VKq(6,L,e.location.color)),t.xp6(2),t.Oqu(t.lcZ(5,4,e.location.name)),t.xp6(2),t.Q6J("ngForOf",o.itemToViewLocations.selling_units)}}function Ne(i,a){if(1&i&&(t.TgZ(0,"p-table",120),t.YNc(1,ke,5,1,"ng-template",27),t.YNc(2,Ee,7,8,"ng-template",28),t.qZA()),2&i){const e=t.oxw();t.Q6J("value",e.itemToViewLocations.locations_qty)("paginator",!1)("rows",5)}}const De=function(){return{width:"70vw"}},J=function(){return{width:"500px"}},Le=[{path:"",component:(()=>{class i{constructor(e,o,n,l,s,_,f,S,A){this.spinner=e,this.cryptoSrv=o,this.toastr=n,this.authSrv=l,this.apiSrv=s,this._decimalPipe=_,this.confirmationService=f,this.printSrv=S,this.locale=A,this.categories=[],this.loading=!0,this.productImagesUrl=k.N.imageUrls,this.shopLogoUrl=k.N.shopLogoUrls,this.cartItems=[],this.itemToSellModel={},this.activateSellForm=!1,this.activateSellFormTo=!1,this.printReceipt="yes",this.displaySellDialog=!1,this.quantityError="",this.locationError="",this.showReprintForm=!1,this.displayItemsDialog=!1,this.locationTransactions=[],this.availableUnits=[],this.loading2=!1,this.newStock=[],this.showNew=!0,this.selectedLocation="",this.selectedItem={},this.clonedProducts={},this.loaderToShow="",this.showQuantityError=!1,this.lessItems=[]}ngOnInit(){"1"===this.cryptoSrv.decryptEncodedText(this.authSrv.getRoleToken("adding_interlocation"))||"admin"===this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("role"))?this.getAllStockNew():(this.toastr.error("You have no rights to access that page!"),this.authSrv.logout())}getAllStock(){this.spinner.show();const e={action:this.cryptoSrv.encodeEncryptText("get-stock-and-cart-items-inter-location"),uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.allStock=o.stock,this.locations=o.locations,this.categories=o.categories,this.cartItems=o.cartItems,this.allStock.forEach(n=>{parseInt(n.prices_ok.toString())>0?(n.prices_ok=!1,n.sp_units_ok=!1,n.attention=1):(n.prices_ok=!0,n.sp_units_ok=!0),parseInt(n.min_qty_ok.toString())<1||parseInt(n.min_qty_ok.toString())>1?(n.min_qty_ok=!1,n.min_unit_ok=!1,n.attention=1):(n.min_qty_ok=!0,n.min_unit_ok=!0),n.locations_count=parseInt(n.locations_count.toString()),n.category=this.categories.find(l=>l.id===n.category_id)}),this.spinner.hide(),this.loading=!1):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide()})}getAllStockNew(){this.spinner.show();const e={action:this.cryptoSrv.encodeEncryptText("get-stock-and-cart-items-inter-location-new"),uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.newStock=o.stock,this.locations=o.locations,this.cartItems=o.cartItems,this.newStock.forEach(n=>{const l=n.locations.split(",");n.locations_count=l.length,1==n.min_unit_ok&&(n.min_unit_ok=!0)}),this.spinner.hide(),this.loading=!1):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide()})}showLocationsQuantityNew(e,o){if(e.selling_units)this.itemToViewLocations=e,this.overlay.toggle(o);else{this.loaderToShow=e.id,this.loading2=!0;let n=this.newStock.find(s=>s.id===e.id);this.itemToViewLocations=n;const l={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(l).then(s=>{"error"!=s.status?"error2"!=s.status?(n.selling_units=s.selling_units,n.locations_qty=s.locations_qty,n.total_qty=s.total_qty,n.locations=s.locations,this.overlay.toggle(o),this.loading2=!1,this.loaderToShow=""):(this.loaderToShow="",this.loading2=!1,this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loaderToShow="",this.loading2=!1,this.toastr.error(s.message))}).catch(s=>{this.toastr.error(s),this.loaderToShow="",this.loading2=!1})}}showLocationsQuantityOrdered(e,o,n){this.loaderToShow=e.id,this.itemToViewLocations=e;const l={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(l).then(s=>{if("error"!=s.status)if("error2"!=s.status){e.selling_units=s.selling_units,e.locations_qty=s.locations_qty;let _=e.locations_qty.find(f=>f.location.id==o.location.id);_&&(_.location_quantity=o.qty_ordered),e.locations=s.locations,this.itemToViewLocations=e,this.overlay1.toggle(n),this.loaderToShow=""}else this.loaderToShow="",this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.loaderToShow="",this.toastr.error(s.message)}).catch(s=>{this.toastr.error(s),this.loaderToShow=""})}getLocationUnitQuantityOrdered(e,o){const n={};return(o=o.sort((l,s)=>s.unit_quantity-l.unit_quantity)).forEach(l=>{if(e>0){const s=Math.floor(e/l.unit_quantity);n[l.unit_name]=s,e-=s*l.unit_quantity}else n[l.unit_name]=0}),n}newLocationSelected1(e){this.selectedItem.location1=e.value,this.locations.forEach(o=>{o.inactive=o.id==this.selectedItem.location1.location.id}),this.selectedItem.unit=null,this.selectedItem.sell_qty=0,this.selectedItem.location2=null,this.checkLockStatusNew1()}newLocationSelected2(e){this.selectedItem.location2=e.value,this.checkLockStatusNew2()}checkLockStatusNew1(){this.loaderToShow=this.selectedItem.id;const e={action:this.cryptoSrv.encodeEncryptText("check-lock-status-new"),item_id:this.selectedItem.id,location_id:this.selectedItem.location1.location.id,uid:this.authSrv.getUserDetailToken("uid"),right:this.cryptoSrv.encodeEncryptText("sell_cash")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.activateSellForm=!0,this.selectedItem.selling_units=o.units,this.selectedItem.locations.find(({location:l})=>l.id===this.selectedItem.location1.location.id).quantity=o.qty,this.loading=!1,this.activateSellForm=!0,this.loaderToShow=""):(this.loaderToShow="",this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loaderToShow="","locked"===o.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+o.user)):(this.activateSellForm=!1,this.toastr.error(o.message)))}).catch(o=>{this.toastr.error(o),this.activateSellForm=!1,this.loaderToShow=""})}checkLockStatusNew2(){this.loaderToShow=this.selectedItem.id;const e={action:this.cryptoSrv.encodeEncryptText("check-lock-status-new"),item_id:this.selectedItem.id,location_id:this.selectedItem.location2.id,uid:this.authSrv.getUserDetailToken("uid"),right:this.cryptoSrv.encodeEncryptText("sell_cash")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.activateSellForm=!0,this.selectedItem.selling_units=o.units,this.loading=!1,this.activateSellForm=!0,this.loaderToShow=""):(this.loaderToShow="",this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loaderToShow="","locked"===o.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+o.user)):(this.activateSellForm=!1,this.toastr.error(o.message)))}).catch(o=>{this.toastr.error(o),this.activateSellForm=!1,this.loaderToShow=""})}focusNext1(e,o){e.preventDefault(),e.stopPropagation();const n=document.getElementById(o);n&&n.focus()}newUnitSelected(e){this.selectedItem.unit=e.value,this.selectedItem.sell_qty=0}confirmQuantityNew(){const e=parseFloat(this.selectedItem.location1.quantity);if(parseInt(this.selectedItem.unit.unit_quantity.toString())*parseInt(this.selectedItem.sell_qty)>e){const n=Math.floor(e/parseInt(this.selectedItem.unit.unit_quantity));this.quantityError="Only "+n+" "+this.selectedItem.unit.unit_name+"s are available"}else this.quantityError=""}confirmQuantityIsNumber(){return Number.isInteger(+this.selectedItem.sell_qty)&&+this.selectedItem.sell_qty>0}getName(e){return e.replace(/\s+/g,"-")}onRowEditInit(e){this.loaderToShow=e.id,this.clonedProducts[e.id]={...e};const o={action:this.cryptoSrv.encodeEncryptText("get-item-locations"),item_id:e.id,uid:this.authSrv.getUserDetailToken("uid"),right:this.cryptoSrv.encodeEncryptText("sell_cash")};this.apiSrv.read(o).then(n=>{"error"!=n.status?"error2"!=n.status?(this.selectedItem=this.apiSrv.deepCopy(e),this.selectedItem.sell_qty=0,this.selectedItem.locations=n.locations,this.quantityError="",this.activateSellForm=!0,this.loaderToShow=""):(this.loaderToShow="",this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loaderToShow="","locked"===n.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+n.user)):(this.activateSellForm=!1,this.toastr.error(n.message)))}).catch(n=>{this.toastr.error(n),this.spinner.hide("sell"),this.spinner.show("sellw")})}onRowEditSave(e){this.loaderToShow=e.id;const o={action:this.cryptoSrv.encodeEncryptText("add-item-to-temp-inter-location-new"),item_id:this.selectedItem.id,unit_id:this.selectedItem.unit.id,unit_quantity:this.cryptoSrv.encodeEncryptText(this.selectedItem.sell_qty.toString()),from:this.selectedItem.location1.location.id,to:this.selectedItem.location2.id,uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(o).then(n=>{"error"!=n.status?"error2"!=n.status?(this.toastr.success("Item added to list!"),this.newStock=n.stock,this.locations=n.locations,this.cartItems=n.cartItems,this.selectedItem={},this.newStock.forEach(l=>{const s=l.locations.split(",");l.locations_count=s.length,1==l.min_unit_ok&&(l.min_unit_ok=!0)}),this.loaderToShow=""):(this.loaderToShow="",this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loaderToShow="","locked"===n.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+n.user)):this.toastr.error(n.message))}).catch(n=>{this.toastr.error(n),this.loaderToShow=""})}onRowEditCancel(e,o){this.selectedItem={};const n={action:this.cryptoSrv.encodeEncryptText("unlock-user-items"),uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(n).then(l=>{"error"!=l.status&&("error2"!=l.status||(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()))}).catch(l=>{})}showLocationsQuantity(e,o){if(e.selling_units)this.itemToViewLocations=e,this.overlay.toggle(o);else{this.loading2=!0;let n=this.allStock.find(s=>s.id===e.id);this.itemToViewLocations=n;const l={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(l).then(s=>{"error"!=s.status?"error2"!=s.status?(n.selling_units=s.selling_units,n.locations_qty=s.locations_qty,n.total_qty=s.total_qty,n.locations=s.locations,this.overlay.toggle(o),this.loading2=!1):(this.loading2=!1,this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loading2=!1,this.toastr.error(s.message))}).catch(s=>{this.toastr.error(s),this.loading2=!1})}}getLocationUnitQuantity(e,o){const n={};return(o=o.sort((l,s)=>s.unit_quantity-l.unit_quantity)).forEach(l=>{if(e>0){const s=Math.floor(e/l.unit_quantity);n[l.unit_name]=s,e-=s*l.unit_quantity}else n[l.unit_name]=0}),n}confirmDelete(e){this.confirmationService.confirm({message:"Are you sure you want to delete item from list?",acceptButtonStyleClass:"btn btn-primary",rejectButtonStyleClass:"btn btn-danger",accept:()=>{this.spinner.show();const o=e.unit.unit_quantity*e.unit_quantity,n={action:this.cryptoSrv.encodeEncryptText("delete-item-from-temp-inter-location"),id:e.id,item_id:e.item.id,tt_qty:this.cryptoSrv.encodeEncryptText(o.toString()),location_from:e.location_from.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(n).then(l=>{"error"!=l.status?"error2"!=l.status?(this.toastr.success("Item deleted"),this.ngOnInit()):(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout(),this.spinner.hide()):(this.spinner.hide(),"locked"===l.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+l.user)):this.toastr.error(l.message))}).catch(l=>{this.toastr.error(l),this.spinner.hide()})},reject:()=>{}})}complete(){this.confirmationService.confirm({message:"All items will be updated in their selected locations. Do you want to complete this operation?",acceptButtonStyleClass:"btn btn-primary",rejectButtonStyleClass:"btn btn-danger",accept:()=>{this.spinner.show();const e={action:this.cryptoSrv.encodeEncryptText("complete-inter-location"),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.toastr.success("Operation completed!"),"yes"===this.printReceipt&&(this.shopDetail=o.Shop,this.printTest()),this.ngOnInit()):(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout(),this.spinner.hide()):(this.spinner.hide(),"locked"===o.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+o.user)):"Quantity less!"==o.message?(this.showQuantityError=!0,this.lessItems=o.items):this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide()})},reject:()=>{}})}selectItem(e){if(e.selling_units)this.itemToSellModel.location_from=null,this.itemToSellModel.location_to=null,this.activateSellForm=!1,this.itemToSellModel=e,this.itemToSellModel.unit=e.selling_units[0],this.availableUnits=[],this.displaySellDialog=!0;else{this.loading2=!0;let o=this.allStock.find(l=>l.id===e.id);this.itemToViewLocations=o;const n={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(n).then(l=>{"error"!=l.status?"error2"!=l.status?(o.selling_units=l.selling_units,o.locations_qty=l.locations_qty,o.total_qty=l.total_qty,o.locations=l.locations,this.itemToSellModel.location_from=null,this.itemToSellModel.location_to=null,this.activateSellForm=!1,this.itemToSellModel=e,this.itemToSellModel.unit=e.selling_units[0],this.availableUnits=[],this.displaySellDialog=!0,this.loading2=!1):(this.loading2=!1,this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loading2=!1,this.toastr.error(l.message))}).catch(l=>{this.toastr.error(l),this.loading2=!1})}}updateLocationSelected(e){this.itemToSellModel.location_from=e.value,this.itemToSellModel.unit_quantity=0,this.itemToSellModel.unit=null,this.checkLockStatus()}updateUnitSelected(e){this.itemToSellModel.unit=e.value,this.itemToSellModel.unit_quantity=0,this.checkLockStatus()}updateAvailableUnits(e){const o=this.getLocationUnitQuantity(e,this.itemToSellModel.selling_units);this.availableUnits=Object.entries(o)}checkLockStatus(){this.spinner.show("sell"),this.spinner.show("sellw");const e={action:this.cryptoSrv.encodeEncryptText("check-lock-status"),item_id:this.itemToSellModel.id,location_id:this.itemToSellModel.location_from.location.id,uid:this.authSrv.getUserDetailToken("uid"),right:this.cryptoSrv.encodeEncryptText("stock_taking")};this.apiSrv.read(e).then(o=>{if("error"!=o.status)if("error2"!=o.status){this.activateSellForm=!0;const n=this.itemToSellModel.locations_qty.find(({location:l})=>l.id===this.itemToSellModel.location_from.location.id);n&&(n.location_quantity=o.qty),this.updateAvailableUnits(o.qty),this.loading=!1,this.spinner.hide("sell"),this.spinner.hide("sellw")}else this.spinner.hide("sell"),this.spinner.hide("sellw"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.spinner.hide("sell"),this.spinner.hide("sellw"),"locked"===o.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+o.user)):(this.activateSellForm=!1,this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide("sell")})}checkQuantity(){const e=this.itemToSellModel.location_from,n=this.itemToSellModel.locations_qty.find(s=>s.id===e.id).location_quantity;if(this.itemToSellModel.unit_quantity*this.itemToSellModel.unit.unit_quantity>n){const s=Math.floor(parseInt(n)/parseInt(this.itemToSellModel.unit.unit_quantity));this.quantityError="You can only transfer a max of "+s+" "+this.itemToSellModel.unit.unit_name}else this.quantityError=""}updateLocationToSelected(e){e.value.id===this.itemToSellModel.location_from.location.id?(this.itemToSellModel.location_to=null,this.locationError="Location from and location to cannot be the same!"):(this.locationError="",this.itemToSellModel.location_to=e.value,this.checkLockStatusTo())}checkLockStatusTo(){this.spinner.show("sell"),this.spinner.show("sellw");const e={action:this.cryptoSrv.encodeEncryptText("check-lock-status"),item_id:this.itemToSellModel.id,location_id:this.itemToSellModel.location_to.id,uid:this.authSrv.getUserDetailToken("uid"),right:this.cryptoSrv.encodeEncryptText("stock_taking")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.activateSellForm=!0,this.activateSellFormTo=!0,this.loading=!1,this.spinner.hide("sell"),this.spinner.hide("sellw")):(this.spinner.hide("sell"),this.spinner.hide("sellw"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("sell"),this.spinner.hide("sellw"),"locked"===o.message?(this.itemToSellModel.location_to=null,this.toastr.warning("Item is locked by "+o.user)):(this.itemToSellModel.location_to=null,this.toastr.error(o.message)))}).catch(o=>{this.toastr.error(o),this.spinner.hide("sell")})}addToCart(){this.spinner.show("sell");const e={action:this.cryptoSrv.encodeEncryptText("add-item-to-temp-inter-location"),item_id:this.itemToSellModel.id,unit_id:this.itemToSellModel.unit.id,unit_quantity:this.cryptoSrv.encodeEncryptText(this.itemToSellModel.unit_quantity.toString()),from:this.itemToSellModel.location_from.location.id,to:this.itemToSellModel.location_to.id,uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.activateSellForm=!1,this.displaySellDialog=!1,this.toastr.success("Item added to list!"),this.allStock=o.stock,this.locations=o.locations,this.cartItems=o.cartItems,this.allStock.forEach(n=>{parseInt(n.prices_ok.toString())>0?(n.prices_ok=!1,n.sp_units_ok=!1,n.attention=1):(n.prices_ok=!0,n.sp_units_ok=!0),parseInt(n.min_qty_ok.toString())<1||parseInt(n.min_qty_ok.toString())>1?(n.min_qty_ok=!1,n.min_unit_ok=!1,n.attention=1):(n.min_qty_ok=!0,n.min_unit_ok=!0),n.locations_count=parseInt(n.locations_count.toString()),n.category=this.categories.find(l=>l.id===n.category_id)}),this.spinner.hide("sell")):(this.spinner.hide("sell"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("sell"),"locked"===o.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+o.user)):this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide("sell")})}hideSellForm(){this.activateSellForm=!1,this.displaySellDialog=!1}getReprintData(){this.spinner.show();const e={action:this.cryptoSrv.encodeEncryptText("get-user-inter-location-transactions"),uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.locationTransactions=o.transactions,this.spinner.hide(),this.showReprintForm=!0,this.loading=!1):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide()})}selectReceipt(e,o){this.transactionToView=e,this.spinner.show("reprint");const n={code:this.cryptoSrv.encodeEncryptText(this.transactionToView.transaction_code),uid:this.authSrv.getUserDetailToken("uid")};o?(n.action=this.cryptoSrv.encodeEncryptText("get-user-interlocation-reprint-items"),n.print=this.cryptoSrv.encodeEncryptText("1")):(n.action=this.cryptoSrv.encodeEncryptText("get-user-interlocation-reprint-items"),n.print=this.cryptoSrv.encodeEncryptText("0")),this.apiSrv.read(n).then(l=>{"error"!=l.status?"error2"!=l.status?(this.spinner.hide("reprint"),o?(this.shopDetail=l.Shop,this.cartItems=l.items,this.printTest()):(this.transactionToView.items=l.items,this.displayItemsDialog=!0),this.loading=!1):(this.spinner.hide("reprint"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("reprint"),this.toastr.error(l.message))}).catch(l=>{this.toastr.error(l),this.spinner.hide("reprint")})}createPrintData(){this.shopDetail.name=this.cryptoSrv.decryptEncodedText(this.shopDetail.name),this.shopDetail.tcode=this.cryptoSrv.decryptEncodedText(this.shopDetail.tcode),this.shopDetail.username=this.cryptoSrv.decryptEncodedText(this.shopDetail.username),this.shopDetail.location=this.cryptoSrv.decryptEncodedText(this.shopDetail.location),this.shopDetail.description=this.cryptoSrv.decryptEncodedText(this.shopDetail.description),this.shopDetail.contacts.forEach(c=>{c=this.cryptoSrv.decryptEncodedText(c)}),this.shopDetail.receipt_options.till=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.till),this.shopDetail.receipt_options.paybill=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.paybill),this.shopDetail.receipt_options.paybill_account=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.paybill_account),this.shopDetail.receipt_options.mpesa_business_name=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.mpesa_business_name),this.shopDetail.receipt_options.footer_message=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.footer_message);var e="";e+="\x1b!\0";let n=0,l=0,s=0;this.cartItems.forEach(c=>{const x=c.unit.unit_name.length+c.unit.unit_quantity.toString().length;n=Math.max(n,x);const g=c.unit_quantity.toString().length;l=Math.max(l,g);const C=c.location_from.name.toString().length;s=Math.max(s,C)});const _="UNIT",S="LOC1",Re=l-"QTY".length+5,Pe=s-S.length+5,Ge=_+" ".repeat(n-_.length+5)+"QTY"+" ".repeat(Re)+S+" ".repeat(Pe)+"LOC2";e+="\x1bE\r",e+="-----------------------------------------------\n",e+=Ge+"\n",e+="-----------------------------------------------\n\n",e+="\x1bE\n",this.cartItems.forEach(c=>{e+=c.item.name+"  -  "+c.location_from.name+"\n";const x=(0,v._)(c.unit.unit_name)+"("+(0,u.uf)(c.unit.unit_quantity,this.locale,".0")+")   x",g=(0,u.uf)(c.unit_quantity,this.locale,".0"),C=(0,v._)(c.location_from.name),Ke=(0,v._)(c.location_to.name),$e=l-g.length+5,Ve=s-C.length+5;e+=x+" ".repeat(n-x.length+5)+g+" ".repeat($e)+C+" ".repeat(Ve)+Ke+"\n",e+="\n\n",e+="\x1ba0"}),new Date;var Oe=new u.uU("en-US");const He=Date.now(),Q=Oe.transform(He,"medium"),F=this.shopDetail.name.toUpperCase();var y=function(c){return String.fromCharCode(c)},Y="\x1dh"+y(70)+"\x1df"+y(0)+"\x1dk"+y(69)+y(this.shopDetail.tcode.length)+this.shopDetail.tcode+y(0);if(""!==this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.image_url)){let c="";return this.shopDetail.contacts.forEach(g=>{c+=this.cryptoSrv.decryptEncodedText(g)+", "}),["\x1b@","\x1ba1","\x1d!\x10","\x1bE\r","\x1d!\x10",F+"\n","\n",{type:"raw",format:"image",flavor:"file",data:this.shopLogoUrl+this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.image_url),options:{language:"ESCPOS",dotDensity:"single"}},"\x1bE\n","\x1d!\0","\x1d!\0","\n",this.shopDetail.description+"\n",this.shopDetail.location+"\n","FOR ENQUIRIES CALL: "+c+"\n","\n","\x1ba0","\x1bE\r","\n","STOCK LOCATION TO LOCATION TRANSFER \n","\x1bE\n","\n",e+"\n","\x1ba1",this.showReprintForm?"":Y,"RECEIPT # "+this.shopDetail.tcode+"  "+Q+"\n\n","Served by "+(0,v._)(this.shopDetail.username),"\n","\n\n\n\n\n\n\n","\x1dV\0"]}{let c="";return this.shopDetail.contacts.forEach(g=>{c+=this.cryptoSrv.decryptEncodedText(g)+", "}),["\x1b@","\x1ba1","\x1d!\x10","\x1bE\r",F+"\n","\x1bE\n","\x1d!\0","\x1d!\0","\n",this.shopDetail.description+"\n",this.shopDetail.location+"\n","FOR ENQUIRIES CALL: "+c+"\n","\n","\x1ba0","\x1bE\r","STOCK LOCATION TO LOCATION TRANSFER \n","\x1bE\n","\n",e+"\n","\x1ba1",this.showReprintForm?"":Y,"RECEIPT # "+this.shopDetail.tcode+"  "+Q+"\n\n","Served by "+(0,v._)(this.shopDetail.username),"\n","\n\n\n\n\n\n\n","\x1dV\0"]}}printTest(){this.printSrv.printtest2(this.createPrintData())}getImage(e){this.getBase64ImageFromURL(e).subscribe(o=>{this.base64TrimmedURL=o,this.printSrv.printtest2(this.createPrintData()),document.getElementById("cashreceived").value=""})}getBase64ImageFromURL(e){return R.y.create(o=>{let n=new Image;n.crossOrigin="Anonymous",n.src=e,n.complete?(o.next(this.getBase64Image(n)),o.complete()):(n.onload=()=>{o.next(this.getBase64Image(n)),o.complete()},n.onerror=l=>{o.error(l)})})}getBase64Image(e){var o=document.createElement("canvas");o.width=e.width,o.height=e.height,o.getContext("2d").drawImage(e,-5,0);let l=o.toDataURL("image/png");return this.base64DefaultURL=l,l.replace(/^data:image\/(png|jpg);base64,/,"")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(U.t2),t.Y36(P.$),t.Y36(G._W),t.Y36(O.e),t.Y36(H.s),t.Y36(u.JJ),t.Y36(w.YP),t.Y36(K.$),t.Y36(t.soG))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-interlocation"]],viewQuery:function(e,o){if(1&e&&(t.Gf(nt,5),t.Gf(lt,5)),2&e){let n;t.iGM(n=t.CRH())&&(o.overlay=n.first),t.iGM(n=t.CRH())&&(o.overlay1=n.first)}},decls:25,vars:36,consts:[["class","row",4,"ngIf"],["appendTo","body","modal","true",3,"header","closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],["appendTo","body","modal","true","header","",3,"closable","visible","baseZIndex","visibleChange","onHide"],["styleClass","p-datatable-customers","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","filterDelay","globalFilterFields",4,"ngIf"],["bdOpacity","#fff","name","reprint","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[2,"color","#02926e"],["appendTo","body","modal","true",3,"header","closable","visible","baseZIndex","visibleChange","onHide"],[1,"row"],[1,"col-md-12","text-right"],["label","Reprint","icon","pi pi-print","iconPos","right","styleClass","p-button-sm p-button-help",3,"click"],[1,"col-md-12"],["appendTo","body","modal","true","header","Items with less quantity available",3,"closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],[3,"showCloseIcon"],["op1",""],["pTemplate",""],["op",""],["header","Confirm","icon","pi pi-exclamation-triangle","appendTo","body",3,"baseZIndex"],["bdOpacity","#fff","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[1,"col-md-12","mt-1","text-right"],["label","Reprint a receipt","icon","fas fa-print","styleClass","p-button-sm p-button-help p-button-outlined","pTooltip","Click to reprint items for a receipt","tooltipPosition","left",3,"click"],[1,"col-md-6"],[1,"card"],[1,"card-header"],[1,"card-title","mb-4"],[1,"card-body","p-0","m-0"],["styleClass","p-datatable-customers","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","filterDelay","globalFilterFields"],["dt",""],["pTemplate","header"],["pTemplate","body"],["dt12",""],[1,"row","pt-3","text-center"],["class","col-md-6 text-center offset-md-4",4,"ngIf"],[1,"ui-selectable-row"],["pSortableColumn","name",2,"width","15rem"],["field","name"],["pSortableColumn","category.name",2,"width","15rem"],["field","category.name"],[2,"width","10rem"],[2,"width","20rem"],["pInputText","","type","text","placeholder","Search item name",1,"ui-column-filter",3,"input"],["appendTo","body","placeholder","All","styleClass","ui-column-filter","optionLabel","name",3,"options","onChange"],["pTemplate","item"],[1,"ui-multiselect-representative-option",2,"display","grid"],[2,"word-wrap","normal"],[3,"click",4,"ngIf"],["class","animate-flicker warning",4,"ngIf"],["label","Select","icon","pi pi-arrow-right","iconPos","right","styleClass","p-button-primary p-button-outlined p-button-sm",3,"loading","onClick",4,"ngIf"],["severity","warn","text","Missing units","styleClass","mr-2",4,"ngIf"],[3,"click"],["label","","shape","circle",3,"style",4,"ngFor","ngForOf"],["label","","shape","circle"],[1,"animate-flicker","warning"],["label","Select","icon","pi pi-arrow-right","iconPos","right","styleClass","p-button-primary p-button-outlined p-button-sm",3,"loading","onClick"],["severity","warn","text","Missing units","styleClass","mr-2"],["pSortableColumn","name",2,"width","10rem"],["shape","circle","label",""],["shape","circle"],["label","","icon","pi pi-trash","iconPos","right","styleClass","p-button-danger p-button-outlined p-button-sm",3,"onClick"],[1,"col-md-6","text-center","offset-md-4"],[1,"ui-fluid","py-3"],[1,"p-field"],[1,"field-radiobutton"],["name","receipt1","value","yes","inputId","receipt1",3,"ngModel","ngModelChange"],["for","receipt1"],["name","receipt2","value","no","inputId","receipt2",3,"ngModel","ngModelChange"],["for","receipt2"],[1,"p-field","pt-2"],["pButton","","type","button","icon","pi pi-check","label","Complete transfer",1,"p-button-raised","p-button-sm","p-button-primary",3,"click"],[1,"col-md-8"],["styleClass","p-datatable-customers","dataKey","id","editMode","row","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","showCurrentPageReport","rowsPerPageOptions","paginator","filterDelay","globalFilterFields"],["dt1",""],[1,"col-md-4"],[2,"width","5rem"],[2,"width","15rem"],["pInputText","","type","text","placeholder","Search item...",1,"ui-column-filter",3,"input"],["colspan","6"],[2,"word-wrap","normal",3,"pEditableRow"],[4,"ngIf"],["class","flex align-items-center justify-content-center gap-0",4,"ngIf"],["pTemplate","input"],["pTemplate","output"],["placeholder","Select location from","name","unit","appendTo","body","optionLabel","location.name",3,"options","disabled","ngModel","filter","onChange","ngModelChange"],["pTemplate","selectedItem"],[1,"ui-helper-clearfix"],["placeholder","Select location to","name","unit","appendTo","body","optionLabel","name","optionDisabled","inactive",3,"options","disabled","ngModel","filter","onChange","ngModelChange"],["placeholder","Select unit","name","unit","appendTo","body","optionLabel","",3,"options","disabled","ngModel","filter","onChange","ngModelChange","keydown.enter"],["pInputText","","autocomplete","off","type","text","name","qty",2,"width","6rem",3,"id","ngModel","ngModelChange","input"],["class","m-0 p-0 animate-flicker",4,"ngIf"],[1,"m-0","p-0","animate-flicker"],[2,"font-size","12px"],[1,"text-danger"],[1,"flex","align-items-center","justify-content-center","gap-0"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil","class","p-button-rounded p-button-text",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","class","p-button-rounded p-button-sm p-button-success m-0 p-0",3,"id","disabled","click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","class","p-button-rounded p-button-text p-button-sm p-button-danger m-0 p-0",3,"click",4,"ngIf"],["class","loader",4,"ngIf"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check",1,"p-button-rounded","p-button-sm","p-button-success","m-0","p-0",3,"id","disabled","click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times",1,"p-button-rounded","p-button-text","p-button-sm","p-button-danger","m-0","p-0",3,"click"],[1,"loader"],["appendTo","body","modal","true",3,"header","closable","visible","baseZIndex","visibleChange"],["autocomplete","off",3,"ngSubmit",4,"ngIf"],["bdOpacity","#fff","name","sell","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["autocomplete","off",3,"ngSubmit"],["form2","ngForm"],[1,"ui-fluid"],[1,"col-6"],[1,"p-field","pb-3"],["for","location"],["placeholder","Select location from","name","location","appendTo","body","optionLabel","location.name","filter","true",3,"options","ngModel","onChange","ngModelChange"],["for","unit"],["placeholder","Select item unit","name","unit","appendTo","body","optionLabel","unit_name","filter","true",3,"options","disabled","ngModel","onChange","ngModelChange"],["class","col-6",4,"ngIf"],["for","unitq"],["id","unitq","name","unit_quantity","required","","type","number","pattern","[0-9]+","pInputNumber","",1,"form-control",3,"disabled","ngModel","input","ngModelChange"],["id","unitq-help","class","p-error block",4,"ngIf"],["placeholder","Select location to","name","location_to","appendTo","body","optionLabel","name","filter","true",3,"options","disabled","ngModel","onChange","ngModelChange"],["id","unitq-help","class","pt-1 p-error block",4,"ngIf"],["type","button","pButton","","icon","pi pi-times","label","Cancel",1,"p-button-danger","p-button-sm","float-right",3,"click"],["type","submit","pButton","","icon","pi pi-check","label","Add to list",1,"p-button-success","p-button-sm","mr-3","float-right",3,"disabled"],["selectionMode","single","responsiveLayout","scroll",3,"value","paginator","rows"],["colspan","2"],["id","unitq-help",1,"p-error","block"],["id","unitq-help",1,"pt-1","p-error","block"],["dtr",""],["colspan","3"],["pInputText","","type","text","placeholder","Search...",1,"ui-column-filter",3,"input"],["label","Reprint","icon","pi pi-print","iconPos","right","styleClass","p-button-help p-button-outlined p-button-sm float-right ml-4",3,"onClick"],["label","Show items","icon","pi pi-list","iconPos","right","styleClass","p-button-info p-button-sm float-right",3,"onClick"],["colspan","5"],["appendTo","body","modal","true","header","Items with less quantity available",3,"closable","visible","baseZIndex","visibleChange"],[1,"col-12"],[4,"ngFor","ngForOf"],[1,"p-o","m-0"],[1,"small"]],template:function(e,o){1&e&&(t.YNc(0,ft,25,24,"div",0),t.YNc(1,Xt,25,23,"div",0),t.YNc(2,pe,4,9,"p-dialog",1),t.TgZ(3,"p-dialog",2),t.NdJ("visibleChange",function(l){return o.showReprintForm=l})("onHide",function(){return o.showReprintForm=!1,o.ngOnInit()}),t.YNc(4,he,4,10,"p-table",3),t.TgZ(5,"ngx-spinner",4),t._UZ(6,"p",5),t.qZA()(),t.TgZ(7,"p-dialog",6),t.NdJ("visibleChange",function(l){return o.displayItemsDialog=l})("onHide",function(){return o.displayItemsDialog=!1}),t.TgZ(8,"div",7)(9,"h3",8)(10,"p-button",9),t.NdJ("click",function(){return o.selectReceipt(o.transactionToView,!0)}),t.qZA()(),t.TgZ(11,"div",10),t.YNc(12,xe,4,10,"p-table",3),t.qZA()(),t.TgZ(13,"ngx-spinner",4),t._UZ(14,"p",5),t.qZA()(),t.YNc(15,Se,7,16,"p-dialog",11),t.TgZ(16,"p-overlayPanel",12,13),t.YNc(18,qe,3,3,"ng-template",14),t.qZA(),t.TgZ(19,"p-overlayPanel",12,15),t.YNc(21,Ne,3,3,"ng-template",14),t.qZA(),t._UZ(22,"p-confirmDialog",16),t.TgZ(23,"ngx-spinner",17),t._UZ(24,"p",5),t.qZA()),2&e&&(t.Q6J("ngIf",!o.loading&&!o.showNew),t.xp6(1),t.Q6J("ngIf",!o.loading&&o.showNew),t.xp6(1),t.Q6J("ngIf",o.displaySellDialog),t.xp6(1),t.Akn(t.DdM(31,D)),t.Q6J("closable",!0)("visible",o.showReprintForm)("baseZIndex",1e4),t.xp6(1),t.Q6J("ngIf",o.showReprintForm),t.xp6(1),t.Q6J("fullScreen",!0),t.xp6(2),t.Akn(t.DdM(32,De)),t.Q6J("header",o.displayItemsDialog?o.transactionToView.transaction_code:"")("closable",!0)("visible",o.displayItemsDialog)("baseZIndex",1e4),t.xp6(5),t.Q6J("ngIf",o.displayItemsDialog),t.xp6(1),t.Q6J("fullScreen",!0),t.xp6(2),t.Q6J("ngIf",o.showQuantityError),t.xp6(1),t.Akn(t.DdM(33,J)),t.Q6J("@enter",void 0)("showCloseIcon",!1),t.xp6(3),t.Akn(t.DdM(34,J)),t.Q6J("@enter",void 0)("showCloseIcon",!1),t.xp6(3),t.Akn(t.DdM(35,N)),t.Q6J("baseZIndex",1e4),t.xp6(1),t.Q6J("fullScreen",!0))},dependencies:[u.sg,u.O5,U.Ro,m._Y,m.Fj,m.wV,m.JJ,m.JL,m.Q7,m.c5,m.On,m.F,B.V,w.$_,w.jx,$.Q,E.Hq,E.zx,h.iA,h.lQ,h.YL,h.fz,h.D$,h.Pv,h.U1,h.wT,V.NU,j.o,z.Lt,X.u,W.T,tt.H,et.q,ot.q,it.EU,u.JJ,u.rS,u.uU],styles:["label[_ngcontent-%COMP%]{text-transform:none}.loader[_ngcontent-%COMP%]{width:30px;aspect-ratio:2;--_g: no-repeat radial-gradient(circle closest-side,#02926e 90%,#ffffff);background:var(--_g) 0% 50%,var(--_g) 50% 50%,var(--_g) 100% 50%;background-size:33.3333333333% 50%;animation:l3 1s infinite linear}@keyframes l3{20%{background-position:0% 0%,50% 50%,100% 50%}40%{background-position:0% 100%,50% 0%,100% 50%}60%{background-position:0% 50%,50% 100%,100% 0%}80%{background-position:0% 50%,50% 50%,100% 100%}}[_nghost-%COMP%]     p-colorpicker .p-colorpicker .p-colorpicker-preview{border-radius:30px}[_nghost-%COMP%]     p-dialog .p-dialog-header{border-radius:30px!important}[_nghost-%COMP%]     .p-dialog .p-dialog-footer{border-bottom-right-radius:30px}"],data:{animation:[(0,T.X$)("enter",[(0,T.eR)("void => *",[(0,T.oB)({opacity:0}),(0,T.jt)(1e3,(0,T.oB)({opacity:1}))])])]}}),i})(),data:{title:"Interlocation"}}];let Je=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[M.Bz.forChild(Le),M.Bz]}),i})();var Qe=r(4397);let Fe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[Je,Qe.U]}),i})()}}]);