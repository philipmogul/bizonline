"use strict";(self.webpackChunkmatngular=self.webpackChunkmatngular||[]).push([[303],{3434:(R,P,T)=>{T.d(P,{J:()=>Ci});var A=T(5861),t=T(4650),S=T(2340),w=T(7340),x=T(2841),Z=T(6895),$=T(6498),Q=T(3583),L=T(4313),O=T(9441),j=T(2983),B=T.n(j),W=T(8423),z=T(3166),X=T(7185),tt=T(1927),it=T(1932),et=T(9775),ot=T(805);const nt=["dt"],at=["dt09"],st=["op"];function lt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"p-splitButton",52,53),t.NdJ("onClick",function(){t.CHM(i);const o=t.MAs(1);return t.KtG(o.onDropdownButtonClick(null))}),t.qZA()}if(2&n){const i=t.oxw(2);t.Q6J("model",i.stockActions)}}function rt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"div",54),t._UZ(1,"button",55),t.TgZ(2,"div",56)(3,"button",57),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showStockTakingFormDialog("thermal"))}),t._UZ(4,"i",58),t._uU(5," Thermal receipt "),t.qZA(),t.TgZ(6,"button",59),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showStockTakingFormDialog("pdf"))}),t._UZ(7,"i",60),t._uU(8," Pdf document "),t.qZA(),t.TgZ(9,"button",59),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.showStockTakingFormDialog("excel"))}),t._UZ(10,"i",61),t._uU(11," Excel document "),t.qZA()()()}}function ct(n,s){if(1&n&&(t.TgZ(0,"div",78)(1,"span"),t._uU(2),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(i.name)}}function _t(n,s){if(1&n&&(t.TgZ(0,"div",78)(1,"span"),t._uU(2),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(i.vat_percent)}}function pt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"tr",62),t._UZ(1,"th",63),t.TgZ(2,"th",64),t._uU(3,"Item "),t._UZ(4,"p-sortIcon",65),t.qZA(),t.TgZ(5,"th",66),t._uU(6,"Category "),t._UZ(7,"p-sortIcon",67),t.qZA(),t.TgZ(8,"th",68),t._uU(9,"Buying price "),t._UZ(10,"p-sortIcon",69),t.qZA(),t.TgZ(11,"th",70),t._uU(12,"VAT "),t._UZ(13,"p-sortIcon",71),t.qZA(),t.TgZ(14,"th",72),t._uU(15,"Locations "),t.qZA(),t.TgZ(16,"th",72),t._uU(17,"Units "),t.qZA(),t._UZ(18,"th",73),t.qZA(),t.TgZ(19,"tr"),t._UZ(20,"th"),t.TgZ(21,"th")(22,"input",74),t.NdJ("input",function(o){t.CHM(i),t.oxw();const a=t.MAs(9);return t.KtG(a.filter(o.target.value,"name","contains"))}),t.qZA()(),t.TgZ(23,"th")(24,"p-multiSelect",75),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.onCategoryChange(o))}),t.YNc(25,ct,3,1,"ng-template",76),t.qZA()(),t._UZ(26,"th"),t.TgZ(27,"th")(28,"p-multiSelect",77),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.onVatChange(o))}),t.YNc(29,_t,3,1,"ng-template",76),t.qZA()(),t._UZ(30,"th")(31,"th")(32,"th"),t.qZA()}if(2&n){const i=t.oxw(2);t.xp6(24),t.Q6J("options",i.categories),t.xp6(4),t.Q6J("options",i.vat_records)}}function dt(n,s){if(1&n&&t._UZ(0,"img",89),2&n){const i=t.oxw(3);t.Q6J("src",i.productImagesUrl+"default.png",t.LSH)}}function ut(n,s){if(1&n&&t._UZ(0,"img",89),2&n){const i=t.oxw().$implicit,e=t.oxw(2);t.s9C("src",e.productImagesUrl+i.image,t.LSH)}}const K=function(n){return{"background-color":n,color:"#ffffff",cursor:"pointer"}};function mt(n,s){if(1&n&&t._UZ(0,"p-avatar",92),2&n){const i=s.index,e=t.oxw(4);t.Akn(t.VKq(2,K,e.locations[i].color))}}const G=function(){return[]};function gt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"p-avatarGroup",90),t.NdJ("click",function(o){t.CHM(i);const a=t.oxw().$implicit,l=t.oxw(2);return t.KtG(l.showLocationsQuantity(a,o))}),t.YNc(1,mt,1,4,"p-avatar",91),t.qZA()}if(2&n){const i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",t.DdM(1,G).constructor(i.locations_count))}}function ht(n,s){1&n&&(t.TgZ(0,"small",93),t._uU(1," Missing units "),t.qZA())}function ft(n,s){1&n&&(t.TgZ(0,"small",94),t._uU(1," Selling price low "),t.qZA())}function Tt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"button",59),t.NdJ("click",function(){t.CHM(i);const o=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.confirmDeleteDialog(o))}),t._UZ(1,"i",95),t._uU(2," Delete item "),t.qZA()}}function xt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"tr",79)(1,"td",80),t.YNc(2,dt,1,1,"img",81),t.YNc(3,ut,1,1,"img",81),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"titlecase"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"titlecase"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td")(14,"span"),t._uU(15),t.ALo(16,"number"),t.qZA()(),t.TgZ(17,"td"),t.YNc(18,gt,2,2,"p-avatarGroup",82),t.YNc(19,ht,2,0,"small",83),t.qZA(),t.TgZ(20,"td"),t._uU(21),t._UZ(22,"br"),t.YNc(23,ft,2,0,"small",84),t.qZA(),t.TgZ(24,"td")(25,"div",85)(26,"button",86),t._uU(27," Select an action "),t.qZA(),t.TgZ(28,"div",56)(29,"button",59),t.NdJ("click",function(){const a=t.CHM(i).$implicit,l=t.oxw(2);return t.KtG(l.showEditDialog(a))}),t._UZ(30,"i",87),t._uU(31," Edit details "),t.qZA(),t.YNc(32,Tt,3,0,"button",88),t.qZA()()()()}if(2&n){const i=s.$implicit,e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",""==i.image),t.xp6(1),t.Q6J("ngIf",""!=i.image),t.xp6(2),t.hij(" ",t.lcZ(6,14,i.name)," "),t.xp6(3),t.hij(" ",t.lcZ(9,16,i.category.name)," "),t.xp6(3),t.hij(" ",t.xi3(12,18,i.buying_price*i.max_unit_qty,".2")," "),t.xp6(3),t.Tol(e.vat>0?"customer-badge success":"customer-badge danger"),t.xp6(1),t.hij(" ",t.lcZ(16,21,i.vat.vat_percent)," "),t.xp6(3),t.Q6J("ngIf",i.locations_count>0&&1==i.min_unit_ok),t.xp6(1),t.Q6J("ngIf",i.units<1||0==i.min_unit_ok),t.xp6(2),t.hij(" ",i.units," "),t.xp6(2),t.Q6J("ngIf",0==i.sp_units_ok),t.xp6(3),t.Q6J("loading",null!=e.itemToViewLocations&&e.itemToViewLocations.id===i.id&&e.loading2),t.xp6(6),t.Q6J("ngIf",e.userIsAdmin)}}const F=function(){return[10,25,50]},J=function(){return["name","description"]};function yt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"div",44)(1,"div",45)(2,"h4",46),t._uU(3," Stock items "),t.YNc(4,lt,2,1,"p-splitButton",47),t.YNc(5,rt,12,0,"div",48),t.TgZ(6,"p-button",49),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.showStockItemsToAddDialog())}),t.qZA()()(),t.TgZ(7,"div",50)(8,"p-table",17,51),t.YNc(10,pt,33,2,"ng-template",19),t.YNc(11,xt,33,23,"ng-template",20),t.qZA()()()}if(2&n){const i=t.oxw();t.Q6J("@enter",void 0),t.xp6(4),t.Q6J("ngIf",i.userIsAdmin),t.xp6(1),t.Q6J("ngIf",i.userIsAdmin),t.xp6(1),t.Tol(i.minItemsTotal>0?"animate-flicker":""),t.s9C("badge",i.minItemsTotal),t.Q6J("icon",i.minItemsTotal>0?"pi pi-exclamation-triangle":"")("styleClass",i.minItemsTotal>0?"p-button-warning p-button-sm float-right mr-5":"p-button-success p-button-sm float-right mr-5"),t.xp6(2),t.Q6J("value",i.allStock)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(16,F))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(17,J))}}function vt(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const i=s.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,i.name))}}function bt(n,s){if(1&n&&(t.TgZ(0,"div",104)(1,"div"),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,i.name))}}function At(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"form",26,27),t.NdJ("ngSubmit",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.addNewItem())}),t.TgZ(2,"div",96)(3,"div",29)(4,"div",97)(5,"div",98)(6,"label",32),t._uU(7,"Item name"),t.qZA(),t.TgZ(8,"input",99),t.NdJ("ngModelChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.newItemModel.name=o)}),t.qZA()(),t.TgZ(9,"div",98)(10,"label",32),t._uU(11,"Category"),t.qZA(),t._UZ(12,"br"),t.TgZ(13,"p-dropdown",100),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.updateNewItemCategory(o))})("ngModelChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.newItemModel.category=o)}),t.YNc(14,vt,3,3,"ng-template",101),t.YNc(15,bt,4,3,"ng-template",76),t.qZA()()()()(),t.TgZ(16,"p-footer"),t._UZ(17,"button",102),t.TgZ(18,"button",103),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.hideNewItemDialog())}),t.qZA()()()}if(2&n){const i=t.MAs(1),e=t.oxw();t.xp6(8),t.Q6J("ngModel",e.newItemModel.name),t.xp6(5),t.Q6J("options",e.categories)("ngModel",e.newItemModel.category),t.xp6(4),t.Q6J("disabled",!i.valid||null==e.newItemModel.category)}}function Ct(n,s){if(1&n&&t._UZ(0,"app-notification",105),2&n){const i=t.oxw();t.Q6J("message","Item added!")("showNotification",i.showNotification)}}function Zt(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const i=s.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,i.name))}}function kt(n,s){if(1&n&&(t.TgZ(0,"div",104)(1,"div"),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,i.name))}}function St(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"form",26,106),t.NdJ("ngSubmit",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.updateItem())}),t.TgZ(2,"div",96)(3,"div",29)(4,"div",97)(5,"div",98)(6,"label",32),t._uU(7,"Item name"),t.qZA(),t.TgZ(8,"input",99),t.NdJ("ngModelChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.itemToEdit.name=o)}),t.qZA()(),t.TgZ(9,"div",98)(10,"label",32),t._uU(11,"Category"),t.qZA(),t._UZ(12,"br"),t.TgZ(13,"p-dropdown",100),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.updateEditItemCategory(o))})("ngModelChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.itemToEdit.category=o)}),t.YNc(14,Zt,3,3,"ng-template",101),t.YNc(15,kt,4,3,"ng-template",76),t.qZA()()()()(),t.TgZ(16,"p-footer"),t._UZ(17,"button",107),t.TgZ(18,"button",103),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.hideEditItemDialog())}),t.qZA()()()}if(2&n){const i=t.MAs(1),e=t.oxw();t.xp6(8),t.Q6J("ngModel",e.itemToEdit.name),t.xp6(5),t.Q6J("options",e.categories)("ngModel",e.itemToEdit.category),t.xp6(4),t.Q6J("disabled",!i.valid||null==e.itemToEdit.category)}}function wt(n,s){if(1&n&&t._UZ(0,"app-notification",105),2&n){const i=t.oxw();t.Q6J("message","Item updated!")("showNotification",i.showNotification)}}function Et(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const i=s.$implicit;t.xp6(1),t.Oqu(i.unit_name)}}function qt(n,s){if(1&n&&(t.TgZ(0,"div",104)(1,"div"),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,i.unit_name))}}function Dt(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const i=s.$implicit;t.xp6(1),t.Oqu(i.vat_percent)}}function It(n,s){if(1&n&&(t.TgZ(0,"div",104)(1,"div"),t._uU(2),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(i.vat_percent)}}function Mt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"form",26,106),t.NdJ("ngSubmit",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.updateItemBp())}),t.TgZ(2,"div",96)(3,"div",29)(4,"div",97)(5,"div",98)(6,"label"),t._uU(7,"Unit to set buying price"),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"p-dropdown",110),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.updateEditItemBpUnit(o))})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.itemToEdit.unit=o)}),t.YNc(10,Et,2,1,"ng-template",101),t.YNc(11,qt,4,3,"ng-template",76),t.qZA()(),t.TgZ(12,"div",98)(13,"label"),t._uU(14,"Unit buying price (VAT Exclusive)"),t.qZA(),t.TgZ(15,"input",111),t.NdJ("input",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.updatePriceWithVAT())})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.itemToEdit.buying_price=o)}),t.qZA()(),t.TgZ(16,"div",98)(17,"label"),t._uU(18,"VAT %"),t.qZA(),t._UZ(19,"br"),t.TgZ(20,"p-dropdown",112),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.updateEditItemVat(o))})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.itemToEdit.vat=o)}),t.YNc(21,Dt,2,1,"ng-template",101),t.YNc(22,It,3,1,"ng-template",76),t.qZA()(),t.TgZ(23,"div",98)(24,"label"),t._uU(25,"Unit buying price VAT Inclusive"),t.qZA(),t.TgZ(26,"input",113),t.NdJ("input",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.updatePriceWithVAT2())})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.totalBuyingPrice=o)}),t.qZA()()()()(),t.TgZ(27,"p-footer"),t._UZ(28,"button",107),t.TgZ(29,"button",103),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.closeBpDialog())}),t.qZA()()()}if(2&n){const i=t.MAs(1),e=t.oxw(2);t.xp6(9),t.Q6J("options",e.itemToEdit.selling_units)("ngModel",e.itemToEdit.unit),t.xp6(6),t.Q6J("ngModel",e.itemToEdit.buying_price),t.xp6(5),t.Q6J("options",e.vat_records)("ngModel",e.itemToEdit.vat),t.xp6(6),t.Q6J("disabled",0==e.itemToEdit.vat.vat_percent)("ngModel",e.totalBuyingPrice),t.xp6(2),t.Q6J("disabled",!i.valid||null==e.itemToEdit.category||null==e.itemToEdit.vat||e.totalBuyingPrice<=0)}}function Ut(n,s){if(1&n&&t._UZ(0,"app-notification",105),2&n){const i=t.oxw(2);t.Q6J("message","Buying price updated!")("showNotification",i.showNotification)}}const H=function(){return{width:"40vw"}};function Nt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"p-dialog",108),t.NdJ("visibleChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.displayBuyingPriceDialog=o)}),t.YNc(1,Mt,30,8,"form",2),t.YNc(2,Ut,1,2,"app-notification",3),t.TgZ(3,"ngx-spinner",109),t._UZ(4,"p",5),t.qZA()()}if(2&n){const i=t.oxw();t.Akn(t.DdM(10,H)),t.Q6J("blockScroll",!0)("header",i.showNotification?"":"Change buying price for "+i.itemToEdit.name)("closable",!1)("visible",i.displayBuyingPriceDialog)("baseZIndex",1e4),t.xp6(1),t.Q6J("ngIf",!i.showNotification),t.xp6(1),t.Q6J("ngIf",i.showNotification),t.xp6(1),t.Q6J("fullScreen",!1)}}const Y=function(){return{width:"80vw"}};function Pt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"p-dialog",108),t.NdJ("visibleChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.showItemUnitsDialog=o)}),t.ALo(1,"titlecase"),t.TgZ(2,"app-stock-units",114),t.NdJ("priceUpdated",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.itemUnits.sp_units_ok=!0)}),t.qZA(),t.TgZ(3,"p-footer")(4,"button",10),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return o.showItemUnitsDialog=!1,t.KtG(o.ngOnInit())}),t.qZA()()()}if(2&n){const i=t.oxw();t.Akn(t.DdM(12,Y)),t.MGl("header","Selling units for ",t.lcZ(1,10,i.itemUnits.name),""),t.Q6J("blockScroll",!0)("closable",!1)("visible",i.showItemUnitsDialog)("baseZIndex",1e4),t.xp6(2),t.Q6J("units",i.itemUnits.selling_units)("item_id",i.itemUnits.id)("buying_price",i.itemUnits.buying_price)}}function Jt(n,s){if(1&n&&(t.TgZ(0,"div",125)(1,"div",126)(2,"div",117)(3,"div",118)(4,"div",119),t._UZ(5,"div",120),t.TgZ(6,"div",121)(7,"h5",122)(8,"span",123),t._uU(9,"Ksh"),t.qZA(),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"span"),t._uU(13),t.ALo(14,"titlecase"),t.qZA()()()()()()()),2&n){const i=s.$implicit;t.xp6(10),t.hij(" ",t.xi3(11,2,i.total_amount,".2")," "),t.xp6(3),t.Oqu(t.lcZ(14,5,i.name))}}function Qt(n,s){if(1&n&&(t.TgZ(0,"div")(1,"div",115)(2,"div",116)(3,"div",117)(4,"div",118)(5,"div",119),t._UZ(6,"div",120),t.TgZ(7,"div",121)(8,"h3",122)(9,"span",123),t._uU(10,"Ksh"),t.qZA(),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"span"),t._uU(14,"Total stock value"),t.qZA()()()()()()(),t.YNc(15,Jt,15,7,"div",124),t.qZA()),2&n){const i=t.oxw();t.xp6(11),t.hij(" ",t.xi3(12,2,i.totalStockValue,".2")," "),t.xp6(4),t.Q6J("ngForOf",i.locationsValue)}}function Lt(n,s){1&n&&(t.TgZ(0,"div")(1,"p",127),t._uU(2," Selling units for some items are not setup correctly. "),t._UZ(3,"br"),t._uU(4," Correct them to get the accurate stock value! "),t.qZA()())}function Ot(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"tr",62)(1,"th",128),t._uU(2,"Category "),t._UZ(3,"p-sortIcon",65),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Value "),t.qZA()(),t.TgZ(6,"tr")(7,"th")(8,"input",129),t.NdJ("input",function(o){t.CHM(i),t.oxw();const a=t.MAs(28);return t.KtG(a.filter(o.target.value,"name","contains"))}),t.qZA()(),t._UZ(9,"th"),t.qZA()}}function Bt(n,s){if(1&n&&(t.TgZ(0,"tr",79)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"number"),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,2,i.name)," "),t.xp6(3),t.hij(" ",t.xi3(6,4,i.total_amount,".2")," ")}}function Kt(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const i=s.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,i.name))}}function Gt(n,s){if(1&n&&(t.TgZ(0,"div",104)(1,"div"),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,i.name))}}function Ft(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"div",31)(1,"label",139),t._uU(2,"Print order"),t.qZA(),t.TgZ(3,"div",140)(4,"p-radioButton",141),t.NdJ("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.printOrder=o)})("onClick",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.printOrder="alphabet")}),t.qZA(),t.TgZ(5,"label",142),t._uU(6,"Alphabetical order "),t.qZA()(),t.TgZ(7,"div",140)(8,"p-radioButton",143),t.NdJ("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.printOrder=o)})("onClick",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.printOrder="category")}),t.qZA(),t.TgZ(9,"label",144),t._uU(10,"Categorical order"),t.qZA()()()}if(2&n){const i=t.oxw(2);t.xp6(4),t.Q6J("ngModel",i.printOrder),t.xp6(4),t.Q6J("ngModel",i.printOrder)}}const D=function(){return{width:"30vw"}};function Ht(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"p-dialog",130),t.NdJ("visibleChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.showStockTakingForm=o)}),t.TgZ(1,"form",26,27),t.NdJ("ngSubmit",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.getPrintData())}),t.TgZ(3,"div",96)(4,"div",29)(5,"div",97)(6,"div",131)(7,"label",132),t._uU(8,"Select item locations"),t.qZA(),t._UZ(9,"br"),t.TgZ(10,"p-dropdown",133),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.updateLocationSelected(o))})("ngModelChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.locationToPrint=o)}),t.YNc(11,Kt,3,3,"ng-template",101),t.YNc(12,Gt,4,3,"ng-template",76),t.qZA()(),t.YNc(13,Ft,11,2,"div",134),t.qZA()()(),t.TgZ(14,"p-footer")(15,"div",96)(16,"div",135)(17,"button",136),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return o.showStockTakingForm=!1,o.locationToPrint=null,o.stockLocations=[],t.KtG(o.printOrder="")}),t.qZA(),t._UZ(18,"button",137),t.qZA()()()(),t.TgZ(19,"ngx-spinner",138),t._UZ(20,"p",5),t.qZA()()}if(2&n){const i=t.MAs(2),e=t.oxw();t.Akn(t.DdM(12,D)),t.Q6J("closable",!1)("visible",e.showStockTakingForm)("baseZIndex",1e4),t.xp6(10),t.Q6J("options",e.stockLocations)("ngModel",e.locationToPrint),t.xp6(3),t.Q6J("ngIf","thermal"!=e.printType),t.xp6(5),t.Q6J("disabled",!i.valid||null==e.locationToPrint||"thermal"!=e.printType&&""==e.printOrder)("icon","thermal"===e.printType?"pi pi-print":"pi pi-download")("label","thermal"===e.printType?"Print receipt":"Download pdf"),t.xp6(1),t.Q6J("fullScreen",!1)}}function Yt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"tr",62),t._UZ(1,"th",63),t.TgZ(2,"th",64),t._uU(3,"Item "),t._UZ(4,"p-sortIcon",65),t.qZA(),t.TgZ(5,"th",66),t._uU(6,"Category "),t._UZ(7,"p-sortIcon",67),t.qZA(),t.TgZ(8,"th",72),t._uU(9,"Locations "),t.qZA(),t._UZ(10,"th",73),t.qZA(),t.TgZ(11,"tr"),t._UZ(12,"th"),t.TgZ(13,"th")(14,"input",74),t.NdJ("input",function(o){t.CHM(i),t.oxw();const a=t.MAs(28);return t.KtG(a.filter(o.target.value,"name","contains"))}),t.qZA()(),t._UZ(15,"th")(16,"th")(17,"th"),t.qZA()}}function Vt(n,s){if(1&n&&t._UZ(0,"img",89),2&n){const i=t.oxw(2);t.Q6J("src",i.productImagesUrl+"default.png",t.LSH)}}function Rt(n,s){if(1&n&&t._UZ(0,"img",89),2&n){const i=t.oxw().$implicit,e=t.oxw();t.s9C("src",e.productImagesUrl+i.image,t.LSH)}}function $t(n,s){if(1&n&&t._UZ(0,"p-avatar",92),2&n){const i=s.index,e=t.oxw(3);t.Akn(t.VKq(2,K,e.locations[i].color))}}function jt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"p-avatarGroup",90),t.NdJ("click",function(o){t.CHM(i);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.showLocationsQuantity(a,o))}),t.YNc(1,$t,1,4,"p-avatar",91),t.qZA()}if(2&n){const i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",t.DdM(1,G).constructor(i.locations_count))}}function Wt(n,s){1&n&&(t.TgZ(0,"small",93),t._uU(1," Missing units "),t.qZA())}function zt(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"tr",79)(1,"td",80),t.YNc(2,Vt,1,1,"img",81),t.YNc(3,Rt,1,1,"img",81),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"titlecase"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"titlecase"),t.qZA(),t.TgZ(10,"td"),t.YNc(11,jt,2,2,"p-avatarGroup",82),t.YNc(12,Wt,2,0,"small",83),t.qZA(),t.TgZ(13,"td")(14,"button",145),t.NdJ("click",function(){const a=t.CHM(i).$implicit,l=t.oxw();return t.KtG(l.showEditDialog(a))}),t._UZ(15,"i",87),t._uU(16," Change alert level "),t.qZA()()()}if(2&n){const i=s.$implicit,e=t.oxw();t.xp6(2),t.Q6J("ngIf",""==i.image),t.xp6(1),t.Q6J("ngIf",""!=i.image),t.xp6(2),t.hij(" ",t.lcZ(6,7,i.name)," "),t.xp6(3),t.hij(" ",t.lcZ(9,9,i.category.name)," "),t.xp6(3),t.Q6J("ngIf",i.locations_count>0&&1==i.min_unit_ok),t.xp6(1),t.Q6J("ngIf",i.units<1||0==i.min_unit_ok),t.xp6(2),t.Q6J("loading",null!=e.itemToViewLocations&&e.itemToViewLocations.id===i.id&&e.loading2)}}function Xt(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const i=s.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,i.name))}}function ti(n,s){if(1&n&&(t.TgZ(0,"div",104)(1,"div"),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,i.name))}}function ii(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"div")(1,"div",149)(2,"div",150)(3,"form",26,106),t.NdJ("ngSubmit",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.updateItem())}),t.TgZ(5,"div",151)(6,"div",29)(7,"div",97)(8,"div",98)(9,"label",32),t._uU(10,"Item name"),t.qZA(),t.TgZ(11,"input",99),t.NdJ("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.itemToEdit.name=o)}),t.qZA()(),t.TgZ(12,"div",98)(13,"label",32),t._uU(14,"Category"),t.qZA(),t._UZ(15,"br"),t.TgZ(16,"p-dropdown",100),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.updateEditItemCategory(o))})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.itemToEdit.category=o)}),t.YNc(17,Xt,3,3,"ng-template",101),t.YNc(18,ti,4,3,"ng-template",76),t.qZA()(),t._UZ(19,"button",152),t.qZA()()()()()(),t.TgZ(20,"ngx-spinner",6),t._UZ(21,"p",5),t.qZA()()}if(2&n){const i=t.MAs(4),e=t.oxw(2);t.xp6(11),t.Q6J("ngModel",e.itemToEdit.name),t.xp6(5),t.Q6J("options",e.categories)("ngModel",e.itemToEdit.category),t.xp6(3),t.Q6J("disabled",!i.valid||null==e.itemToEdit.category),t.xp6(1),t.Q6J("fullScreen",!1)}}function ei(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"div",153)(1,"app-stock-units",154),t.NdJ("priceUpdated",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.itemToEdit.sp_units_ok=!0)}),t.qZA(),t.TgZ(2,"ngx-spinner",155),t._UZ(3,"p",5),t.qZA()()}if(2&n){const i=t.oxw(2);t.xp6(1),t.Q6J("units",i.itemToEdit.selling_units)("item_id",i.itemToEdit.id)("buying_price",i.itemToEdit.buying_price)("totalQty",i.itemToEdit.location_qty),t.xp6(1),t.Q6J("fullScreen",!1)}}function oi(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const i=s.$implicit;t.xp6(1),t.Oqu(i.unit_name)}}function ni(n,s){if(1&n&&(t.TgZ(0,"div",104)(1,"div"),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,i.unit_name))}}function ai(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const i=s.$implicit;t.xp6(1),t.Oqu(i.vat_percent)}}function si(n,s){if(1&n&&(t.TgZ(0,"div",104)(1,"div"),t._uU(2),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(i.vat_percent)}}function li(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"form",26,106),t.NdJ("ngSubmit",function(){t.CHM(i);const o=t.oxw(3);return t.KtG(o.updateItemBp())}),t.TgZ(2,"div",96)(3,"div",29)(4,"div",97)(5,"div",98)(6,"label"),t._uU(7,"Unit to set buying price"),t.qZA(),t._UZ(8,"br"),t.TgZ(9,"p-dropdown",110),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw(3);return t.KtG(a.updateEditItemBpUnit(o))})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(3);return t.KtG(a.itemToEdit.unit=o)}),t.YNc(10,oi,2,1,"ng-template",101),t.YNc(11,ni,4,3,"ng-template",76),t.qZA()(),t.TgZ(12,"div",98)(13,"label"),t._uU(14,"Unit buying price (VAT Exclusive)"),t.qZA(),t.TgZ(15,"input",157),t.NdJ("input",function(){t.CHM(i);const o=t.oxw(3);return t.KtG(o.updatePriceWithVAT())})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(3);return t.KtG(a.itemToEdit.buying_price=o)}),t.qZA()(),t.TgZ(16,"div",98)(17,"label"),t._uU(18,"VAT %"),t.qZA(),t._UZ(19,"br"),t.TgZ(20,"p-dropdown",112),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw(3);return t.KtG(a.updateEditItemVat(o))})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(3);return t.KtG(a.itemToEdit.vat=o)}),t.YNc(21,ai,2,1,"ng-template",101),t.YNc(22,si,3,1,"ng-template",76),t.qZA()(),t.TgZ(23,"div",98)(24,"label"),t._uU(25,"Unit buying price VAT Inclusive"),t.qZA(),t.TgZ(26,"input",113),t.NdJ("input",function(){t.CHM(i);const o=t.oxw(3);return t.KtG(o.updatePriceWithVAT2())})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(3);return t.KtG(a.totalBuyingPrice=o)}),t.qZA()(),t._UZ(27,"button",152),t.qZA()()()()}if(2&n){const i=t.MAs(1),e=t.oxw(3);t.xp6(9),t.Q6J("options",e.itemToEdit.selling_units)("ngModel",e.itemToEdit.unit),t.xp6(6),t.Q6J("disabled",null==e.itemToEdit.unit)("ngModel",e.itemToEdit.buying_price),t.xp6(5),t.Q6J("options",e.vat_records)("ngModel",e.itemToEdit.vat),t.xp6(6),t.Q6J("disabled",0==e.itemToEdit.vat.vat_percent)("ngModel",e.totalBuyingPrice),t.xp6(1),t.Q6J("disabled",!i.valid||null==e.itemToEdit.unit||null==e.itemToEdit.vat||e.totalBuyingPrice<=0)}}function ri(n,s){if(1&n&&(t.TgZ(0,"div",153)(1,"div",149)(2,"div",156),t.YNc(3,li,28,9,"form",2),t.qZA()(),t.TgZ(4,"ngx-spinner",109),t._UZ(5,"p",5),t.qZA()()),2&n){const i=t.oxw(2);t.xp6(3),t.Q6J("ngIf",!i.showNotification),t.xp6(1),t.Q6J("fullScreen",!1)}}function ci(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const i=s.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,i.unit_name))}}function _i(n,s){if(1&n&&(t.TgZ(0,"div",104)(1,"div"),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&n){const i=s.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,i.unit_name))}}function pi(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"div")(1,"div",149)(2,"div",150)(3,"form",26,106),t.NdJ("ngSubmit",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.updateItemAlertLevel())}),t.TgZ(5,"div",151)(6,"div",29)(7,"div",97)(8,"div",98)(9,"label",32),t._uU(10,"Unit"),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"p-dropdown",110),t.NdJ("onChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.updateEditItemCategory(o))})("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.itemToEdit.alert_unit=o)}),t.YNc(13,ci,3,3,"ng-template",101),t.YNc(14,_i,4,3,"ng-template",76),t.qZA()(),t.TgZ(15,"div",98)(16,"label",32),t._uU(17,"Minimum quantity"),t.qZA(),t.TgZ(18,"input",158),t.NdJ("ngModelChange",function(o){t.CHM(i);const a=t.oxw(2);return t.KtG(a.itemToEdit.alert_quantity=o)}),t.qZA()(),t._UZ(19,"button",152),t.qZA()()()(),t.TgZ(20,"ngx-spinner",6),t._UZ(21,"p",5),t.qZA()()()()}if(2&n){const i=t.MAs(4),e=t.oxw(2);t.xp6(12),t.Q6J("options",e.itemToEdit.selling_units)("ngModel",e.itemToEdit.alert_unit),t.xp6(6),t.Q6J("ngModel",e.itemToEdit.alert_quantity),t.xp6(1),t.Q6J("disabled",!i.valid||null==e.itemToEdit.alert_unit),t.xp6(1),t.Q6J("fullScreen",!1)}}function di(n,s){if(1&n){const i=t.EpF();t.TgZ(0,"div",96)(1,"div",146)(2,"p-steps",147),t.NdJ("activeIndexChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.activeIndex=o)})("activeIndexChange",function(o){t.CHM(i);const a=t.oxw();return t.KtG(a.check(o))}),t.qZA(),t.YNc(3,ii,22,5,"div",16),t.YNc(4,ei,4,5,"div",148),t.YNc(5,ri,6,2,"div",148),t.YNc(6,pi,22,5,"div",16),t.qZA()()}if(2&n){const i=t.oxw();t.xp6(2),t.Q6J("model",i.items)("activeIndex",i.activeIndex)("readonly",!1),t.xp6(1),t.Q6J("ngIf",0===i.activeIndex&&i.userIsAdmin),t.xp6(1),t.Q6J("ngIf",1===i.activeIndex&&i.userIsAdmin),t.xp6(1),t.Q6J("ngIf",2===i.activeIndex),t.xp6(1),t.Q6J("ngIf",3===i.activeIndex&&i.userIsAdmin)}}function ui(n,s){if(1&n&&(t.TgZ(0,"th"),t._uU(1),t.ALo(2,"titlecase"),t.TgZ(3,"p",161)(4,"i",162),t._uU(5),t.ALo(6,"number"),t.qZA()()()),2&n){const i=s.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,2,i.unit_name)," "),t.xp6(4),t.hij("(",t.lcZ(6,4,i.unit_quantity),")")}}function mi(n,s){if(1&n&&(t.TgZ(0,"tr"),t._UZ(1,"th"),t.TgZ(2,"th"),t._uU(3,"Location"),t.qZA(),t.YNc(4,ui,7,6,"th",160),t.qZA()),2&n){const i=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",i.itemToViewLocations.selling_units)}}function gi(n,s){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&n){const i=s.$implicit,e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.hij(" ",o.getLocationUnitQuantity(e.location_quantity,o.itemToViewLocations.selling_units)[i.unit_name]," ")}}const hi=function(n){return{"background-color":n,color:"#ffffff"}};function fi(n,s){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"p-avatar",92),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.YNc(6,gi,2,1,"td",160),t.qZA()),2&n){const i=s.$implicit,e=t.oxw(2);t.xp6(2),t.Akn(t.VKq(6,hi,i.location.color)),t.xp6(2),t.Oqu(t.lcZ(5,4,i.location.name)),t.xp6(2),t.Q6J("ngForOf",e.itemToViewLocations.selling_units)}}function Ti(n,s){if(1&n&&(t.TgZ(0,"p-table",159),t.YNc(1,mi,5,1,"ng-template",19),t.YNc(2,fi,7,8,"ng-template",20),t.qZA()),2&n){const i=t.oxw();t.Q6J("value",i.itemToViewLocations.locations_qty)("paginator",!1)("rows",5)}}const xi=function(){return{width:"50vw"}},yi=function(){return{width:"70vw"}},vi=function(){return[5,10,25,50]},bi=function(){return{width:"90vw"}},Ai=function(){return{width:"450px"}};let Ci=(()=>{class n{constructor(i,e,o,a,l,p,h,r,c,_,m){this.spinner=i,this.cryptoSrv=e,this.toastr=o,this.authSrv=a,this.apiSrv=l,this.printSrv=p,this.confirmationService=h,this._decimalPipe=r,this.datepipe=c,this.cdr=_,this.locale=m,this.allStock=[],this.categories=[],this.locations=[],this.vat_records=[],this.productImagesUrl=S.N.imageUrls,this.displayNewItemDialog=!1,this.displayVATRecords=!1,this.displayCategoriesDialog=!1,this.displayEditDialog=!1,this.itemToEdit={},this.itemToEditDefault={},this.displayBuyingPriceDialog=!1,this.uploadedFiles1=[],this.newItemModel={},this.stockActions=[],this.itemUnits={},this.showItemUnitsDialog=!1,this.loading=!0,this.totalBuyingPrice=0,this.totalBuyingPriceNew=0,this.showNotification=!1,this.showValueDialog=!1,this.totalStockValue="",this.locationsValue=[],this.categoriesValues=[],this.printData=[],this.shopLogoUrl=S.N.shopLogoUrls,this.showStockTakingForm=!1,this.stockLocations=[],this.printType="",this.printOrder="",this.userIsAdmin=!1,this.showStepDialog=!1,this.items=[{label:"Item name"},{label:"Selling units"},{label:"Buying price"},{label:"Alert level"}],this.activeIndex=0,this.displayItemsToAddDialog=!1,this.minItemsQuantity=0,this.minQtyToEdit=0,this.minQtyToEditDefault=0,this.displayMinimumQuantityDialog=!1,this.minItems=[],this.minItemsTotal=0,this.loading2=!1}ngOnInit(){"admin"===this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("role"))||"1"===this.cryptoSrv.decryptEncodedText(this.authSrv.getRoleToken("manage_stock"))?("admin"===this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("role"))&&(this.userIsAdmin=!0),this.getAllStock(),this.stockActions=[{label:"Add a new item",icon:"pi pi-plus",command:()=>{this.showNewDialog()}},{separator:!0},{label:"Stock categories",icon:"pi pi-list",command:()=>{this.displayCategoriesDialog=!0}},{separator:!0},{label:"Manage VAT",icon:"pi pi-percentage",command:()=>{this.displayVATRecords=!0}},{separator:!0},{label:"Show stock value",icon:"pi pi-money-bill",command:()=>{this.getStockValue()}}]):(this.toastr.error("You have no rights to access that page!"),this.authSrv.logout())}getAllStock(){this.spinner.show();const i={action:this.cryptoSrv.encodeEncryptText("get-all-stock-new"),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(i).then(e=>{"error"!=e.status?"error2"!=e.status?(this.allStock=e.data.stock,this.categories=e.data.categories,this.vat_records=e.data.vat_records,this.locations=e.data.locations,this.minItemsTotal=e.data.min_items,this.allStock.forEach(o=>{o.attention=0,parseInt(o.prices_ok.toString())>0?(o.prices_ok=!1,o.sp_units_ok=!1,o.attention=1):(o.prices_ok=!0,o.sp_units_ok=!0),parseInt(o.min_qty_ok.toString())<1||parseInt(o.min_qty_ok.toString())>1?(o.min_qty_ok=!1,o.min_unit_ok=!1,o.attention=1):(o.min_qty_ok=!0,o.min_unit_ok=!0),o.locations_count=parseInt(o.locations_count.toString()),o.category=this.categories.find(a=>a.id===o.category_id),o.vat=this.vat_records.find(a=>a.id===o.vat_id)}),this.allStock=this.allStock.sort((o,a)=>a.attention-o.attention),this.loading=!1,this.spinner.hide()):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(e.message))}).catch(e=>{this.toastr.error(e),this.spinner.hide()})}getBuyingPrice(i){const e=i.buying_price;return i.selling_units.length>0?(i.selling_units.sort((a,l)=>l.unit_quantity-a.unit_quantity),e*i.selling_units[0].unit_quantity):0}showLocationsQuantity(i,e){if(i.selling_units)this.itemToViewLocations=i,this.overlay.toggle(e);else{this.loading2=!0;let o=this.allStock.find(l=>l.id===i.id);this.itemToViewLocations=o;const a={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:i.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(a).then(l=>{if("error"!=l.status)if("error2"!=l.status){o.selling_units=l.selling_units,o.locations_qty=l.locations_qty,o.total_qty=l.total_qty,o.locations=l.locations;let p=l.alert_unit;l.alert_unit&&(o.alert_unit=o.selling_units.find(h=>h.id===p.id),o.alert_quantity=l.alert_quantity),this.overlay.toggle(e),this.loading2=!1}else this.loading2=!1,this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.loading2=!1,this.toastr.error(l.message)}).catch(l=>{this.toastr.error(l),this.loading2=!1})}}getLocationUnitQuantity(i,e){const o={};return(e=e.sort((a,l)=>l.unit_quantity-a.unit_quantity)).forEach(a=>{if(i>0){const l=Math.floor(i/a.unit_quantity);o[a.unit_name]=l,i-=l*a.unit_quantity}else o[a.unit_name]=0}),o}onCategoryChange(i){this.table.filter(i.value,"category","in")}onCategoryChange2(i){this.table2.filter(i.value,"category","in")}onVatChange(i){this.table.filter(i.value,"vat","in")}onVatChange2(i){this.table2.filter(i.value,"vat","in")}showEditBpDialog(i){i.selling_units.length>0?(this.showNotification=!1,this.itemToEdit=i,this.itemToEditDefault=this.apiSrv.deepCopy(i),this.itemToEdit.unit=this.itemToEdit.selling_units[0],this.itemToEdit.buying_price=0,this.itemToEdit.vat=this.vat_records.find(e=>0==e.vat_percent),this.updatePriceWithVAT(),this.displayBuyingPriceDialog=!0):this.toastr.error("Add the item selling units first.")}closeBpDialog(){const i=this.allStock.find(({id:o})=>o===this.itemToEdit.id),e=this.allStock.indexOf(i);this.allStock[e]=this.itemToEditDefault,this.displayBuyingPriceDialog=!1}updateEditItemVat(i){this.itemToEdit.vat_id=i.value.id,this.itemToEdit.vat=i.value,this.updatePriceWithVAT()}updatePriceWithVAT(){this.totalBuyingPrice=this.itemToEdit.buying_price*(this.itemToEdit.vat.vat_percent/100+1),this.totalBuyingPrice=parseFloat(this.totalBuyingPrice.toFixed(2)),this.itemToEdit.buying_price_vat_per_piece=parseFloat((this.totalBuyingPrice/this.itemToEdit.unit.unit_quantity).toFixed(2))}updatePriceWithVAT2(){this.itemToEdit.buying_price=parseFloat((this.totalBuyingPrice/(this.itemToEdit.vat.vat_percent/100+1)).toFixed(2)),this.itemToEdit.buying_price_vat_per_piece=parseFloat((this.totalBuyingPrice/this.itemToEdit.unit.unit_quantity).toFixed(2))}updateEditItemBpUnit(i){this.itemToEdit.unit=i.value,this.itemToEdit.vat=this.itemToEditDefault.vat,this.itemToEdit.buying_price=0,this.itemToEdit.vat=this.vat_records.find(e=>0==e.vat_percent),this.totalBuyingPrice=0}updateItemBp(){this.spinner.show("bp");const i={action:this.cryptoSrv.encodeEncryptText("update_item_bp"),item_id:this.itemToEdit.id,item_name:this.cryptoSrv.encodeEncryptText(this.itemToEdit.name),bp:this.cryptoSrv.encodeEncryptText(this.itemToEdit.buying_price_vat_per_piece.toString()),vat:this.itemToEdit.vat.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(i).then(e=>{"error"!=e.status?"error2"!=e.status?(this.itemToEdit.buying_price=this.itemToEdit.buying_price_vat_per_piece,this.itemToEditDefault.buying_price=this.itemToEdit.buying_price,this.spinner.hide("bp"),this.toastr.success("Update successful!"),this.activeIndex=1):(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout(),this.spinner.hide("bp")):(this.toastr.error(e.message),this.spinner.hide("bp"))}).catch(e=>{this.toastr.error(e),this.spinner.hide("bp")})}updateItemAlertLevel(){this.spinner.show("edit");const i={action:this.cryptoSrv.encodeEncryptText("update_item_stock_alert_level"),item_id:this.itemToEdit.id,unit_id:this.itemToEdit.alert_unit.id,min_quantity:this.cryptoSrv.encodeEncryptText(this.itemToEdit.alert_quantity.toString()),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(i).then(e=>{"error"!=e.status?"error2"!=e.status?(this.spinner.hide("edit"),this.toastr.success("Update successful!")):(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout(),this.spinner.hide("edit")):(this.toastr.error(e.message),this.spinner.hide("edit"))}).catch(e=>{this.toastr.error(e),this.spinner.hide("edit")})}showNewDialog(){this.showNotification=!1,this.displayNewItemDialog=!0,this.newItemModel={},this.newItemModel.vat=this.vat_records.find(i=>0==i.vat_percent),this.newItemModel.vat_id=this.newItemModel.vat.id}showEditDialog(i){if(i.selling_units){if(this.showNotification=!1,this.itemToEdit=i,this.itemToEdit.location_qty=0,this.itemToEdit.locations_qty.forEach(e=>{this.itemToEdit.location_qty+=parseInt(e.location_quantity)}),this.itemToEdit.category_id=i.category.id,this.itemToEdit.vat_id=i.vat.id,this.itemToEdit.selling_units.length>0){const e=this.itemToEdit.selling_units.reduce((o,a)=>a.unit_quantity>o.unit_quantity?a:o);this.itemToEdit.unit=e}this.itemToEditDefault=this.apiSrv.deepCopy(i),this.itemToEditDefault.category_id=this.itemToEditDefault.category.id,this.itemToEditDefault.vat_id=this.itemToEditDefault.vat.id,this.totalBuyingPrice=this.itemToEdit.vat.vat_percent>0&&this.itemToEdit.selling_units.length>0?this.itemToEdit.buying_price*this.itemToEdit.unit.unit_quantity:0,this.userIsAdmin||(this.activeIndex=2),this.showStepDialog=!0}else{this.loading2=!0;let e=this.allStock.find(a=>a.id===i.id);this.itemToViewLocations=e;const o={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:i.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(o).then(a=>{if("error"!=a.status)if("error2"!=a.status){e.selling_units=a.selling_units,e.locations_qty=a.locations_qty,e.total_qty=a.total_qty,e.locations=a.locations;let l=a.alert_unit;if(a.alert_unit&&(e.alert_unit=e.selling_units.find(p=>p.id===l.id),e.alert_quantity=a.alert_quantity),this.showNotification=!1,this.itemToEdit=e,this.itemToEdit.location_qty=0,this.itemToEdit.locations_qty.forEach(p=>{this.itemToEdit.location_qty+=parseInt(p.location_quantity)}),this.itemToEdit.category_id=i.category.id,this.itemToEdit.vat_id=i.vat.id,this.itemToEdit.selling_units.length>0){const p=this.itemToEdit.selling_units.reduce((h,r)=>r.unit_quantity>h.unit_quantity?r:h);this.itemToEdit.unit=p}this.itemToEditDefault=this.apiSrv.deepCopy(i),this.itemToEditDefault.category_id=this.itemToEditDefault.category.id,this.itemToEditDefault.vat_id=this.itemToEditDefault.vat.id,this.totalBuyingPrice=this.itemToEdit.vat.vat_percent>0&&this.itemToEdit.selling_units.length>0?this.itemToEdit.buying_price*this.itemToEdit.unit.unit_quantity:0,this.userIsAdmin||(this.activeIndex=2),this.showStepDialog=!0,this.loading2=!1}else this.loading2=!1,this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.loading2=!1,this.toastr.error(a.message)}).catch(a=>{this.toastr.error(a),this.loading2=!1})}}check(i){this.itemToEdit.buying_price=2!=i?this.itemToEditDefault.buying_price:0}showImageDialog(i){}showItemUnits(i){i.selling_units=i.selling_units.sort((e,o)=>o.unit_quantity-e.unit_quantity),this.itemUnits=i,this.showItemUnitsDialog=!0}confirmDeleteDialog(i){this.confirmationService.confirm({message:"Are you sure you want to delete this item?",acceptButtonStyleClass:"btn btn-primary",rejectButtonStyleClass:"btn btn-danger",accept:()=>{this.spinner.show();const e={action:this.cryptoSrv.encodeEncryptText("delete_stock_item"),name:this.cryptoSrv.encodeEncryptText(i.name),item_id:i.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.allStock=this.allStock.filter(a=>a.id!=i.id),this.toastr.success("Item deleted"),this.spinner.hide()):(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout(),this.spinner.hide("new")):(this.toastr.error(o.message),this.spinner.hide("new"))}).catch(o=>{this.toastr.error(o),this.spinner.hide("new")})},reject:()=>{}})}addNewItem(){this.spinner.show("new");const i={action:this.cryptoSrv.encodeEncryptText("add_stock_item"),name:this.cryptoSrv.encodeEncryptText(this.newItemModel.name),category_id:this.newItemModel.category_id,vat_id:this.newItemModel.vat.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(i).then(e=>{if("error"!=e.status)if("error2"!=e.status){const o=new Date,a=this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("uid")),l={id:e.id,name:this.newItemModel.name,category_id:this.newItemModel.category.id,category:this.newItemModel.category,buying_price:this.totalBuyingPriceNew,max_unit_qty:1,vat:this.newItemModel.vat,image:"",last_edited:o.toLocaleString(),edited_by:a,locations_count:0,units:0,min_qty_ok:!1,prices_ok:!1,locations_qty:[],locations:[],total_qty:0,selling_units:[]};this.allStock.push(l),this.spinner.hide("new"),this.showNotification=!0,setTimeout(()=>{this.displayNewItemDialog=!1,this.ngOnInit()},1300)}else this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout(),this.spinner.hide("new");else this.toastr.error(e.message),this.spinner.hide("new")}).catch(e=>{this.toastr.error(e),this.spinner.hide("new")})}updateItem(){this.spinner.show("edit"),this.itemToEdit.buying_price=this.totalBuyingPrice;const i={action:this.cryptoSrv.encodeEncryptText("update_stock_item"),id:this.itemToEdit.id,name:this.cryptoSrv.encodeEncryptText(this.itemToEdit.name),name1:this.cryptoSrv.encodeEncryptText(this.itemToEditDefault.name),category_id:this.itemToEdit.category_id,category_id1:this.itemToEditDefault.category_id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(i).then(e=>{"error"!=e.status?"error2"!=e.status?(this.spinner.hide("edit"),this.toastr.success("Update successful!")):(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout(),this.spinner.hide("edit")):(this.toastr.error(e.message),this.spinner.hide("edit"))}).catch(e=>{this.toastr.error(e),this.spinner.hide("edit")})}updateNewItemCategory(i){this.newItemModel.category_id=i.value.id,this.newItemModel.category=i.value}updateEditItemCategory(i){this.itemToEdit.category_id=i.value.id,this.itemToEdit.category=i.value}hideNewItemDialog(){this.uploadedFiles1=[],this.displayNewItemDialog=!1}hideEditItemDialog(){const i=this.allStock.find(({id:o})=>o===this.itemToEdit.id),e=this.allStock.indexOf(i);this.allStock[e]=this.itemToEditDefault,this.displayEditDialog=!1}getStockValue(){this.spinner.show();const i={action:this.cryptoSrv.encodeEncryptText("get-stock-value")};this.apiSrv.read(i).then(e=>{"error"!=e.status?"error2"!=e.status?(this.totalStockValue=e.total,this.locationsValue=e.locationsValue,this.categoriesValues=e.categoriesValue,this.loading=!1,this.spinner.hide(),this.showValueDialog=!0):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(e.message))}).catch(e=>{this.toastr.error(e),this.spinner.hide()})}showStockItemsToAddDialog(){this.spinner.show();const i={action:this.cryptoSrv.encodeEncryptText("get-min-items"),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(i).then(e=>{"error"!=e.status?"error2"!=e.status?(this.minItemsTotal=0,this.minItems=e.data.stock,this.categories=e.data.categories,this.vat_records=e.data.vat_records,this.locations=e.data.locations,this.minItems.forEach(o=>{o.attention=0,parseInt(o.prices_ok.toString())>0?(o.prices_ok=!1,o.sp_units_ok=!1,o.attention=1):(o.prices_ok=!0,o.sp_units_ok=!0),parseInt(o.min_qty_ok.toString())<1||parseInt(o.min_qty_ok.toString())>1?(o.min_qty_ok=!1,o.min_unit_ok=!1,o.attention=1):(o.min_qty_ok=!0,o.min_unit_ok=!0),o.locations_count=parseInt(o.locations_count.toString()),o.category=this.categories.find(a=>a.id===o.category_id),o.vat=this.vat_records.find(a=>a.id===o.vat_id)}),this.minItems=this.minItems.sort((o,a)=>a.attention-o.attention),this.loading=!1,this.spinner.hide(),this.displayItemsToAddDialog=!0):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(e.message))}).catch(e=>{this.toastr.error(e),this.spinner.hide()})}showMinimumQuantityDialog(){this.minQtyToEdit=this.minItemsQuantity,this.minQtyToEditDefault=this.apiSrv.deepCopy(this.minItemsQuantity),this.displayMinimumQuantityDialog=!0}updateMinQtyToView(){this.spinner.show("qty");const i={action:this.cryptoSrv.encodeEncryptText("update_min_quantity"),min_qty:this.cryptoSrv.encodeEncryptText(this.minQtyToEdit.toString()),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(i).then(e=>{"error"!==e.status?"error2"!==e.status?(this.minItemsQuantity=this.minQtyToEdit,this.minItemsTotal=0,this.minItems=e.data,this.minItems.forEach(o=>{this.minItemsTotal++,o.attention=0,o.sp_units_ok=!0,o.selling_units.forEach(l=>{if(l.recom_selling_price<o.buying_price*l.unit_quantity||l.min_selling_price<o.buying_price*l.unit_quantity)return o.sp_units_ok=!1,void(o.attention=1)}),null!=o.selling_units.find(l=>1==l.unit_quantity)?o.min_unit_ok=!0:(o.attention=1,o.min_unit_ok=!1)}),this.minItems=this.minItems.sort((o,a)=>o.attention+a.attention),this.loading=!1,this.spinner.hide("qty"),this.displayMinimumQuantityDialog=!1,this.toastr.success("Quantity changed")):(this.spinner.hide("qty"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):this.toastr.error(e.message)},e=>{this.spinner.hide("edit"),this.displayEditDialog=!1,this.toastr.error("Could not update quantity")})}showStockTakingFormDialog(i){if(this.locationToPrint=null,this.printData.length=0,this.printData=[],this.stockLocations.length=0,this.stockLocations=[],this.printType=i,this.stockLocations=this.apiSrv.deepCopy(this.locations),null==this.stockLocations.find(o=>"All"===o.name)){const o={id:"all",name:"All",color:"12",date_created:new Date};this.stockLocations.push(o)}this.printOrder="",this.showStockTakingForm=!0}updateLocationSelected(i){this.locationToPrint=i.value}getPrintData(){this.spinner.show("print");const i={action:this.cryptoSrv.encodeEncryptText("get-all-stock"),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(i).then(e=>{if("error"!=e.status)if("error2"!=e.status){const a=e.data.stock;if(this.categories=e.data.categories,this.vat_records=e.data.vat_records,this.locations=e.data.locations,this.minItemsTotal=e.data.min_items,"thermal"===this.printType){const l={action:this.cryptoSrv.encodeEncryptText("get-shop-info"),uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(l).then(p=>{if("error"!=p.status)if("error2"!=p.status){this.shopDetail=p.Shop,this.totalStockValue=p.Value;a.sort((r,c)=>r.name.localeCompare(c.name)).forEach(r=>{const c=r.selling_units;var _=[];r.locations_qty.forEach(u=>{const f=this.getLocationUnitQuantity(u.location_quantity,c);r.selling_units.forEach(d=>{let y={location:u.location.name,unit:d.unit_name,pieces:d.unit_quantity,qty:f[d.unit_name],bp:r.buying_price*d.unit_quantity,total_bp:r.buying_price*d.unit_quantity*f[d.unit_name]};"All"!=this.locationToPrint.name?this.locationToPrint.name===u.location.name&&_.push(y):_.push(y)})});const m={item:(0,x._)(r.name),units:_};this.printData.push(m)}),this.printTest(),this.spinner.hide("print"),this.showStockTakingForm=!1}else this.spinner.hide("print"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.spinner.hide("print"),this.toastr.error(p.message)}).catch(p=>{this.toastr.error(p),this.spinner.hide("print")})}else if("pdf"===this.printType)if("alphabet"===this.printOrder)(o=(o=a).sort((l,p)=>l.name.localeCompare(p.name))).forEach(l=>{const p=l.selling_units;var h=[];l.locations_qty.forEach(c=>{const _=c.location_quantity,m=this.getLocationUnitQuantity(_,p);l.selling_units.forEach(u=>{h.push({location:c.location.name,unit:u.unit_name,pieces:u.unit_quantity,qty:m[u.unit_name],bp:l.buying_price*u.unit_quantity,total_bp:l.buying_price*_})})});const r={item:(0,x._)(l.name),units:h};this.printData.push(r)}),this.spinner.hide("print"),this.showStockTakingForm=!1,this.convertExcelToPdf(this.printData,"Stock taking items for "+this.locationToPrint.name);else{const l={};(o=(o=a).sort((r,c)=>r.category.name.localeCompare(c.category.name))).forEach(r=>{const c=r.category.name;l[c]||(l[c]=[]);const _=r.selling_units;var m=[];r.locations_qty.forEach(g=>{const f=g.location_quantity,d=this.getLocationUnitQuantity(f,_);r.selling_units.forEach(y=>{m.push({location:g.location.name,unit:y.unit_name,pieces:y.unit_quantity,qty:d[y.unit_name],bp:r.buying_price*y.unit_quantity,total_bp:r.buying_price*f})})});const u={item:(0,x._)(r.name),units:m};l[c].push(u),l[c]=l[c].sort((g,f)=>g.item.localeCompare(f.item))});const h=Object.keys(l).map(r=>({category:r,items:l[r]}));this.convertExcelToPdf(h,"Stock taking items for "+this.locationToPrint.name),this.spinner.hide("print"),this.showStockTakingForm=!1}else if("alphabet"===this.printOrder)(o=(o=a).sort((p,h)=>p.name.localeCompare(h.name))).forEach(p=>{const h=p.selling_units;var r=[];p.locations_qty.forEach(_=>{const m=_.location_quantity,u=this.getLocationUnitQuantity(m,h);p.selling_units.forEach(g=>{r.push({location:_.location.name,unit:g.unit_name,pieces:g.unit_quantity,qty:u[g.unit_name],bp:p.buying_price*g.unit_quantity,total_bp:p.buying_price*m})})});const c={item:(0,x._)(p.name),units:r};this.printData.push(c)}),this.spinner.hide("print"),this.showStockTakingForm=!1,this.convertExcelToPdf(this.printData,"Stock taking items for "+this.locationToPrint.name);else{const l={};var o;let h=[];o=(o=a).sort((_,m)=>{const u=_.category.name.localeCompare(m.category.name);return 0===u?_.name.localeCompare(m.name):u}),h.push({item:"",category:"",location:"",unit:"",quantity:"",buying_price:"",total_bp:""}),o.forEach(_=>{const m=_.category.name;l[m]||(h.push({}),l[m]=[]);const u=_.selling_units;var g=[];_.locations_qty.forEach(d=>{const y=d.location_quantity,v=this.getLocationUnitQuantity(y,u);_.selling_units.forEach(k=>{g.push({location:d.location.name,unit:k.unit_name,pieces:k.unit_quantity,qty:v[k.unit_name],bp:_.buying_price*k.unit_quantity,total_bp:_.buying_price*y}),h.push({item:_.name,category:_.category.name,location:d.location.name,unit:k.unit_name,quantity:v[k.unit_name],buying_price:_.buying_price*k.unit_quantity,total_bp:_.buying_price*k.unit_quantity*v[k.unit_name]})})});const f={item:(0,x._)(_.name),units:g};l[m].push(f),l[m]=l[m].sort((d,y)=>d.item.localeCompare(y.item))}),Object.keys(l).map(_=>({category:_,items:l[_]})),this.downloadExcelFile(h,"Stock taking items for "+this.locationToPrint.name),this.spinner.hide("print"),this.showStockTakingForm=!1}this.loading=!1}else this.spinner.hide("print"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.spinner.hide("print"),this.toastr.error(e.message)}).catch(e=>{this.toastr.error(e),this.spinner.hide("print")})}downloadExcelFile(i,e){var o=this;return(0,A.Z)(function*(){const a=new L.Workbook,l=a.addWorksheet("Sheet1"),h=Object.keys(i[0]).map(c=>(0,x._)(c.split("_").join(" ")));l.addRow(h).eachCell(c=>{c.font={bold:!0}}),i.forEach(c=>{l.addRow(Object.values(c))}),yield l.protect("1234",{}),a.xlsx.writeBuffer().then(c=>{const _=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,O.saveAs)(_,e+".xlsx")}),o.spinner.hide("code")})()}convertExcelToPdf(i,e){if("category"===this.printOrder){const o=this.generateCategoryPdfContent(i);this.generatePDF(o,e)}else{const o=this.generatePdfContent(i);this.generatePDF(o,e)}this.spinner.hide()}generatePdfContent(i){const e=new Q.default("landscape");let o=new Date;e.setFontSize(12),e.text("Stock list generated on: "+this.datepipe.transform(o),15,10),Object.keys(i[0]);var l;l="All"!=this.locationToPrint.name?["#","Item","System quantity","Total price","Confirmed quantity"]:["#","Item","Location","System quantity","Total price","Confirmed quantity"];var p=[];if("All"!=this.locationToPrint.name){let c=0,_=1;i.forEach(u=>{var g={no:_,item:(0,x._)(u.item)};let f="";u.units.forEach(d=>{d.location===this.locationToPrint.name&&(f+=d.unit+" - "+this._decimalPipe.transform(d.qty)+", ",g.system_qty=f,g.total_bp=this._decimalPipe.transform(d.total_bp,"1.2-2"),g.confirmed_qty="")}),u.units.length>0&&u.units[0].location===this.locationToPrint.name&&(c+=u.units[0].total_bp),_++,p.push(g)}),p.push({});let m={no:"",item:"Total stock value",system_qty:"",total_bp:this._decimalPipe.transform(c,"1.2-2"),confirmed_qty:""};p.push(m)}else{let c=0,_=1;i.forEach(u=>{var g={no:_,item:u.item};let f="";u.units.forEach(d=>{g.location=d.location,f+=d.unit+" - "+this._decimalPipe.transform(d.qty)+", ",g.system_qty=f,g.total_bp=this._decimalPipe.transform(d.total_bp,"1.2-2"),g.confirmed_qty=""}),p.push(g),_++,u.units.length>0&&(c+=u.units[0].total_bp)}),p.push({});let m={no:"",item:"Total stock value",location:"",system_qty:"",total_bp:this._decimalPipe.transform(c,"1.2-2"),confirmed_qty:""};p.push(m)}const h=p.map(c=>Object.values(c));return B()(e,{didDrawPage:c=>{e.setFontSize(10),e.text("Page - "+c.pageNumber,270,203),e.setFontSize(12)},head:[l],body:h,startY:20,theme:"grid"}),e}generateCategoryPdfContent(i){const e=new Q.default("landscape");let o=new Date;e.setFontSize(12),e.text("Stock list generated on: "+this.datepipe.transform(o),15,10);var a;a="All"!=this.locationToPrint.name?["#","Item","Category","System quantity","Total price","Confirmed quantity"]:["#","Item","Category","Location","System quantity","Total price","Confirmed quantity"];var l=[];if("All"!=this.locationToPrint.name){let r=0,c=1;i.forEach(m=>{let u=0;m.items.forEach(f=>{var d={no:c,item:(0,x._)(f.item),category:(0,x._)(m.category)};let y="";f.units.forEach(v=>{v.location===this.locationToPrint.name&&(y+=v.unit+" - "+this._decimalPipe.transform(v.qty)+", ",d.system_qty=y,d.total_bp=this._decimalPipe.transform(v.total_bp,"1.2-2"),d.confirmed_qty="")}),f.units.length>0&&f.units[0].location===this.locationToPrint.name&&(r+=f.units[0].total_bp,u+=f.units[0].total_bp),c++,l.push(d)});let g={no:"",item:"",category:"Total category value",system_qty:"",total_bp:this._decimalPipe.transform(u,"1.2-2"),confirmed_qty:""};l.push(g),l.push({})});let _={no:"",item:"Total stock value",category:"",system_qty:"",total_bp:this._decimalPipe.transform(r,"1.2-2"),confirmed_qty:""};l.push(_)}else{let r=0,c=1;i.forEach(m=>{let u=0;m.items.forEach(f=>{var d={no:c,item:(0,x._)(f.item),category:(0,x._)(m.category)};let y="";f.units.forEach(v=>{d.location=v.location,y+=v.unit+" - "+this._decimalPipe.transform(v.qty)+", ",d.system_qty=y,d.total_bp=this._decimalPipe.transform(v.total_bp,"1.2-2"),d.confirmed_qty=""}),l.push(d),c++,f.units.length>0&&(r+=f.units[0].total_bp,u+=f.units[0].total_bp)});let g={no:"",item:"",category:"Total category value",system_qty:"",total_bp:this._decimalPipe.transform(u,"1.2-2"),confirmed_qty:""};l.push(g),l.push({})});let _={no:"",item:"Total stock value",category:"",location:"",system_qty:"",total_bp:this._decimalPipe.transform(r,"1.2-2"),confirmed_qty:""};l.push(_)}const p=l.map(r=>Object.values(r));return B()(e,{didDrawPage:r=>{e.setFontSize(10),e.text("Page - "+r.pageNumber,270,203),e.setFontSize(12)},head:[a],body:p,startY:20,theme:"grid"}),e}generatePDF(i,e){i.save(e+".pdf")}createPrintData(){this.shopDetail.name=this.cryptoSrv.decryptEncodedText(this.shopDetail.name),this.shopDetail.tcode=this.cryptoSrv.decryptEncodedText(this.shopDetail.tcode),this.shopDetail.username=this.cryptoSrv.decryptEncodedText(this.shopDetail.username),this.shopDetail.location=this.cryptoSrv.decryptEncodedText(this.shopDetail.location),this.shopDetail.description=this.cryptoSrv.decryptEncodedText(this.shopDetail.description),this.shopDetail.contacts.forEach(C=>{C=this.cryptoSrv.decryptEncodedText(C)}),this.shopDetail.receipt_options.till=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.till),this.shopDetail.receipt_options.paybill=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.paybill),this.shopDetail.receipt_options.paybill_account=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.paybill_account),this.shopDetail.receipt_options.mpesa_business_name=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.mpesa_business_name),this.shopDetail.receipt_options.footer_message=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.footer_message);var i="";i+="\x1b!\0";let o=0,a=0,l=0;this.printData.forEach(C=>{C.units.forEach(b=>{const q=b.unit.length+b.pieces.toString().length;o=Math.max(o,q);const E=b.qty.toString().length;a=Math.max(a,E);const N=b.bp.toString().length+3;l=Math.max(l,N)})});const h="UNIT",c="@PRICE",u=a-"QTY".length+6,g=l-c.length+3,f=h+" ".repeat(o-h.length+5)+"QTY"+" ".repeat(u)+c+" ".repeat(g)+"TOTAL";i+="\x1bE\r",i+="-----------------------------------------------\n",i+=f+"\n",i+="-----------------------------------------------\n\n",i+="\x1bE\n",this.printData.forEach(C=>{i+="\x1bE\r",i+=(0,x._)(C.item)+"\n",i+="\x1bE\n",C.units.forEach(b=>{const q=(0,x._)(b.unit)+"("+(0,Z.uf)(b.pieces,this.locale,".0")+")",E=(0,Z.uf)(b.qty,this.locale,".0"),N=(0,Z.uf)(b.bp,this.locale,".2"),Zi=(0,Z.uf)(b.total_bp,this.locale,".2"),Si=a-E.length+6,wi=l-N.length+3;i+=q+" ".repeat(o-q.length+5)+E+" ".repeat(Si)+N+" ".repeat(wi)+Zi+"\n"}),i+="\n",i+="\x1ba0"}),new Date;var v=new Z.uU("en-US");const k=Date.now(),M=v.transform(k,"medium"),U=this.shopDetail.name.toUpperCase();var I=function(C){return String.fromCharCode(C)},V="\x1dh"+I(70)+"\x1df"+I(0)+"\x1dk"+I(69)+I(this.shopDetail.tcode.length)+this.shopDetail.tcode+I(0);if(""!==this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.image_url)){const C=(0,Z.uf)(parseFloat(this.totalStockValue),this.locale,".2");let b="";return this.shopDetail.contacts.forEach(E=>{b+=this.cryptoSrv.decryptEncodedText(E)+", "}),["\x1b@","\x1ba1","\x1d!\x10","\x1bE\r","\x1d!\x10",U+"\n","\n",{type:"raw",format:"image",flavor:"file",data:this.shopLogoUrl+this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.image_url),options:{language:"ESCPOS",dotDensity:"single"}},"\x1bE\n","\x1d!\0","\x1d!\0","\n",this.shopDetail.description+"\n",this.shopDetail.location+"\n","FOR ENQUIRIES CALL: "+b+"\n","\n","\x1ba0","\x1bE\r","\n","STOCK TAKING ;\n","\x1bE\n","\n",i+"\n","-----------------------------------------------\n","\x1bE\r","\x1d!\x10","TOTAL     "+C,"\n","\x1bE\n","\x1d!\0","-----------------------------------------------\n\n","\x1ba1",V,"","DATE # "+M+"\n\n","Printed by "+(0,x._)(this.shopDetail.username),"\n","\n\n\n\n\n\n\n","\x1dV\0"]}{const C=(0,Z.uf)(parseFloat(this.totalStockValue),this.locale,".2");let b="";return this.shopDetail.contacts.forEach(E=>{b+=this.cryptoSrv.decryptEncodedText(E)+", "}),["\x1b@","\x1ba1","\x1d!\x10","\x1bE\r",U+"\n","\x1bE\n","\x1d!\0","\x1d!\0","\n",this.shopDetail.description+"\n",this.shopDetail.location+"\n","FOR ENQUIRIES CALL: "+b+"\n","\n","\x1ba0","\x1bE\r","STOCK TAKING ;\n","\x1bE\n","\n",i+"\n","-----------------------------------------------\n","\x1bE\r","\x1d!\x10","TOTAL     "+C,"\n","\x1bE\n","\x1d!\0","-----------------------------------------------\n","\x1ba1",V,"","DATE: "+M+"\n\n","Printed by "+(0,x._)(this.shopDetail.username),"\n","\n\n\n\n\n\n\n","\x1dV\0"]}}printTest(){this.printSrv.printtest2(this.createPrintData()),this.spinner.hide()}getImage(i){this.getBase64ImageFromURL(i).subscribe(e=>{this.base64TrimmedURL=e,this.printSrv.printtest2(this.createPrintData())})}getBase64ImageFromURL(i){return $.y.create(e=>{let o=new Image;o.crossOrigin="Anonymous",o.src=i,o.complete?(e.next(this.getBase64Image(o)),e.complete()):(o.onload=()=>{e.next(this.getBase64Image(o)),e.complete()},o.onerror=a=>{e.error(a)})})}getBase64Image(i){var e=document.createElement("canvas");e.width=i.width,e.height=i.height,e.getContext("2d").drawImage(i,-5,0);let a=e.toDataURL("image/png");return this.base64DefaultURL=a,a.replace(/^data:image\/(png|jpg);base64,/,"")}}return n.\u0275fac=function(i){return new(i||n)(t.Y36(W.t2),t.Y36(z.$),t.Y36(X._W),t.Y36(tt.e),t.Y36(it.s),t.Y36(et.$),t.Y36(ot.YP),t.Y36(Z.JJ),t.Y36(Z.uU),t.Y36(t.sBO),t.Y36(t.soG))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-all-stock"]],viewQuery:function(i,e){if(1&i&&(t.Gf(nt,5),t.Gf(at,5),t.Gf(st,5)),2&i){let o;t.iGM(o=t.CRH())&&(e.table=o.first),t.iGM(o=t.CRH())&&(e.table2=o.first),t.iGM(o=t.CRH())&&(e.overlay=o.first)}},decls:64,vars:105,consts:[["class","card",4,"ngIf"],["appendTo","body","modal","true","transitionOptions","390ms cubic-bezier(0, 0, 0.2, 1)",3,"blockScroll","header","closable","visible","baseZIndex","visibleChange"],["autocomplete","off",3,"ngSubmit",4,"ngIf"],[3,"message","showNotification",4,"ngIf"],["bdOpacity","#fff","name","new","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[2,"color","#02926e"],["bdOpacity","#fff","name","edit","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["appendTo","body","modal","true",3,"blockScroll","header","closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],["appendTo","body","modal","true","header","Manage VAT",3,"blockScroll","closable","visible","baseZIndex","visibleChange"],[3,"vat_records"],["type","button","pButton","","icon","pi pi-times","label","Close",1,"p-button-danger","p-button-sm","float-right",3,"click"],["appendTo","body","blockScroll","true","modal","true","header","Stock categories",3,"closable","visible","baseZIndex","visibleChange"],[3,"categories"],["appendTo","body","modal","true","header","",3,"blockScroll","closable","visible","baseZIndex","visibleChange"],[1,"row",2,"align-items","center"],[1,"col-6"],[4,"ngIf"],["styleClass","p-datatable-customers","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","filterDelay","globalFilterFields"],["dt09",""],["pTemplate","header"],["pTemplate","body"],["appendTo","body","modal","true","header","",3,"closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],["appendTo","body","modal","true","header","Items with low quantity",3,"closable","visible","baseZIndex","blockScroll","visibleChange","onHide"],[1,"row","p-0","m-0"],[1,"col-12"],["appendTo","body","modal","true","header","Change stock alert quantity",3,"closable","visible","baseZIndex","visibleChange"],["autocomplete","off",3,"ngSubmit"],["form2","ngForm"],[1,"row","mb-2"],[1,"col-md-12"],[1,"ui-fluid","px-2"],[1,"p-field"],["for","firstname3"],["id","firstname3","name","quantity","required","","type","number","pInputNumber","","pattern","[0-9]+","min","0",1,"form-control",3,"ngModel","ngModelChange"],["type","button","pButton","","icon","pi pi-times","label","Cancel",1,"p-button-danger","p-button-sm","mt-3","float-right",3,"click"],["type","submit","pButton","","icon","pi pi-check","label","Save",1,"p-button-success","p-button-sm","mr-3","mt-3","float-right",3,"disabled"],["bdOpacity","#fff","name","qty","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["appendTo","body","modal","true",3,"header","closable","visible","baseZIndex","visibleChange","onHide"],["class","row",4,"ngIf"],["bdOpacity","#fff","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[3,"showCloseIcon"],["op",""],["pTemplate",""],["header","Confirm","icon","pi pi-exclamation-triangle","appendTo","body",3,"baseZIndex"],[1,"card"],[1,"card-header"],[1,"card-title","mb-4"],["label","Choose an action to perform","styleClass","p-button-help float-right",3,"model","onClick",4,"ngIf"],["ngbDropdown","","class","d-inline-block float-right mr-5","container","body","placement","bottom-start",4,"ngIf"],["label","Items to add","badgeClass","p-badge-danger",3,"icon","styleClass","badge","click"],[1,"card-body","p-0","m-0"],["dt",""],["label","Choose an action to perform","styleClass","p-button-help float-right",3,"model","onClick"],["sa",""],["ngbDropdown","","container","body","placement","bottom-start",1,"d-inline-block","float-right","mr-5"],["type","button","pButton","","id","dropdownBasic1","ngbDropdownToggle","","icon","pi pi-print","label","Print stock taking items",1,"p-button-secondary","p-button-outlined"],["ngbDropdownMenu","","aria-labelledby","dropdownBasic1",1,"dropdown-menu",2,"right","auto !important","left","0 !important"],["ngbDropdownItem","",1,"p-button-success",3,"click"],[1,"pi","pi-print","mr-2"],["ngbDropdownItem","",3,"click"],[1,"pi","pi-file-pdf","mr-2"],[1,"pi","pi-file-excel","mr-2"],[1,"ui-selectable-row"],[2,"width","8rem"],["pSortableColumn","name",2,"width","15rem"],["field","name"],["pSortableColumn","category.name",2,"width","15rem"],["field","category.name"],["pSortableColumn","buying_price",2,"width","15rem"],["field","buying_price"],["pSortableColumn","vat",2,"width","15rem"],["field","vat"],[2,"width","10rem"],[2,"width","20rem"],["pInputText","","type","text","placeholder","Search item name",1,"ui-column-filter",3,"input"],["appendTo","body","placeholder","All","styleClass","ui-column-filter","optionLabel","name",3,"options","onChange"],["pTemplate","item"],["appendTo","body","placeholder","All","styleClass","ui-column-filter","optionLabel","vat_percent",3,"options","onChange"],[1,"ui-multiselect-representative-option",2,"display","grid"],[2,"word-wrap","normal"],[2,"height","4rem","padding","5px"],["alt","img","style","height: 100%; width: 4rem;",3,"src",4,"ngIf"],[3,"click",4,"ngIf"],["class","animate-flicker warning",4,"ngIf"],["class","animate-flicker danger",4,"ngIf"],["ngbDropdown","","container","body","placement","bottom-start",1,"d-inline-block"],["type","button","pButton","","id","dropdownBasic1","ngbDropdownToggle","",1,"p-button-primary","p-button-outlined",3,"loading"],[1,"pi","pi-pencil","mr-2"],["ngbDropdownItem","",3,"click",4,"ngIf"],["alt","img",2,"height","100%","width","4rem",3,"src"],[3,"click"],["label","","shape","circle",3,"style",4,"ngFor","ngForOf"],["label","","shape","circle"],[1,"animate-flicker","warning"],[1,"animate-flicker","danger"],[1,"pi","pi-trash","mr-2"],[1,"row"],[1,"ui-fluid"],[1,"p-field","pb-3"],["id","firstname3","name","name","required","","type","text","pInputText","",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a Category","name","category","appendTo","body","optionLabel","name","filter","true",3,"options","ngModel","onChange","ngModelChange"],["pTemplate","selectedItem"],["type","submit","pButton","","icon","pi pi-check","label","Save",1,"p-button-success","p-button-sm","float-right",3,"disabled"],["type","button","pButton","","icon","pi pi-times","label","Cancel",1,"ui-button-danger","p-button-danger","mr-3","p-button-sm","float-right",3,"click"],[1,"ui-helper-clearfix"],[3,"message","showNotification"],["form3","ngForm"],["type","submit","pButton","","icon","pi pi-check","label","Update",1,"p-button-success","p-button-sm","float-right",3,"disabled"],["appendTo","body","modal","true",3,"blockScroll","header","closable","visible","baseZIndex","visibleChange"],["bdOpacity","#fff","name","bp","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["placeholder","Select a unit","name","unit","appendTo","body","optionLabel","unit_name","filter","true",3,"options","ngModel","onChange","ngModelChange"],["id","firstname3","name","buying_price","required","","type","number","pInputNumber","",1,"form-control",3,"ngModel","input","ngModelChange"],["placeholder","Select vat %","name","vat","appendTo","body","optionLabel","vat_percent","filter","true",3,"options","ngModel","onChange","ngModelChange"],["id","firstname3","name","buying_price_vat","required","","type","number","pInputNumber","",1,"form-control",3,"disabled","ngModel","input","ngModelChange"],[3,"units","item_id","buying_price","priceUpdated"],[1,"col-xl-12","col-lg-12","col-12"],[1,"card","card-inverse","bg-primary"],[1,"card-content"],[1,"card-body"],[1,"media"],[1,"media-center","align-self-center"],[1,"media-body","text-center"],[1,"card-text"],[2,"font-size","12px"],["class","col-xl-6 col-lg-6 col-6",4,"ngFor","ngForOf"],[1,"col-xl-6","col-lg-6","col-6"],[1,"card","card-inverse","bg-secondary"],[1,"text-center"],["pSortableColumn","name"],["pInputText","","type","text","placeholder","Search...",1,"ui-column-filter",3,"input"],["appendTo","body","modal","true","header","",3,"closable","visible","baseZIndex","visibleChange"],[1,"p-field","pb-4"],["for","location",1,"pb-1"],["placeholder","Select location","name","location","appendTo","body","optionLabel","name","filter","true",3,"options","ngModel","onChange","ngModelChange"],["class","p-field",4,"ngIf"],[1,"col-md-12","text-center","mt-4"],["type","button","pButton","","icon","pi pi-times","label","Cancel",1,"p-button-danger","p-button-sm",3,"click"],["type","submit","pButton","",1,"p-button-success","p-button-sm","ml-5",3,"disabled","icon","label"],["bdOpacity","#fff","name","print","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["for","style",1,"pb-1"],[1,"field-radiobutton"],["name","city","value","alphabet","inputId","city1",3,"ngModel","ngModelChange","onClick"],["for","city1",1,"info"],["name","city","value","category","inputId","city2",3,"ngModel","ngModelChange","onClick"],["for","city2",1,"primary"],["type","button","pButton","",1,"p-button-primary","p-button-sm","p-button-outlined",3,"loading","click"],[1,"col-md-12","mt-2"],[3,"model","activeIndex","readonly","activeIndexChange"],["class","mt-4",4,"ngIf"],[1,"row","mt-2"],[1,"col-md-5","offset-md-1"],[1,"row","px-2"],["type","submit","pButton","","icon","pi pi-check","label","Update",1,"p-button-success","p-button-sm",3,"disabled"],[1,"mt-4"],[3,"units","item_id","buying_price","totalQty","priceUpdated"],["bdOpacity","#fff","bdColor","rgba(255,255,255,0.76)","size","medium","name","details","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[1,"col-md-6","offset-md-3"],["id","firstname3","name","buying_price","required","","type","number","pInputNumber","",1,"form-control",3,"disabled","ngModel","input","ngModelChange"],["id","firstname3","name","quantity","required","","min","0","type","number","pInputNumber","",1,"form-control",3,"ngModel","ngModelChange"],["selectionMode","single","responsiveLayout","scroll",3,"value","paginator","rows"],[4,"ngFor","ngForOf"],[1,"p-o","m-0"],[1,"small"]],template:function(i,e){if(1&i&&(t.YNc(0,yt,12,18,"div",0),t.TgZ(1,"p-dialog",1),t.NdJ("visibleChange",function(a){return e.displayNewItemDialog=a}),t.YNc(2,At,19,4,"form",2),t.YNc(3,Ct,1,2,"app-notification",3),t.TgZ(4,"ngx-spinner",4),t._UZ(5,"p",5),t.qZA()(),t.TgZ(6,"p-dialog",1),t.NdJ("visibleChange",function(a){return e.displayEditDialog=a}),t.YNc(7,St,19,4,"form",2),t.YNc(8,wt,1,2,"app-notification",3),t.TgZ(9,"ngx-spinner",6),t._UZ(10,"p",5),t.qZA()(),t.YNc(11,Nt,5,11,"p-dialog",7),t.TgZ(12,"p-dialog",8),t.NdJ("visibleChange",function(a){return e.displayVATRecords=a}),t._UZ(13,"app-vat",9),t.TgZ(14,"p-footer")(15,"button",10),t.NdJ("click",function(){return e.displayVATRecords=!1,e.ngOnInit()}),t.qZA()()(),t.TgZ(16,"p-dialog",11),t.NdJ("visibleChange",function(a){return e.displayCategoriesDialog=a}),t._UZ(17,"app-stock-categories",12),t.TgZ(18,"p-footer")(19,"button",10),t.NdJ("click",function(){return e.displayCategoriesDialog=!1,e.ngOnInit()}),t.qZA()()(),t.YNc(20,Pt,5,13,"p-dialog",7),t.TgZ(21,"p-dialog",13),t.NdJ("visibleChange",function(a){return e.showValueDialog=a}),t.TgZ(22,"div",14)(23,"div",15),t.YNc(24,Qt,16,5,"div",16),t.YNc(25,Lt,5,0,"div",16),t.qZA(),t.TgZ(26,"div",15)(27,"p-table",17,18),t.YNc(29,Ot,10,0,"ng-template",19),t.YNc(30,Bt,7,7,"ng-template",20),t.qZA()()(),t.TgZ(31,"p-footer")(32,"button",10),t.NdJ("click",function(){return e.showValueDialog=!1}),t.qZA()()(),t.YNc(33,Ht,21,13,"p-dialog",21),t.TgZ(34,"p-dialog",22),t.NdJ("visibleChange",function(a){return e.displayItemsToAddDialog=a})("onHide",function(){return e.ngOnInit()}),t.TgZ(35,"div",23)(36,"div",24)(37,"p-table",17,18),t.YNc(39,Yt,18,0,"ng-template",19),t.YNc(40,zt,17,11,"ng-template",20),t.qZA()()()(),t.TgZ(41,"p-dialog",25),t.NdJ("visibleChange",function(a){return e.displayMinimumQuantityDialog=a}),t.TgZ(42,"form",26,27),t.NdJ("ngSubmit",function(){return e.updateMinQtyToView()}),t.TgZ(44,"div",28)(45,"div",29)(46,"div",30)(47,"div",31)(48,"label",32),t._uU(49,"Minimum quantity"),t.qZA(),t.TgZ(50,"input",33),t.NdJ("ngModelChange",function(a){return e.minQtyToEdit=a}),t.qZA()()(),t.TgZ(51,"button",34),t.NdJ("click",function(){return e.minItemsQuantity=e.minQtyToEditDefault,e.displayMinimumQuantityDialog=!1}),t.qZA(),t._UZ(52,"button",35),t.qZA()()(),t.TgZ(53,"ngx-spinner",36),t._UZ(54,"p",5),t.qZA()(),t.TgZ(55,"p-dialog",37),t.NdJ("visibleChange",function(a){return e.showStepDialog=a})("onHide",function(){return e.ngOnInit(),e.activeIndex=0}),t.ALo(56,"titlecase"),t.YNc(57,di,7,7,"div",38),t.qZA(),t.TgZ(58,"ngx-spinner",39),t._UZ(59,"p",5),t.qZA(),t.TgZ(60,"p-overlayPanel",40,41),t.YNc(62,Ti,3,3,"ng-template",42),t.qZA(),t._UZ(63,"p-confirmDialog",43)),2&i){const o=t.MAs(43);t.Q6J("ngIf",!e.loading),t.xp6(1),t.Akn(t.DdM(91,D)),t.s9C("header",e.showNotification?"":"New item"),t.Q6J("blockScroll",!0)("closable",!1)("visible",e.displayNewItemDialog)("baseZIndex",1e4),t.xp6(1),t.Q6J("ngIf",!e.showNotification),t.xp6(1),t.Q6J("ngIf",e.showNotification),t.xp6(1),t.Q6J("fullScreen",!1),t.xp6(2),t.Akn(t.DdM(92,D)),t.s9C("header",e.showNotification?"":"Edit item"),t.Q6J("blockScroll",!0)("closable",!1)("visible",e.displayEditDialog)("baseZIndex",1e4),t.xp6(1),t.Q6J("ngIf",!e.showNotification),t.xp6(1),t.Q6J("ngIf",e.showNotification),t.xp6(1),t.Q6J("fullScreen",!1),t.xp6(2),t.Q6J("ngIf",e.displayBuyingPriceDialog),t.xp6(1),t.Akn(t.DdM(93,H)),t.Q6J("blockScroll",!0)("closable",!1)("visible",e.displayVATRecords)("baseZIndex",1e4),t.xp6(1),t.Q6J("vat_records",e.vat_records),t.xp6(3),t.Akn(t.DdM(94,xi)),t.Q6J("closable",!1)("visible",e.displayCategoriesDialog)("baseZIndex",1e4),t.xp6(1),t.Q6J("categories",e.categories),t.xp6(3),t.Q6J("ngIf",e.showItemUnitsDialog),t.xp6(1),t.Akn(t.DdM(95,yi)),t.Q6J("blockScroll",!0)("closable",!1)("visible",e.showValueDialog)("baseZIndex",1e4),t.xp6(3),t.Q6J("ngIf","error"!=e.totalStockValue),t.xp6(1),t.Q6J("ngIf","error"==e.totalStockValue),t.xp6(2),t.Q6J("value",e.categoriesValues)("rowHover",!0)("rows",5)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(96,vi))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(97,J)),t.xp6(6),t.Q6J("ngIf",e.showStockTakingForm),t.xp6(1),t.Akn(t.DdM(98,bi)),t.Q6J("closable",!0)("visible",e.displayItemsToAddDialog)("baseZIndex",1e4)("blockScroll",!0),t.xp6(3),t.Q6J("value",e.minItems)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(99,F))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(100,J)),t.xp6(4),t.Akn(t.DdM(101,D)),t.Q6J("closable",!1)("visible",e.displayMinimumQuantityDialog)("baseZIndex",1e4),t.xp6(9),t.Q6J("ngModel",e.minQtyToEdit),t.xp6(2),t.Q6J("disabled",!o.valid||null===e.minQtyToEdit||e.minQtyToEdit==e.minQtyToEditDefault),t.xp6(1),t.Q6J("fullScreen",!1),t.xp6(2),t.Akn(t.DdM(102,Y)),t.Q6J("header",e.showStepDialog?t.lcZ(56,89,e.itemToEditDefault.name):"")("closable",!0)("visible",e.showStepDialog)("baseZIndex",1e4),t.xp6(2),t.Q6J("ngIf",e.showStepDialog),t.xp6(1),t.Q6J("fullScreen",!0),t.xp6(2),t.Akn(t.DdM(103,Ai)),t.Q6J("showCloseIcon",!1),t.xp6(3),t.Akn(t.DdM(104,D)),t.Q6J("baseZIndex",1e4)}},styles:["label[_ngcontent-%COMP%]{text-transform:none}[_nghost-%COMP%]     p-colorpicker .p-colorpicker .p-colorpicker-preview{border-radius:30px}[_nghost-%COMP%]     p-dialog .p-dialog-header{border-radius:30px!important}[_nghost-%COMP%]     .p-dialog .p-dialog-footer{border-bottom-right-radius:30px}"],data:{animation:[(0,w.X$)("enter",[(0,w.eR)("void => *",[(0,w.oB)({opacity:0}),(0,w.jt)(1e3,(0,w.oB)({opacity:1}))])])]}}),n})()},3942:(R,P,T)=>{T.d(P,{c:()=>t});var A=T(4650);let t=(()=>{class S{constructor(){}ngOnInit(){}}return S.\u0275fac=function(x){return new(x||S)},S.\u0275cmp=A.Xpm({type:S,selectors:[["app-notification"]],inputs:{message:"message",showNotification:"showNotification"},decls:6,vars:1,consts:[[1,"wrapper1"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 52 52",1,"checkmark"],["cx","26","cy","26","r","25","fill","none",1,"checkmark__circle"],["fill","none","d","M14.1 27.2l7.1 7.2 16.7-16.8",1,"checkmark__check"],[2,"position","absolute","margin-top","150px","margin-bottom","50px","font-weight","bold"]],template:function(x,Z){1&x&&(A.TgZ(0,"div",0),A.O4$(),A.TgZ(1,"svg",1),A._UZ(2,"circle",2)(3,"path",3),A.qZA(),A.kcU(),A.TgZ(4,"p",4),A._uU(5),A.qZA()()),2&x&&(A.xp6(5),A.hij(" ",Z.message," "))},styles:["*[_ngcontent-%COMP%]{padding:0;margin:0}.wrapper1[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center;background-color:transparent}.checkmark__circle[_ngcontent-%COMP%]{stroke-dasharray:166;stroke-dashoffset:166;stroke-width:2;stroke-miterlimit:10;stroke:#7ac142;fill:none;animation:stroke .6s cubic-bezier(.65,0,.45,1) forwards}.checkmark[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;display:block;stroke-width:2;stroke:#fff;stroke-miterlimit:10;margin:10% auto;box-shadow:inset 0 0 #7ac142;animation:fill .4s ease-in-out .4s forwards,scale .3s ease-in-out .9s both}.checkmark__check[_ngcontent-%COMP%]{transform-origin:50% 50%;stroke-dasharray:48;stroke-dashoffset:48;animation:stroke .3s cubic-bezier(.65,0,.45,1) .8s forwards}@keyframes stroke{to{stroke-dashoffset:0}}@keyframes scale{0%,to{transform:none}50%{transform:scale3d(1.1,1.1,1)}}@keyframes fill{to{box-shadow:inset 0 0 0 30px #7ac142}}"]}),S})()}}]);