"use strict";(self.webpackChunkmatngular=self.webpackChunkmatngular||[]).push([[224],{1224:(V,F,i)=>{i.r(F),i.d(F,{DashboardModule:()=>j});var b=i(2318),t=i(4650),p=i(7340),S=i(8423),C=i(3166),J=i(7185),Y=i(1927),I=i(1932),d=i(6895),L=i(805),Q=i(9775),M=i(6205);const w=["chart"],E=["chart2"],U=["chart3"];function k(o,r){if(1&o&&(t.TgZ(0,"div",12),t._UZ(1,"apx-chart",13),t.qZA()),2&o){const s=t.oxw(2);t.xp6(1),t.Q6J("series",s.chartOptions1.series)("colors",s.chartOptions1.colors)("chart",s.chartOptions1.chart)("xaxis",s.chartOptions1.xaxis)("yaxis",s.chartOptions1.yaxis)("title",s.chartOptions1.title)("dataLabels",s.chartOptions1.dataLabels)("stroke",s.chartOptions1.stroke)("grid",s.chartOptions1.grid)("tooltip",s.chartOptions1.tooltip)("plotOptions",s.chartOptions1.plotOptions)("fill",s.chartOptions1.fill)("legend",s.chartOptions1.legend)("labels",s.chartOptions1.labels)("markers",s.chartOptions1.markers)("theme",s.chartOptions1.theme)("responsive",s.chartOptions1.responsive)}}function $(o,r){if(1&o&&(t.TgZ(0,"div",14),t._UZ(1,"apx-chart",13),t.qZA()),2&o){const s=t.oxw(2);t.xp6(1),t.Q6J("series",s.chartOptions3.series)("colors",s.chartOptions3.colors)("chart",s.chartOptions3.chart)("xaxis",s.chartOptions3.xaxis)("yaxis",s.chartOptions3.yaxis)("title",s.chartOptions3.title)("dataLabels",s.chartOptions3.dataLabels)("stroke",s.chartOptions3.stroke)("grid",s.chartOptions3.grid)("tooltip",s.chartOptions3.tooltip)("plotOptions",s.chartOptions3.plotOptions)("fill",s.chartOptions3.fill)("legend",s.chartOptions3.legend)("labels",s.chartOptions3.labels)("markers",s.chartOptions3.markers)("theme",s.chartOptions3.theme)("responsive",s.chartOptions3.responsive)}}function G(o,r){if(1&o&&(t.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"h4",8),t._uU(6,"Weekly sales"),t.qZA()(),t.TgZ(7,"div",9),t.YNc(8,k,2,17,"div",10),t.qZA()()()(),t.TgZ(9,"div",4)(10,"div",5)(11,"div",6)(12,"div",7)(13,"h4",8),t._uU(14,"Monthly sales"),t.qZA()(),t.TgZ(15,"div",9),t.YNc(16,$,2,17,"div",11),t.qZA()()()()()),2&o){const s=t.oxw();t.xp6(2),t.Q6J("@enter",void 0),t.xp6(6),t.Q6J("ngIf",!s.loading),t.xp6(2),t.Q6J("@enter",void 0),t.xp6(6),t.Q6J("ngIf",!s.loading)}}function N(o,r){if(1&o&&(t.TgZ(0,"a",19)(1,"div",5)(2,"div",6)(3,"div",9)(4,"div",20)(5,"div",21)(6,"h6"),t._uU(7),t.ALo(8,"titlecase"),t.qZA(),t.TgZ(9,"h6",22)(10,"small",23),t._uU(11,"Transactions "),t.qZA(),t._uU(12),t.ALo(13,"number"),t.qZA()()()()()()()),2&o){const s=r.$implicit;t.Q6J("@enter",void 0),t.xp6(1),t.Q6J("@enter",void 0),t.xp6(6),t.Oqu(t.lcZ(8,4,s.item.name)),t.xp6(5),t.hij(" ",t.lcZ(13,6,s.total)," ")}}function P(o,r){if(1&o&&(t.TgZ(0,"div",3)(1,"div",15)(2,"div",5)(3,"div",6)(4,"div",16)(5,"h4",8),t._uU(6,"Top selling products"),t.qZA()(),t.TgZ(7,"div",17)(8,"div",3),t.YNc(9,N,14,8,"a",18),t.qZA()()()()()()),2&o){const s=t.oxw();t.xp6(2),t.Q6J("@enter",void 0),t.xp6(7),t.Q6J("ngForOf",s.topSellingProducts)}}const B=[{path:"",component:(()=>{class o{constructor(s,e,n,c,l,h,g,f,u,m){this.spinner=s,this.cryptoSrv=e,this.toastr=n,this.authSrv=c,this.apiSrv=l,this._decimalPipe=h,this.confirmationService=g,this.printSrv=f,this.datepipe=u,this.locale=m,this.loading=!0,this.weekLySales=[],this.monthlySales=[],this.topSellingProducts=[]}ngOnInit(){"admin"===this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("role"))?this.getDetails():(this.toastr.error("You have no rights to access that page!"),this.authSrv.logout())}getDetails(){this.spinner.show();const s={action:this.cryptoSrv.encodeEncryptText("get-dashboard-report"),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(s).then(e=>{if("error"!=e.status)if("error2"!=e.status){this.weekLySales=e.weekly_sales,this.monthlySales=e.monthly_sales,this.topSellingProducts=e.top_selling_products;const n=[],c=[],l=[],h=[],g={name:"Sales",data:[]},f={name:"Sales",data:[]},u={name:"Gross profit",data:[]},m={name:"Gross profit",data:[]},Z={name:"Expenses",data:[]},D={name:"Expenses",data:[]},T={name:"Net profit",data:[]},_={name:"Net profit",data:[]};this.weekLySales.forEach(a=>{const x=parseFloat(a.gross_sales.toString()).toFixed(2),v=parseFloat(a.gross_profit.toString()).toFixed(2),y=parseFloat(a.expenses.toString()).toFixed(2);a.gross_sales=parseFloat(x),a.gross_profit=parseFloat(v),a.expenses=parseFloat(y);const O=a.gross_profit-a.expenses;g.data.push(a.gross_sales),u.data.push(a.gross_profit),Z.data.push(a.expenses),T.data.push(O),c.push(this.datepipe.transform(new Date(a.date_sold.toString()),"MMM dd"))}),n.push(g,u,Z,T),this.monthlySales.forEach(a=>{const x=parseFloat(a.gross_sales.toString()).toFixed(2),v=parseFloat(a.gross_profit.toString()).toFixed(2),y=parseFloat(a.expenses.toString()).toFixed(2);a.gross_sales=parseFloat(x),a.gross_profit=parseFloat(v),a.expenses=parseFloat(y);const O=a.gross_profit-a.expenses;f.data.push(a.gross_sales),m.data.push(a.gross_profit),D.data.push(a.expenses),_.data.push(O),h.push(this.datepipe.transform(new Date(a.date_sold.toString()),"LLL yyyy"))}),l.push(f,m,D,_);const A=["#02926e","#F77E17","#F55252","#2F8BE6","#2F8BE6"];this.chartOptions1={chart:{height:350,type:"area",zoom:{enabled:!1},toolbar:{show:!1}},colors:A,fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.9,stops:[0,90,100]}},tooltip:{y:{formatter:function(a){return new Intl.NumberFormat("en-us",{minimumFractionDigits:2}).format(a)}}},dataLabels:{enabled:!1},stroke:{curve:"smooth"},series:n,title:{text:"",align:"left"},grid:{row:{colors:["#F5F5F5","transparent"],opacity:.5}},xaxis:{categories:c},yaxis:{title:{text:"Amount (Ksh)"},decimalsInFloat:2}},this.chartOptions3={chart:{height:350,type:"area",zoom:{enabled:!1},toolbar:{show:!1}},colors:A,fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.9,stops:[0,90,100]}},dataLabels:{enabled:!1},stroke:{curve:"smooth"},series:l,title:{text:"",align:"left"},grid:{row:{colors:["#F5F5F5","transparent"],opacity:.5}},xaxis:{categories:h},yaxis:{title:{text:"Amount (Ksh)"},decimalsInFloat:2},tooltip:{y:{formatter:function(a,{}){return new Intl.NumberFormat("en-us",{minimumFractionDigits:2}).format(a)}}}},this.loading=!1,this.spinner.hide()}else this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.spinner.hide(),this.toastr.error(e.message)}).catch(e=>{this.toastr.error(e),this.spinner.hide()})}}return o.\u0275fac=function(s){return new(s||o)(t.Y36(S.t2),t.Y36(C.$),t.Y36(J._W),t.Y36(Y.e),t.Y36(I.s),t.Y36(d.JJ),t.Y36(L.YP),t.Y36(Q.$),t.Y36(d.uU),t.Y36(t.soG))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-dashboard"]],viewQuery:function(s,e){if(1&s&&(t.Gf(w,5),t.Gf(E,5),t.Gf(U,5)),2&s){let n;t.iGM(n=t.CRH())&&(e.chart=n.first),t.iGM(n=t.CRH())&&(e.chart2=n.first),t.iGM(n=t.CRH())&&(e.chart3=n.first)}},decls:4,vars:3,consts:[["class","row",4,"ngIf"],["bdOpacity","#fff","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[2,"color","#02926e"],[1,"row"],[1,"col-md-6"],[1,"card"],[1,"card-content"],[1,"card-header"],[1,"card-title"],[1,"card-body"],["id","chart",4,"ngIf"],["id","chart2",4,"ngIf"],["id","chart"],[3,"series","colors","chart","xaxis","yaxis","title","dataLabels","stroke","grid","tooltip","plotOptions","fill","legend","labels","markers","theme","responsive"],["id","chart2"],[1,"col-md-12"],[1,"card-header","py-2"],[1,"card-body",2,"background","#F7F7F8"],["class","col-md-3",4,"ngFor","ngForOf"],[1,"col-md-3"],[1,"media"],[1,"media-body"],[1,"text-right","mt-3"],[1,"text-sm","float-left",2,"margin-top","0.10rem"]],template:function(s,e){1&s&&(t.YNc(0,G,17,4,"div",0),t.YNc(1,P,10,2,"div",0),t.TgZ(2,"ngx-spinner",1),t._UZ(3,"p",2),t.qZA()),2&s&&(t.Q6J("ngIf",!e.loading),t.xp6(1),t.Q6J("ngIf",!e.loading),t.xp6(1),t.Q6J("fullScreen",!0))},dependencies:[d.sg,d.O5,S.Ro,M.x,d.JJ,d.rS],data:{animation:[(0,p.X$)("enter",[(0,p.eR)("void => *",[(0,p.oB)({opacity:0}),(0,p.jt)(1e3,(0,p.oB)({opacity:1}))])])]}}),o})(),data:{title:"Dashboard"}}];let R=(()=>{class o{}return o.\u0275fac=function(s){return new(s||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[b.Bz.forChild(B),b.Bz]}),o})();var z=i(4397);let j=(()=>{class o{}return o.\u0275fac=function(s){return new(s||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[R,z.U]}),o})()}}]);