"use strict";(self.webpackChunkmatngular=self.webpackChunkmatngular||[]).push([[802],{6802:(Me,w,l)=>{l.r(w),l.d(w,{TransferSaleModule:()=>xe});var M=l(2318),t=l(4650),v=l(2841),D=l(2340),_=l(6895),Y=l(6498),f=l(7340),U=l(8423),B=l(3166),H=l(7185),G=l(1927),K=l(1932),C=l(805),j=l(9775),h=l(4006),V=l(1493),$=l(2137),I=l(5593),A=l(3087),W=l(5722),z=l(1740),X=l(666),tt=l(2435),et=l(8558),it=l(8271),ot=l(2665),nt=l(613),at=l(585);const st=["dt1"],rt=["op"],lt=["op1"];function ct(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",30)(1,"th",31),t._uU(2,"Customer "),t.qZA(),t._UZ(3,"th"),t.qZA(),t.TgZ(4,"tr")(5,"th",32)(6,"input",33),t.NdJ("input",function(i){t.CHM(e),t.oxw();const a=t.MAs(10);return t.KtG(a.filter(i.target.value,"name","contains"))}),t.qZA()()()}}function pt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",34)(1,"td",35)(2,"label"),t._uU(3),t.ALo(4,"titlecase"),t.qZA()(),t.TgZ(5,"td")(6,"p-button",36),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.displayWaitingCustomers=!0)})("click",function(){const a=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.selectCustomer(a))}),t.qZA()()()}if(2&n){const e=r.$implicit;t.xp6(3),t.hij(" ",t.lcZ(4,3,e.name)," "),t.xp6(3),t.Tol(e.pending_transactions.length>0?"animate-flicker":"")}}function _t(n,r){1&n&&(t.TgZ(0,"tr")(1,"td",37),t._uU(2,"No items found."),t.qZA()())}const x=function(){return[10,25,50]},dt=function(){return["customer"]};function ut(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",7),t._UZ(1,"div",18),t.TgZ(2,"div",19)(3,"div",20)(4,"div",21)(5,"h4",22),t._uU(6," Select customer to transfer items "),t.TgZ(7,"p-button",23),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.getReprintData())}),t.qZA()()(),t.TgZ(8,"div",24)(9,"p-table",25,26),t.YNc(11,ct,7,0,"ng-template",27),t.YNc(12,pt,7,5,"ng-template",28),t.YNc(13,_t,3,0,"ng-template",29),t.qZA()()()()()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("@enter",void 0),t.xp6(6),t.Q6J("value",e.debtorsWithSales)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(9,x))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(10,dt))}}function ht(n,r){if(1&n&&(t.TgZ(0,"div",53)(1,"span"),t._uU(2),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.name)}}function gt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",30)(1,"th",44),t._uU(2,"Item "),t._UZ(3,"p-sortIcon",45),t.qZA(),t.TgZ(4,"th",46),t._uU(5,"Category "),t._UZ(6,"p-sortIcon",47),t.qZA(),t.TgZ(7,"th",48),t._uU(8,"Locations "),t.qZA(),t._UZ(9,"th",49),t.qZA(),t.TgZ(10,"tr")(11,"th")(12,"input",50),t.NdJ("input",function(i){t.CHM(e),t.oxw();const a=t.MAs(10);return t.KtG(a.filter(i.target.value,"name","contains"))}),t.qZA()(),t.TgZ(13,"th")(14,"p-multiSelect",51),t.NdJ("onChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.onCategoryChange(i))}),t.YNc(15,ht,3,1,"ng-template",52),t.qZA()(),t._UZ(16,"th")(17,"th"),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(14),t.Q6J("options",e.categories)}}const T=function(n){return{"background-color":n,color:"#ffffff",cursor:"pointer"}};function mt(n,r){if(1&n&&t._UZ(0,"p-avatar",60),2&n){const e=r.index,o=t.oxw(4);t.Akn(t.VKq(2,T,o.locations[e].color))}}const k=function(){return[]};function ft(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-avatarGroup",58),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.showLocationsQuantity(a,i))}),t.YNc(1,mt,1,4,"p-avatar",59),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",t.DdM(1,k).constructor(e.locations_count))}}function xt(n,r){1&n&&(t.TgZ(0,"small",61),t._uU(1," Missing units "),t.qZA())}function Tt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-button",62),t.NdJ("onClick",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.selectItem(i))}),t.qZA()}if(2&n){const e=t.oxw().$implicit,o=t.oxw(2);t.Q6J("loading",null!=o.itemToViewLocations&&o.itemToViewLocations.id===e.id&&o.loading2)}}function St(n,r){1&n&&t._UZ(0,"p-message",63)}function yt(n,r){if(1&n&&(t.TgZ(0,"tr",34)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"titlecase"),t.qZA(),t.TgZ(7,"td"),t.YNc(8,ft,2,2,"p-avatarGroup",54),t.YNc(9,xt,2,0,"small",55),t.qZA(),t.TgZ(10,"td"),t.YNc(11,Tt,1,1,"p-button",56),t.YNc(12,St,1,0,"p-message",57),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,6,e.name)," "),t.xp6(3),t.hij(" ",t.lcZ(6,8,e.category.name)," "),t.xp6(3),t.Q6J("ngIf",e.locations_count>0&&1==e.min_unit_ok),t.xp6(1),t.Q6J("ngIf",e.units<1||0==e.min_unit_ok),t.xp6(2),t.Q6J("ngIf",e.locations_count>0&&e.units>0&&1==e.min_unit_ok),t.xp6(1),t.Q6J("ngIf",e.units<1||e.locations_count<1||0==e.min_unit_ok)}}function vt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",30)(1,"th",64),t._uU(2,"Item "),t._UZ(3,"p-sortIcon",45),t.qZA(),t.TgZ(4,"th",48),t._uU(5,"Location "),t.qZA(),t.TgZ(6,"th",48),t._uU(7,"Unit "),t.qZA(),t.TgZ(8,"th",48),t._uU(9,"Qty "),t.qZA(),t.TgZ(10,"th",48),t._uU(11,"Price "),t.qZA(),t.TgZ(12,"th",48),t._uU(13,"Total "),t.qZA(),t._UZ(14,"th",49),t.qZA(),t.TgZ(15,"tr")(16,"th")(17,"input",50),t.NdJ("input",function(i){t.CHM(e),t.oxw();const a=t.MAs(20);return t.KtG(a.filter(i.target.value,"item.name","contains"))}),t.qZA()(),t._UZ(18,"th")(19,"th")(20,"th")(21,"th")(22,"th")(23,"th"),t.qZA()}}function Zt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",34)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td")(5,"p-avatarGroup"),t._UZ(6,"p-avatar",65),t.qZA()(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"titlecase"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"number"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA(),t.TgZ(19,"td")(20,"p-button",66),t.NdJ("onClick",function(){const a=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.confirmDelete(a))}),t.qZA()()()}if(2&n){const e=r.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,7,e.item.name)," "),t.xp6(4),t.Akn(t.VKq(19,T,e.location.color)),t.xp6(2),t.hij(" ",t.lcZ(9,9,e.unit.unit_name)," "),t.xp6(3),t.hij(" ",t.lcZ(12,11,e.qty)," "),t.xp6(3),t.hij(" ",t.xi3(15,13,e.sp,".2")," "),t.xp6(3),t.hij(" ",t.xi3(18,16,e.qty*e.sp,".2")," ")}}function Ct(n,r){if(1&n&&(t.TgZ(0,"div",67)(1,"div",68)(2,"div",69)(3,"div",70)(4,"h3"),t._uU(5),t.ALo(6,"number"),t.qZA()()()()()),2&n){const e=t.oxw(2);t.xp6(5),t.hij("Total: \xa0Ksh ",t.xi3(6,1,e.totalCartAmount,".2"),"")}}function At(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",76)(1,"p-radioButton",89),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.todayChecked=i)}),t.qZA(),t.TgZ(2,"label",90),t._uU(3,"Different date"),t.qZA()()}if(2&n){const e=t.oxw(4);t.xp6(1),t.Q6J("ngModel",e.todayChecked)}}function bt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-calendar",91),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(4);return t.KtG(a.dateOfSale=i)}),t.qZA()}if(2&n){const e=t.oxw(4);t.Q6J("ngModel",e.dateOfSale)("maxDate",e.today)("touchUI",!1)("monthNavigator",!0)}}function qt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",83,84)(2,"div",74)(3,"div",75)(4,"h5"),t._uU(5,"Date of sale"),t.qZA(),t.TgZ(6,"div",76)(7,"p-radioButton",85),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(3);return t.KtG(a.todayChecked=i)}),t.qZA(),t.TgZ(8,"label",86),t._uU(9,"Today"),t.qZA()(),t.YNc(10,At,4,1,"div",87),t.YNc(11,bt,1,4,"p-calendar",88),t.qZA()()()}if(2&n){const e=t.oxw(3);t.xp6(7),t.Q6J("ngModel",e.todayChecked),t.xp6(3),t.Q6J("ngIf",e.userIsAdmin),t.xp6(1),t.Q6J("ngIf",e.userIsAdmin)}}function wt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",7)(1,"div",71),t.YNc(2,qt,12,3,"div",72),t.TgZ(3,"div",73)(4,"div",74)(5,"div",75)(6,"div",76)(7,"p-radioButton",77),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.printReceipt=i)}),t.qZA(),t.TgZ(8,"label",78),t._uU(9,"Print receipt"),t.qZA()(),t.TgZ(10,"div",76)(11,"p-radioButton",79),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.printReceipt=i)}),t.qZA(),t.TgZ(12,"label",80),t._uU(13,"No receipt"),t.qZA()()()()(),t.TgZ(14,"div",81)(15,"button",82),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.completeSale())}),t.qZA()()()()}if(2&n){const e=t.oxw(2);t.Q6J("@enter",void 0),t.xp6(2),t.Q6J("ngIf",e.userIsAdmin),t.xp6(5),t.Q6J("ngModel",e.printReceipt),t.xp6(4),t.Q6J("ngModel",e.printReceipt)}}const Mt=function(){return{width:"95vw"}},b=function(){return["name","description"]};function Dt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-dialog",38),t.NdJ("visibleChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.displayCustomerDialog=i)}),t.ALo(1,"titlecase"),t.TgZ(2,"div",7)(3,"div",19)(4,"div",20)(5,"div",21)(6,"h4",22),t._uU(7," Select item to sell "),t.qZA()(),t.TgZ(8,"div",24)(9,"p-table",25,39),t.YNc(11,gt,18,1,"ng-template",27),t.YNc(12,yt,13,10,"ng-template",28),t.qZA()()()(),t.TgZ(13,"div",19)(14,"div",20)(15,"div",21)(16,"h4",22),t._uU(17," Items selected "),t.qZA()(),t.TgZ(18,"div",24)(19,"p-table",25,40),t.YNc(21,vt,24,0,"ng-template",27),t.YNc(22,Zt,21,21,"ng-template",28),t.qZA(),t.YNc(23,Ct,7,4,"div",41),t.YNc(24,wt,16,4,"div",0),t.qZA()()()(),t.TgZ(25,"p-footer")(26,"button",42),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return i.displayCustomerDialog=!1,i.totalCartAmount=0,t.KtG(i.ngOnInit())}),t.qZA()(),t.TgZ(27,"ngx-spinner",43),t._UZ(28,"p",5),t.qZA()()}if(2&n){const e=t.oxw();t.Akn(t.DdM(27,Mt)),t.Q6J("header",t.lcZ(1,25,e.selectedCustomer.name))("closable",!1)("visible",e.displayCustomerDialog)("baseZIndex",1e4),t.xp6(9),t.Q6J("value",e.allStock)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(28,x))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(29,b)),t.xp6(10),t.Q6J("value",e.cartItems)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(30,x))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(31,b)),t.xp6(4),t.Q6J("ngIf",e.totalCartAmount>0),t.xp6(1),t.Q6J("ngIf",e.totalCartAmount>0),t.xp6(3),t.Q6J("fullScreen",!0)}}function Ut(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.Oqu(e.location.name)}}function It(n,r){if(1&n&&(t.TgZ(0,"div",110)(1,"div"),t._uU(2),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.location.name)}}function kt(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.Oqu(e.unit_name)}}function Lt(n,r){if(1&n&&(t.TgZ(0,"div",110)(1,"div"),t._uU(2),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.unit_name)}}function Et(n,r){1&n&&(t.TgZ(0,"tr")(1,"th",32),t._uU(2,"Available"),t.qZA()())}function Nt(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"number"),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(t.lcZ(3,2,e[0])),t.xp6(3),t.Oqu(t.lcZ(6,4,e[1]))}}function Jt(n,r){if(1&n&&(t.TgZ(0,"div",97)(1,"p-table",111),t.YNc(2,Et,3,0,"ng-template",27),t.YNc(3,Nt,7,6,"ng-template",28),t.qZA()()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("value",e.availableUnits)("paginator",!1)("rows",10)}}function Ft(n,r){if(1&n&&(t.TgZ(0,"small",112),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.quantityError," ")}}function Qt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"form",94,95),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addToCart())}),t.TgZ(2,"div",7)(3,"div",10)(4,"div",96)(5,"div",7)(6,"div",97)(7,"div",98)(8,"label",99),t._uU(9,"Location to sell item"),t.qZA(),t._UZ(10,"br"),t.TgZ(11,"p-dropdown",100),t.NdJ("onChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.updateLocationSelected(i))})("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.itemToSellModel.location=i)}),t.YNc(12,Ut,2,1,"ng-template",101),t.YNc(13,It,3,1,"ng-template",52),t.qZA()(),t.TgZ(14,"div",98)(15,"label",102),t._uU(16,"Unit to sell"),t.qZA(),t._UZ(17,"br"),t.TgZ(18,"p-dropdown",103),t.NdJ("onChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.updateUnitSelected(i))})("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.itemToSellModel.unit=i)}),t.YNc(19,kt,2,1,"ng-template",101),t.YNc(20,Lt,3,1,"ng-template",52),t.qZA()()(),t.YNc(21,Jt,4,3,"div",104),t.qZA(),t.TgZ(22,"div",98)(23,"label",105),t._uU(24,"Unit quantity to sell"),t.qZA(),t.TgZ(25,"input",106),t.NdJ("input",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.checkQuantity())})("ngModelChange",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.itemToSellModel.unit_quantity=i)}),t.qZA(),t.YNc(26,Ft,2,1,"small",107),t.qZA()()()(),t.TgZ(27,"p-footer")(28,"button",108),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.hideSellForm())}),t.qZA(),t._UZ(29,"button",109),t.qZA()()}if(2&n){const e=t.MAs(1),o=t.oxw(2);t.xp6(11),t.Q6J("options",o.itemToSellModel.locations_qty)("ngModel",o.itemToSellModel.location),t.xp6(7),t.Q6J("options",o.itemToSellModel.selling_units)("disabled",!o.activateSellForm||null==o.itemToSellModel.location)("ngModel",o.itemToSellModel.unit),t.xp6(3),t.Q6J("ngIf",o.availableUnits!=t.DdM(10,k)),t.xp6(4),t.Q6J("disabled",!o.activateSellForm||null==o.itemToSellModel.unit)("ngModel",o.itemToSellModel.unit_quantity),t.xp6(1),t.Q6J("ngIf",""!=o.quantityError),t.xp6(3),t.Q6J("disabled",!e.valid||null==o.itemToSellModel.location||o.itemToSellModel.unit_quantity<1||null==o.itemToSellModel.unit||""!=o.quantityError||""!=o.discountError||!o.activateSellForm||o.buttonClicked)}}const L=function(){return{width:"30vw"}};function Pt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-dialog",38),t.NdJ("visibleChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.displaySellDialog=i)}),t.YNc(1,Qt,30,11,"form",92),t.TgZ(2,"ngx-spinner",93),t._UZ(3,"p",5),t.qZA()()}if(2&n){const e=t.oxw();t.Akn(t.DdM(8,L)),t.s9C("header",e.itemToSellModel.name),t.Q6J("closable",!1)("visible",e.displaySellDialog)("baseZIndex",1e4),t.xp6(1),t.Q6J("ngIf",!e.showNotification),t.xp6(1),t.Q6J("fullScreen",!1)}}function Rt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",30)(1,"th",114),t._uU(2," Customer "),t._UZ(3,"p-sortIcon",45),t.qZA(),t.TgZ(4,"th",48),t._uU(5,"Receipt number "),t.qZA(),t.TgZ(6,"th",48),t._uU(7,"Receipt total "),t.qZA(),t.TgZ(8,"th",48),t._uU(9,"Date sold "),t.qZA(),t.TgZ(10,"th",48),t._uU(11,"Reversed amount "),t.qZA(),t._UZ(12,"th",115),t.qZA(),t.TgZ(13,"tr")(14,"th",116)(15,"input",33),t.NdJ("input",function(i){t.CHM(e),t.oxw();const a=t.MAs(1);return t.KtG(a.filterGlobal(i.target.value,"contains"))}),t.qZA()()()}}function Ot(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-button",119),t.NdJ("onClick",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.selectReceipt(i,!0))}),t.qZA()}}function Yt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-button",120),t.NdJ("onClick",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.selectReceipt(i,!1))}),t.qZA()}}function Bt(n,r){if(1&n&&(t.TgZ(0,"tr",34)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.ALo(8,"number"),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"date"),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.ALo(14,"number"),t.qZA(),t.TgZ(15,"td"),t.YNc(16,Ot,1,0,"p-button",117),t.YNc(17,Yt,1,0,"p-button",118),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,7,e.customer.name)," "),t.xp6(3),t.hij(" ",e.transaction_code," "),t.xp6(2),t.hij(" ",t.xi3(8,9,e.transaction_total,".2")," "),t.xp6(3),t.hij(" ",t.lcZ(11,12,e.date_of_sale)," "),t.xp6(3),t.hij(" ",t.xi3(14,14,e.reversed,".2")," "),t.xp6(3),t.Q6J("ngIf",e.transaction_total>0),t.xp6(1),t.Q6J("ngIf",e.transaction_total>0)}}const Ht=function(){return["customer.name","transaction_code","transaction_total"]};function Gt(n,r){if(1&n&&(t.TgZ(0,"p-table",25,113),t.YNc(2,Rt,16,0,"ng-template",27),t.YNc(3,Bt,18,17,"ng-template",28),t.qZA()),2&n){const e=t.oxw();t.Q6J("value",e.reprintItems)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(8,x))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(9,Ht))}}function Kt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",30)(1,"th",64),t._uU(2,"Item "),t._UZ(3,"p-sortIcon",45),t.qZA(),t.TgZ(4,"th",48),t._uU(5,"Location "),t.qZA(),t.TgZ(6,"th",48),t._uU(7,"Unit "),t.qZA(),t.TgZ(8,"th",48),t._uU(9,"Qty "),t.qZA(),t.TgZ(10,"th",48),t._uU(11,"Price "),t.qZA(),t.TgZ(12,"th",48),t._uU(13,"Total "),t.qZA()(),t.TgZ(14,"tr")(15,"th",122)(16,"input",50),t.NdJ("input",function(i){t.CHM(e),t.oxw();const a=t.MAs(1);return t.KtG(a.filter(i.target.value,"item.name","contains"))}),t.qZA()()()}}function jt(n,r){if(1&n&&(t.TgZ(0,"tr",34)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td")(5,"p-avatarGroup"),t._UZ(6,"p-avatar",65),t.qZA()(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"titlecase"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"number"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,7,e.item.name)," "),t.xp6(4),t.Akn(t.VKq(19,T,e.location.color)),t.xp6(2),t.hij(" ",t.lcZ(9,9,e.unit.unit_name)," "),t.xp6(3),t.hij(" ",t.lcZ(12,11,e.qty)," "),t.xp6(3),t.hij(" ",t.xi3(15,13,e.sp,".2")," "),t.xp6(3),t.hij(" ",t.xi3(18,16,e.qty*e.sp,".2")," ")}}function Vt(n,r){if(1&n&&(t.TgZ(0,"p-table",25,121),t.YNc(2,Kt,17,0,"ng-template",27),t.YNc(3,jt,19,21,"ng-template",28),t.qZA()),2&n){const e=t.oxw();t.Q6J("value",e.transactionToView.items)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(8,x))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(9,b))}}function $t(n,r){1&n&&(t.TgZ(0,"tr",30)(1,"th",126),t._uU(2,"Item "),t.qZA(),t.TgZ(3,"th",48),t._uU(4,"Quantity ordered "),t.qZA(),t.TgZ(5,"th",126),t._uU(6,"Quantity available "),t.qZA()())}const Wt=function(n){return{"word-wrap":"normal",color:n}};function zt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td")(5,"p-avatarGroup",58),t.NdJ("click",function(i){const s=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.showLocationsQuantityOrdered(s.item,s,i))}),t._UZ(6,"p-avatar",60),t.qZA()(),t.TgZ(7,"td")(8,"p-avatarGroup",58),t.NdJ("click",function(i){const s=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.showLocationsQuantityNew(s.item,i))}),t._UZ(9,"p-avatar",60),t.qZA()()()}if(2&n){const e=r.$implicit;t.Akn(t.VKq(9,Wt,e.location.color)),t.xp6(2),t.hij(" ",t.lcZ(3,7,e.item.name)," "),t.xp6(4),t.Akn(t.VKq(11,T,e.location.color)),t.xp6(3),t.Akn(t.VKq(13,T,e.location.color))}}const Xt=function(){return{width:"50vw"}},te=function(){return[500]},ee=function(){return["item.name"]};function ie(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-dialog",123),t.NdJ("visibleChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.showQuantityError=i)}),t.TgZ(1,"div",7)(2,"div",124)(3,"p-table",25,125),t.YNc(5,$t,7,0,"ng-template",27),t.YNc(6,zt,10,15,"ng-template",28),t.qZA()()()()}if(2&n){const e=t.oxw();t.Akn(t.DdM(13,Xt)),t.Q6J("closable",!0)("visible",e.showQuantityError)("baseZIndex",1e4),t.xp6(3),t.Q6J("value",e.lessItems)("rowHover",!0)("rows",10)("showCurrentPageReport",!1)("rowsPerPageOptions",t.DdM(14,te))("paginator",!1)("filterDelay",0)("globalFilterFields",t.DdM(15,ee))}}function oe(n,r){if(1&n&&(t.TgZ(0,"th"),t._uU(1),t.ALo(2,"titlecase"),t.ALo(3,"number"),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,e.unit_name)," (",t.lcZ(3,4,e.unit_quantity),") ")}}function ne(n,r){if(1&n&&(t.TgZ(0,"tr"),t._UZ(1,"th"),t.TgZ(2,"th"),t._uU(3,"Location"),t.qZA(),t.YNc(4,oe,4,6,"th",127),t.qZA()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",e.itemToViewLocations.selling_units)}}function ae(n,r){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&n){const e=r.$implicit,o=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",i.getLocationUnitQuantityOrdered(o.location_quantity,i.itemToViewLocations.selling_units)[e.unit_name]," ")}}const E=function(n){return{"background-color":n,color:"#ffffff"}};function se(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"p-avatar",60),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.YNc(6,ae,2,1,"td",127),t.qZA()),2&n){const e=r.$implicit,o=t.oxw(2);t.xp6(2),t.Akn(t.VKq(6,E,e.location.color)),t.xp6(2),t.Oqu(t.lcZ(5,4,e.location.name)),t.xp6(2),t.Q6J("ngForOf",o.itemToViewLocations.selling_units)}}function re(n,r){if(1&n&&(t.TgZ(0,"p-table",111),t.YNc(1,ne,5,1,"ng-template",27),t.YNc(2,se,7,8,"ng-template",28),t.qZA()),2&n){const e=t.oxw();t.Q6J("value",e.itemToViewLocations.locations_qty)("paginator",!1)("rows",5)}}function le(n,r){if(1&n&&(t.TgZ(0,"th"),t._uU(1),t.ALo(2,"titlecase"),t.ALo(3,"number"),t.TgZ(4,"p",128)(5,"i",129),t._uU(6),t.ALo(7,"number"),t.qZA()()()),2&n){const e=r.$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,3,e.unit_name)," (",t.lcZ(3,5,e.unit_quantity),") "),t.xp6(5),t.hij("@Ksh ",t.lcZ(7,7,e.recom_selling_price),"")}}function ce(n,r){if(1&n&&(t.TgZ(0,"tr"),t._UZ(1,"th"),t.TgZ(2,"th"),t._uU(3,"Location"),t.qZA(),t.YNc(4,le,8,9,"th",127),t.qZA()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",e.itemToViewLocations.selling_units)}}function pe(n,r){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&n){const e=r.$implicit,o=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.hij(" ",i.getLocationUnitQuantity(o.location_quantity,i.itemToViewLocations.selling_units)[e.unit_name]," ")}}function _e(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"p-avatar",60),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.YNc(6,pe,2,1,"td",127),t.qZA()),2&n){const e=r.$implicit,o=t.oxw(2);t.xp6(2),t.Akn(t.VKq(6,E,e.location.color)),t.xp6(2),t.Oqu(t.lcZ(5,4,e.location.name)),t.xp6(2),t.Q6J("ngForOf",o.itemToViewLocations.selling_units)}}function de(n,r){if(1&n&&(t.TgZ(0,"p-table",111),t.YNc(1,ce,5,1,"ng-template",27),t.YNc(2,_e,7,8,"ng-template",28),t.qZA()),2&n){const e=t.oxw();t.Q6J("value",e.itemToViewLocations.locations_qty)("paginator",!1)("rows",5)}}const ue=function(){return{width:"80vw"}},he=function(){return{width:"70vw"}},N=function(){return{width:"500px"}},ge=[{path:"",component:(()=>{class n{constructor(e,o,i,a,s,p,g,Z,q){this.spinner=e,this.cryptoSrv=o,this.toastr=i,this.authSrv=a,this.apiSrv=s,this._decimalPipe=p,this.confirmationService=g,this.printSrv=Z,this.locale=q,this.productImagesUrl=D.N.imageUrls,this.shopLogoUrl=D.N.shopLogoUrls,this.debtorsWithSales=[],this.allStock=[],this.displayCustomerDialog=!1,this.totalCartAmount=0,this.cartItems=[],this.activateSellForm=!1,this.printReceipt="yes",this.todayChecked="today",this.dateOfSale=new Date,this.showNotification=!1,this.itemToSellModel={},this.displaySellDialog=!1,this.quantityError="",this.discountError="",this.receiptCustomer="",this.loading=!0,this.categories=[],this.showReprintForm=!1,this.reprintItems=[],this.displayItemsDialog=!1,this.userIsAdmin=!1,this.availableUnits=[],this.buttonClicked=!1,this.loading2=!1,this.transportCost=0,this.transportPayType="cash",this.loaderToShow="",this.showQuantityError=!1,this.lessItems=[]}ngOnInit(){"admin"===this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("role"))&&(this.userIsAdmin=!0),"1"===this.cryptoSrv.decryptEncodedText(this.authSrv.getRoleToken("sell_transfer"))||this.userIsAdmin?this.getCustomers():(this.toastr.error("You have no rights to access that page!"),this.authSrv.logout())}getCustomers(){this.spinner.show();const e={action:this.cryptoSrv.encodeEncryptText("get-all-transfer-customers-and-pending-sales"),uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.debtorsWithSales=o.debtors,this.spinner.hide(),this.loading=!1):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide()})}onCategoryChange(e){this.table.filter(e.value,"category","in")}showLocationsQuantity(e,o){if(e.selling_units)this.itemToViewLocations=e,this.overlay.toggle(o);else{this.loading2=!0;let i=this.allStock.find(s=>s.id===e.id);this.itemToViewLocations=i;const a={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(a).then(s=>{"error"!=s.status?"error2"!=s.status?(i.selling_units=s.selling_units,i.locations_qty=s.locations_qty,i.total_qty=s.total_qty,i.locations=s.locations,this.overlay.toggle(o),this.loading2=!1):(this.loading2=!1,this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loading2=!1,this.toastr.error(s.message))}).catch(s=>{this.toastr.error(s),this.loading2=!1})}}getLocationUnitQuantity(e,o){const i={};return(o=o.sort((a,s)=>s.unit_quantity-a.unit_quantity)).forEach(a=>{if(e>0){const s=Math.floor(e/a.unit_quantity);i[a.unit_name]=s,e-=s*a.unit_quantity}else i[a.unit_name]=0}),i}selectCustomer(e){if("localhost"==window.location.hostname){this.showNotification=!1,this.selectedCustomer=e,this.totalCartAmount=0,this.spinner.show();const i={action:this.cryptoSrv.encodeEncryptText("get-stock-and-debtor-cart-items"),uid:this.authSrv.getUserDetailToken("uid"),cid:this.selectedCustomer.id};this.apiSrv.read(i).then(a=>{"error"!=a.status?"error2"!=a.status?(this.allStock=a.data.stock,this.locations=a.data.locations,this.categories=a.data.categories,this.cartItems=a.cartItems,this.cartItems.forEach(s=>{this.totalCartAmount+=s.qty*s.sp}),this.allStock.forEach(s=>{parseInt(s.prices_ok.toString())>0?(s.prices_ok=!1,s.sp_units_ok=!1,s.attention=1):(s.prices_ok=!0,s.sp_units_ok=!0),parseInt(s.min_qty_ok.toString())<1||parseInt(s.min_qty_ok.toString())>1?(s.min_qty_ok=!1,s.min_unit_ok=!1,s.attention=1):(s.min_qty_ok=!0,s.min_unit_ok=!0),s.locations_count=parseInt(s.locations_count.toString()),s.category=this.categories.find(p=>p.id===s.category_id)}),this.spinner.hide(),this.displayCustomerDialog=!0):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(a.message))}).catch(a=>{this.toastr.error(a),this.spinner.hide()})}else{this.showNotification=!1,this.selectedCustomer=e,this.totalCartAmount=0,this.spinner.show();const i={action:this.cryptoSrv.encodeEncryptText("get-stock-and-debtor-cart-items"),uid:this.authSrv.getUserDetailToken("uid"),cid:this.selectedCustomer.id};this.apiSrv.read(i).then(a=>{"error"!=a.status?"error2"!=a.status?(this.allStock=a.data.stock,this.locations=a.data.locations,this.categories=a.data.categories,this.cartItems=a.cartItems,this.cartItems.forEach(s=>{this.totalCartAmount+=s.qty*s.sp}),this.allStock.forEach(s=>{parseInt(s.prices_ok.toString())>0?(s.prices_ok=!1,s.sp_units_ok=!1,s.attention=1):(s.prices_ok=!0,s.sp_units_ok=!0),parseInt(s.min_qty_ok.toString())<1||parseInt(s.min_qty_ok.toString())>1?(s.min_qty_ok=!1,s.min_unit_ok=!1,s.attention=1):(s.min_qty_ok=!0,s.min_unit_ok=!0),s.locations_count=parseInt(s.locations_count.toString()),s.category=this.categories.find(p=>p.id===s.category_id)}),this.spinner.hide(),this.displayCustomerDialog=!0):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(a.message))}).catch(a=>{this.toastr.error(a),this.spinner.hide()})}}getAllStockAndCart(){this.totalCartAmount=0,this.spinner.show("waiting");const e={action:this.cryptoSrv.encodeEncryptText("get-stock-and-debtor-cart-items"),uid:this.authSrv.getUserDetailToken("uid"),cid:this.selectedCustomer.id};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.allStock=o.data.stock,this.locations=o.data.locations,this.categories=o.data.categories,this.cartItems=o.cartItems,this.cartItems.forEach(i=>{this.totalCartAmount+=i.qty*i.sp}),this.allStock.forEach(i=>{parseInt(i.prices_ok.toString())>0?(i.prices_ok=!1,i.sp_units_ok=!1,i.attention=1):(i.prices_ok=!0,i.sp_units_ok=!0),parseInt(i.min_qty_ok.toString())<1||parseInt(i.min_qty_ok.toString())>1?(i.min_qty_ok=!1,i.min_unit_ok=!1,i.attention=1):(i.min_qty_ok=!0,i.min_unit_ok=!0),i.locations_count=parseInt(i.locations_count.toString()),i.category=this.categories.find(a=>a.id===i.category_id)}),this.spinner.hide("waiting"),this.loading=!1):(this.spinner.hide("waiting"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("waiting"),this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide("waiting")})}selectItem(e){if(e.selling_units)this.showNotification=!1,this.activateSellForm=!1,this.itemToSellModel=e,this.itemToSellModel.unit=e.selling_units[0],this.itemToSellModel.unit_price=this.itemToSellModel.unit.recom_selling_price,this.itemToSellModel.discount=0,this.itemToSellModel.total_price=0,this.availableUnits=[],this.buttonClicked=!1,this.displaySellDialog=!0;else{this.loading2=!0;let o=this.allStock.find(a=>a.id===e.id);this.itemToViewLocations=o;const i={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(i).then(a=>{"error"!=a.status?"error2"!=a.status?(o.selling_units=a.selling_units,o.locations_qty=a.locations_qty,o.total_qty=a.total_qty,o.locations=a.locations,this.showNotification=!1,this.activateSellForm=!1,this.itemToSellModel=e,this.itemToSellModel.unit=e.selling_units[0],this.itemToSellModel.unit_price=this.itemToSellModel.unit.recom_selling_price,this.itemToSellModel.discount=0,this.itemToSellModel.total_price=0,this.availableUnits=[],this.buttonClicked=!1,this.displaySellDialog=!0,this.loading2=!1):(this.loading2=!1,this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loading2=!1,this.toastr.error(a.message))}).catch(a=>{this.toastr.error(a),this.loading2=!1})}}updateLocationSelected(e){this.itemToSellModel.location=e.value,this.itemToSellModel.location_id=e.value.location.id,this.itemToSellModel.unit_quantity=0,this.itemToSellModel.unit=null,this.checkLockStatus()}updateUnitSelected(e){this.itemToSellModel.unit_id=e.value.id,this.itemToSellModel.unit=e.value,this.itemToSellModel.unit_price=this.itemToSellModel.unit.recom_selling_price,this.itemToSellModel.unit_quantity=0,this.checkLockStatus()}updateAvailableUnits(e){const o=this.getLocationUnitQuantity(e,this.itemToSellModel.selling_units);this.availableUnits=Object.entries(o)}checkLockStatus(){this.spinner.show("sell"),this.spinner.show("sellw");const e={action:this.cryptoSrv.encodeEncryptText("check-lock-status"),item_id:this.itemToSellModel.id,location_id:this.itemToSellModel.location_id,uid:this.authSrv.getUserDetailToken("uid"),right:this.cryptoSrv.encodeEncryptText("transfer")};this.apiSrv.read(e).then(o=>{if("error"!=o.status)if("error2"!=o.status){this.activateSellForm=!0;const i=this.itemToSellModel.locations_qty.find(({location:a})=>a.id===this.itemToSellModel.location.location.id);i.location_quantity=i?o.qty:0,this.updateAvailableUnits(o.qty),this.loading=!1,this.spinner.hide("sell"),this.spinner.hide("sellw")}else this.spinner.hide("sell"),this.spinner.hide("sellw"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.spinner.hide("sell"),this.spinner.hide("sellw"),"locked"===o.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+o.user)):(this.activateSellForm=!1,this.itemToSellModel.location=null,this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide("sell")})}checkQuantity(){const e=this.itemToSellModel.location,i=this.itemToSellModel.locations_qty.find(s=>s.id===e.id).location_quantity;if(this.itemToSellModel.unit_quantity*this.itemToSellModel.unit.unit_quantity>i){const s=Math.floor(parseInt(i)/parseInt(this.itemToSellModel.unit.unit_quantity));this.quantityError="You can only sell a max of "+s+" "+this.itemToSellModel.unit.unit_name}else this.itemToSellModel.total_price=parseFloat(this.itemToSellModel.unit_quantity)*parseFloat(this.itemToSellModel.unit_price),this.itemToSellModel.total_price=this._decimalPipe.transform(this.itemToSellModel.total_price,"1.2-2"),this.quantityError=""}hideSellForm(){this.displaySellDialog=!1,this.unLockItem(this.itemToSellModel)}unLockItem(e){if(this.itemToSellModel.location){this.spinner.show();const o={action:this.cryptoSrv.encodeEncryptText("unlock-item"),item_id:this.itemToSellModel.id,location_id:this.itemToSellModel.location.id,user_id:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(o).then(i=>{"error"!=i.status?"error2"!=i.status?(this.itemToSellModel={},this.getAllStockAndCart(),this.loading=!1,this.spinner.hide()):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),"locked"===i.message?this.toastr.warning("Item is locked by "+i.user):this.toastr.error(i.message))}).catch(i=>{this.toastr.error(i),this.spinner.hide()})}else this.displaySellDialog=!1,this.itemToSellModel={}}addToCart(){this.buttonClicked=!0,this.spinner.show("sell");const e=parseFloat(this.itemToSellModel.unit_quantity)*parseFloat(this.itemToSellModel.unit.unit_quantity),o=parseFloat(this.itemToSellModel.buying_price)*parseFloat(this.itemToSellModel.unit.unit_quantity),i=parseFloat(this.itemToSellModel.unit.min_selling_price),a=parseFloat(this.itemToSellModel.unit.recom_selling_price),s={action:this.cryptoSrv.encodeEncryptText("add-item-to-cart-transfer"),item_id:this.itemToSellModel.id,cid:this.selectedCustomer.id,location_id:this.itemToSellModel.location.location.id,unit_id:this.itemToSellModel.unit.id,unit_qty:this.cryptoSrv.encodeEncryptText(this.itemToSellModel.unit_quantity.toString()),tt_qty:this.cryptoSrv.encodeEncryptText(e.toString()),unit_bp:this.cryptoSrv.encodeEncryptText(o.toString()),min_sp:this.cryptoSrv.encodeEncryptText(i.toString()),recom_sp:this.cryptoSrv.encodeEncryptText(a.toString()),unit_price:this.cryptoSrv.encodeEncryptText(o.toString()),uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(s).then(p=>{"error"!=p.status?"error2"!=p.status?(this.activateSellForm=!1,this.displaySellDialog=!1,this.spinner.hide("sell"),this.buttonClicked=!1,this.getAllStockAndCart()):(this.spinner.hide("sell"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("sell"),"locked"===p.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+p.user)):this.toastr.error(p.message))}).catch(p=>{this.toastr.error(p),this.spinner.hide("sell")})}confirmDelete(e){this.confirmationService.confirm({message:"Are you sure you want to delete item from list?",acceptButtonStyleClass:"btn btn-primary",rejectButtonStyleClass:"btn btn-danger",accept:()=>{this.spinner.show("waiting");const o=e.unit.unit_quantity*e.qty,i={action:this.cryptoSrv.encodeEncryptText("delete-item-from-cart"),id:e.id,item_id:e.item.id,tt_qty:this.cryptoSrv.encodeEncryptText(o.toString()),location_id:e.location.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(i).then(a=>{"error"!=a.status?"error2"!=a.status?(this.toastr.success("Item deleted"),this.getAllStockAndCart()):(this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout(),this.spinner.hide("waiting")):(this.spinner.hide("new"),"locked"===a.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+a.user)):this.toastr.error(a.message))}).catch(a=>{this.toastr.error(a),this.spinner.hide("waiting")})},reject:()=>{}})}completeSale(){this.spinner.show("waiting");const e=new Date;this.dateOfSale.setHours(e.getHours()),this.dateOfSale.setMinutes(e.getMinutes()),this.dateOfSale.setSeconds(e.getSeconds());const o={action:this.cryptoSrv.encodeEncryptText("complete-transfer-sale"),cid:this.selectedCustomer.id,date_of_sale:this.cryptoSrv.encodeEncryptText(this.dateOfSale.toLocaleString("sv-SE",{hour12:!1})),added_by:this.authSrv.getUserDetailToken("uid"),total:this.cryptoSrv.encodeEncryptText(this.totalCartAmount.toString())};this.apiSrv.post(o).then(i=>{"error"!=i.status?"error2"!=i.status?"lock"!=i.status?(this.displayCustomerDialog=!1,"yes"===this.printReceipt?(this.shopDetail=i.Shop,this.printTestWaitingCustomer()):(this.ngOnInit(),this.toastr.success("Sale completed!")),this.spinner.hide("waiting")):(this.spinner.hide("waiting"),this.toastr.warning(i.message)):(this.spinner.hide("waiting"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):"Quantity less!"==i.message?(this.spinner.hide("waiting"),this.showQuantityError=!0,this.lessItems=i.items):(this.spinner.hide("waiting"),"locked"===i.message?this.toastr.warning("Item is locked by "+i.user):this.toastr.error(i.message))}).catch(i=>{this.toastr.error(i),this.spinner.hide()})}showLocationsQuantityNew(e,o){if(e.selling_units)this.itemToViewLocations=e,this.overlay.toggle(o);else{this.loaderToShow=e.id,this.loading2=!0;let i=this.allStock.find(s=>s.id===e.id);this.itemToViewLocations=i;const a={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(a).then(s=>{"error"!=s.status?"error2"!=s.status?(i.selling_units=s.selling_units,i.locations_qty=s.locations_qty,i.total_qty=s.total_qty,i.locations=s.locations,this.overlay.toggle(o),this.loading2=!1,this.loaderToShow=""):(this.loaderToShow="",this.loading2=!1,this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loaderToShow="",this.loading2=!1,this.toastr.error(s.message))}).catch(s=>{this.toastr.error(s),this.loaderToShow="",this.loading2=!1})}}showLocationsQuantityOrdered(e,o,i){this.loaderToShow=e.id,this.itemToViewLocations=e;const a={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(a).then(s=>{if("error"!=s.status)if("error2"!=s.status){e.selling_units=s.selling_units,e.locations_qty=s.locations_qty;let p=e.locations_qty.find(g=>g.location.id==o.location.id);p&&(p.location_quantity=o.qty_ordered),e.locations=s.locations,this.itemToViewLocations=e,this.overlay1.toggle(i),this.loaderToShow=""}else this.loaderToShow="",this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.loaderToShow="",this.toastr.error(s.message)}).catch(s=>{this.toastr.error(s),this.loaderToShow=""})}getLocationUnitQuantityOrdered(e,o){const i={};return(o=o.sort((a,s)=>s.unit_quantity-a.unit_quantity)).forEach(a=>{if(e>0){const s=Math.floor(e/a.unit_quantity);i[a.unit_name]=s,e-=s*a.unit_quantity}else i[a.unit_name]=0}),i}getReprintData(){this.spinner.show();const e={action:this.cryptoSrv.encodeEncryptText("get-user-reprint-transfer-transactions"),uid:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.reprintItems=o.transactions,this.spinner.hide(),this.reprintItems.forEach(i=>{i.transaction_code=this.cryptoSrv.decryptEncodedText(i.transaction_code)}),this.showReprintForm=!0,this.loading=!1):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide()})}selectReceipt(e,o){this.transactionToView=e,this.spinner.show("reprint");const i={code:this.cryptoSrv.encodeEncryptText(this.transactionToView.transaction_code),uid:this.authSrv.getUserDetailToken("uid")};o?(this.selectedCustomer={id:e.customer.id,name:e.customer.name,sales_limit:0,mobile_number:0,balance:0,pending_transactions:[]},i.action=this.cryptoSrv.encodeEncryptText("get-user-transfer-reprint-items")):i.action=this.cryptoSrv.encodeEncryptText("get-transfer-transaction-code-items"),this.apiSrv.read(i).then(a=>{"error"!=a.status?"error2"!=a.status?(this.spinner.hide("reprint"),o?(this.shopDetail=a.Shop,this.cartItems=a.items,this.totalCartAmount=0,this.cartItems.forEach(s=>{this.totalCartAmount+=s.sp*s.qty}),this.printTestWaitingCustomer()):(this.transactionToView.items=a.items,this.displayItemsDialog=!0),this.loading=!1):(this.spinner.hide("reprint"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("reprint"),this.toastr.error(a.message))}).catch(a=>{this.toastr.error(a),this.spinner.hide("reprint")})}createPrintDataWaiting(){this.shopDetail.name=this.cryptoSrv.decryptEncodedText(this.shopDetail.name),this.shopDetail.tcode=this.cryptoSrv.decryptEncodedText(this.shopDetail.tcode),this.shopDetail.username=this.cryptoSrv.decryptEncodedText(this.shopDetail.username),this.shopDetail.location=this.cryptoSrv.decryptEncodedText(this.shopDetail.location),this.shopDetail.description=this.cryptoSrv.decryptEncodedText(this.shopDetail.description),this.shopDetail.contacts.forEach(c=>{c=this.cryptoSrv.decryptEncodedText(c)}),this.shopDetail.receipt_options.till=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.till),this.shopDetail.receipt_options.paybill=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.paybill),this.shopDetail.receipt_options.paybill_account=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.paybill_account),this.shopDetail.receipt_options.mpesa_business_name=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.mpesa_business_name),this.shopDetail.receipt_options.footer_message=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.footer_message);var e="";e+="\x1b!\0";let i=0,a=0,s=0;this.cartItems.forEach(c=>{const u=c.unit.unit_name.length+c.unit.unit_quantity.toString().length;i=Math.max(i,u);const y=c.qty.toString().length;a=Math.max(a,y);const m=c.sp.toString().length;s=Math.max(s,m)});const p="UNIT",Z="@PRICE",Se=a-"QTY".length+6,ye=s-Z.length+3,ve=p+" ".repeat(i-p.length+5)+"QTY"+" ".repeat(Se)+Z+" ".repeat(ye)+"TOTAL";e+="\x1bE\r",e+="-----------------------------------------------\n",e+=ve+"\n",e+="-----------------------------------------------\n\n",e+="\x1bE\n",this.cartItems.forEach(c=>{e+=c.item.name+"  -  "+c.location.name+"\n";const P=(0,v._)(c.unit.unit_name)+"("+(0,_.uf)(c.unit.unit_quantity,this.locale,".0")+")   x",R=(0,_.uf)(c.qty,this.locale,".0"),O=(0,_.uf)(c.sp,this.locale,".2"),Ae=(0,_.uf)(parseFloat(c.sp.toString())*parseFloat(c.qty.toString()),this.locale,".2"),qe=a-R.length+6,we=s-O.length+3;e+=P+" ".repeat(i-P.length+5)+R+" ".repeat(qe)+O+" ".repeat(we)+Ae+"\n",e+="\n\n",e+="\x1ba0"});var d="";d+="\x1bE\r",""!==this.shopDetail.receipt_options.till&&(d+="LIPA NA MPESA TILL NUMBER: "+this.shopDetail.receipt_options.till+"\n",""===this.shopDetail.receipt_options.paybill&&(d+="\n")),""!==this.shopDetail.receipt_options.paybill&&(""!==this.shopDetail.receipt_options.till&&(d+="\n"),d+="M-PESA PAYBILL NUMBER: "+this.shopDetail.receipt_options.paybill+"\n",d+="PAYBILL ACCOUNT: "+this.shopDetail.receipt_options.paybill_account+"\n",d+="\n"),(""!==this.shopDetail.receipt_options.paybill||""!==this.shopDetail.receipt_options.till)&&(d+="\x1bE\n",d+="M-PESA BUSINESS NAME: "+this.shopDetail.receipt_options.mpesa_business_name+"\n",d+="\n"),new Date;var Ze=new _.uU("en-US");const Ce=Date.now(),J=Ze.transform(Ce,"medium"),F=this.shopDetail.name.toUpperCase();this.receiptCustomer=(0,v._)(this.selectedCustomer.name);var S=function(c){return String.fromCharCode(c)},Q="\x1dh"+S(70)+"\x1df"+S(0)+"\x1dk"+S(69)+S(this.shopDetail.tcode.length)+this.shopDetail.tcode+S(0);if(""!==this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.image_url)){const c=(0,_.uf)(this.totalCartAmount,this.locale,".2");let u="";return this.shopDetail.contacts.forEach(m=>{u+=this.cryptoSrv.decryptEncodedText(m)+", "}),["\x1b@","\x1ba1","\x1d!\x10","\x1bE\r","\x1d!\x10",F+"\n","\n",{type:"raw",format:"image",flavor:"file",data:this.shopLogoUrl+this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.image_url),options:{language:"ESCPOS",dotDensity:"single"}},"\x1bE\n","\x1d!\0","\x1d!\0","\n",this.shopDetail.description+"\n",this.shopDetail.location+"\n","FOR ENQUIRIES CALL: "+u+"\n","\n","\x1ba0","\x1bE\r","TRANSFER ORDER FOR; "+this.receiptCustomer+"\n","\x1bE\n","\n",e+"\n","-----------------------------------------------\n","\x1bE\r","\x1d!\x10","TOTAL     "+c,"\n","\x1bE\n","\x1d!\0","-----------------------------------------------\n","\x1ba1",this.showReprintForm?"":Q,d,"\x1bE\r",this.shopDetail.receipt_options.footer_message+"\n","\x1bE\n","** THANK YOU AND WELCOME AGAIN **\n","RECEIPT # "+this.shopDetail.tcode+"  "+J+"\n\n","Served by "+(0,v._)(this.shopDetail.username),"\n","\n\n\n\n\n\n\n","\x1dV\0"]}{const c=(0,_.uf)(this.totalCartAmount,this.locale,".2");let u="";return this.shopDetail.contacts.forEach(m=>{u+=this.cryptoSrv.decryptEncodedText(m)+", "}),["\x1b@","\x1ba1","\x1d!\x10","\x1bE\r",F+"\n","\x1bE\n","\x1d!\0","\x1d!\0","\n",this.shopDetail.description+"\n",this.shopDetail.location+"\n","FOR ENQUIRIES CALL: "+u+"\n","\n","\x1ba0","\x1bE\r","TRANSFER ORDER FOR; "+this.receiptCustomer+"\n","\x1bE\n","\n",e+"\n","-----------------------------------------------\n","\x1bE\r","\x1d!\x10","TOTAL     "+c,"\n","\x1bE\n","\x1d!\0","-----------------------------------------------\n","\x1ba1",this.showReprintForm?"":Q,d,"\x1bE\r",this.shopDetail.receipt_options.footer_message+"\n","\x1bE\n","** THANK YOU AND WELCOME AGAIN **\n","RECEIPT # "+this.shopDetail.tcode+"  "+J+"\n\n","Served by "+(0,v._)(this.shopDetail.username),"\n","\n\n\n\n\n\n\n","\x1dV\0"]}}printTestWaitingCustomer(){this.printSrv.printtest2(this.createPrintDataWaiting()),this.displayItemsDialog||this.showReprintForm?this.displayItemsDialog=!1:(setTimeout(()=>{this.ngOnInit()},1700),this.toastr.success("Sale completed!"))}getImageWaitingCustomer(e){this.getBase64ImageFromURL(e).subscribe(o=>{this.base64TrimmedURL=o,this.printSrv.printtest2(this.createPrintDataWaiting()),setTimeout(()=>{this.ngOnInit()},1700),this.toastr.success("Sale completed!")})}getBase64ImageFromURL(e){return Y.y.create(o=>{let i=new Image;i.crossOrigin="Anonymous",i.src=e,i.complete?(o.next(this.getBase64Image(i)),o.complete()):(i.onload=()=>{o.next(this.getBase64Image(i)),o.complete()},i.onerror=a=>{o.error(a)})})}getBase64Image(e){var o=document.createElement("canvas");o.width=e.width,o.height=e.height,o.getContext("2d").drawImage(e,-5,0);let a=o.toDataURL("image/png");return this.base64DefaultURL=a,a.replace(/^data:image\/(png|jpg);base64,/,"")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(U.t2),t.Y36(B.$),t.Y36(H._W),t.Y36(G.e),t.Y36(K.s),t.Y36(_.JJ),t.Y36(C.YP),t.Y36(j.$),t.Y36(t.soG))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-transfer-sale"]],viewQuery:function(e,o){if(1&e&&(t.Gf(st,5),t.Gf(rt,5),t.Gf(lt,5)),2&e){let i;t.iGM(i=t.CRH())&&(o.table=i.first),t.iGM(i=t.CRH())&&(o.overlay=i.first),t.iGM(i=t.CRH())&&(o.overlay1=i.first)}},decls:25,vars:35,consts:[["class","row",4,"ngIf"],["appendTo","body","modal","true",3,"header","closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],["appendTo","body","modal","true","header","",3,"closable","visible","baseZIndex","visibleChange","onHide"],["styleClass","p-datatable-customers","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","filterDelay","globalFilterFields",4,"ngIf"],["bdOpacity","#fff","name","reprint","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[2,"color","#02926e"],["appendTo","body","modal","true",3,"header","closable","visible","baseZIndex","visibleChange","onHide"],[1,"row"],[1,"col-md-12","text-right"],["label","Reprint","icon","pi pi-print","iconPos","right","styleClass","p-button-sm p-button-help",3,"click"],[1,"col-md-12"],["appendTo","body","modal","true","header","Items with less quantity available",3,"closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],[3,"showCloseIcon"],["op1",""],["pTemplate",""],["op",""],["header","Confirm","icon","pi pi-exclamation-triangle","appendTo","body",3,"baseZIndex"],["bdOpacity","#fff","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[1,"col-md-3"],[1,"col-md-6"],[1,"card"],[1,"card-header"],[1,"card-title","mb-4"],["label","Reprint a receipt","icon","fas fa-print","styleClass","p-button-sm p-button-outlined p-button-help float-right",3,"click"],[1,"card-body","p-0","m-0"],["styleClass","p-datatable-customers","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","filterDelay","globalFilterFields"],["dt22",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"ui-selectable-row"],[2,"width","15rem"],["colspan","2"],["pInputText","","type","text","placeholder","Search...",1,"ui-column-filter",3,"input"],[2,"word-wrap","normal"],[2,"white-space","nowrap"],["label","Sell to customer","icon","pi pi-arrow-right","iconPos","right","styleClass","p-button-sm p-button-primary mr-5 float-right",3,"click"],["colspan","3",2,"text-align","center"],["appendTo","body","modal","true",3,"header","closable","visible","baseZIndex","visibleChange"],["dt1",""],["dt82",""],["class","row py-3",4,"ngIf"],["type","button","pButton","","icon","pi pi-times","label","Close",1,"p-button-danger","p-button-sm","float-right",3,"click"],["bdOpacity","#fff","bdColor","rgba(255,255,255,0.76)","size","medium","name","waiting","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["pSortableColumn","name",2,"width","15rem"],["field","name"],["pSortableColumn","category.name",2,"width","15rem"],["field","category.name"],[2,"width","10rem"],[2,"width","20rem"],["pInputText","","type","text","placeholder","Search item name",1,"ui-column-filter",3,"input"],["appendTo","body","placeholder","All","styleClass","ui-column-filter","optionLabel","name",3,"options","onChange"],["pTemplate","item"],[1,"ui-multiselect-representative-option",2,"display","grid"],[3,"click",4,"ngIf"],["class","animate-flicker warning",4,"ngIf"],["label","Select","icon","pi pi-arrow-right","iconPos","right","styleClass","p-button-primary p-button-outlined p-button-sm",3,"loading","onClick",4,"ngIf"],["severity","warn","text","Missing units","styleClass","mr-2",4,"ngIf"],[3,"click"],["label","","shape","circle",3,"style",4,"ngFor","ngForOf"],["label","","shape","circle"],[1,"animate-flicker","warning"],["label","Select","icon","pi pi-arrow-right","iconPos","right","styleClass","p-button-primary p-button-outlined p-button-sm",3,"loading","onClick"],["severity","warn","text","Missing units","styleClass","mr-2"],["pSortableColumn","name",2,"width","10rem"],["shape","circle"],["label","","icon","pi pi-trash","iconPos","right","styleClass","p-button-danger p-button-outlined p-button-sm",3,"onClick"],[1,"row","py-3"],[1,"col-md-12","text-center"],[1,"card","bg-white","text-center"],[1,"card-content","text-center"],[1,"col-md-8","offset-md-2"],["class","col-md-12 pt-3",4,"ngIf"],[1,"col-md-12","py-3"],[1,"ui-fluid","px-2"],[1,"p-field"],[1,"field-radiobutton"],["name","receipt1","value","yes","inputId","receipt1",3,"ngModel","ngModelChange"],["for","receipt1"],["name","receipt2","value","no","inputId","receipt2",3,"ngModel","ngModelChange"],["for","receipt2"],[1,"col-md-12","pb-4"],["pButton","","type","button","icon","pi pi-check","label","Complete sale",1,"p-button-raised","p-button-success",3,"click"],[1,"col-md-12","pt-3"],["pay1",""],["name","city11","value","today","inputId","city11",3,"ngModel","ngModelChange"],["for","city11"],["class","field-radiobutton",4,"ngIf"],["appendTo","body","name","start_date","required","","readonlyInput","true",3,"ngModel","maxDate","touchUI","monthNavigator","ngModelChange",4,"ngIf"],["name","city22","value","notToday","inputId","city22",3,"ngModel","ngModelChange"],["for","city22"],["appendTo","body","name","start_date","required","","readonlyInput","true",3,"ngModel","maxDate","touchUI","monthNavigator","ngModelChange"],["autocomplete","off",3,"ngSubmit",4,"ngIf"],["bdOpacity","#fff","name","sell","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["autocomplete","off",3,"ngSubmit"],["form2","ngForm"],[1,"ui-fluid"],[1,"col-6"],[1,"p-field","pb-3"],["for","location"],["placeholder","Select location","name","location","appendTo","body","optionLabel","location.name","filter","true",3,"options","ngModel","onChange","ngModelChange"],["pTemplate","selectedItem"],["for","unit"],["placeholder","Select item unit","name","unit","appendTo","body","optionLabel","unit_name","filter","true",3,"options","disabled","ngModel","onChange","ngModelChange"],["class","col-6",4,"ngIf"],["for","unitq"],["id","unitq","name","unit_quantity","required","","type","number","pattern","[0-9]+","pInputNumber","",1,"form-control",3,"disabled","ngModel","input","ngModelChange"],["id","unitq-help","class","p-error block",4,"ngIf"],["type","button","pButton","","icon","pi pi-times","label","Cancel",1,"p-button-danger","p-button-sm","float-right",3,"click"],["type","submit","pButton","","icon","pi pi-check","label","Add to list",1,"p-button-success","p-button-sm","mr-3","float-right",3,"disabled"],[1,"ui-helper-clearfix"],["selectionMode","single","responsiveLayout","scroll",3,"value","paginator","rows"],["id","unitq-help",1,"p-error","block"],["dtr",""],["pSortableColumn","customer",2,"width","15rem"],[2,"width","25rem"],["colspan","7"],["label","Reprint","icon","pi pi-print","iconPos","right","styleClass","p-button-help p-button-outlined p-button-sm float-right ml-4",3,"onClick",4,"ngIf"],["label","Show items","icon","pi pi-list","iconPos","right","styleClass","p-button-info p-button-sm float-right",3,"onClick",4,"ngIf"],["label","Reprint","icon","pi pi-print","iconPos","right","styleClass","p-button-help p-button-outlined p-button-sm float-right ml-4",3,"onClick"],["label","Show items","icon","pi pi-list","iconPos","right","styleClass","p-button-info p-button-sm float-right",3,"onClick"],["dtr2",""],["colspan","6"],["appendTo","body","modal","true","header","Items with less quantity available",3,"closable","visible","baseZIndex","visibleChange"],[1,"col-12"],["dt12",""],[2,"width","5rem"],[4,"ngFor","ngForOf"],[1,"p-o","m-0"],[1,"small"]],template:function(e,o){1&e&&(t.YNc(0,ut,14,11,"div",0),t.YNc(1,Dt,29,32,"p-dialog",1),t.YNc(2,Pt,4,9,"p-dialog",1),t.TgZ(3,"p-dialog",2),t.NdJ("visibleChange",function(a){return o.showReprintForm=a})("onHide",function(){return o.showReprintForm=!1,o.ngOnInit()}),t.YNc(4,Gt,4,10,"p-table",3),t.TgZ(5,"ngx-spinner",4),t._UZ(6,"p",5),t.qZA()(),t.TgZ(7,"p-dialog",6),t.NdJ("visibleChange",function(a){return o.displayItemsDialog=a})("onHide",function(){return o.displayItemsDialog=!1}),t.TgZ(8,"div",7)(9,"h3",8)(10,"p-button",9),t.NdJ("click",function(){return o.selectReceipt(o.transactionToView,!0)}),t.qZA()(),t.TgZ(11,"div",10),t.YNc(12,Vt,4,10,"p-table",3),t.qZA()(),t.TgZ(13,"ngx-spinner",4),t._UZ(14,"p",5),t.qZA()(),t.YNc(15,ie,7,16,"p-dialog",11),t.TgZ(16,"p-overlayPanel",12,13),t.YNc(18,re,3,3,"ng-template",14),t.qZA(),t.TgZ(19,"p-overlayPanel",12,15),t.YNc(21,de,3,3,"ng-template",14),t.qZA(),t._UZ(22,"p-confirmDialog",16),t.TgZ(23,"ngx-spinner",17),t._UZ(24,"p",5),t.qZA()),2&e&&(t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf",o.displayCustomerDialog),t.xp6(1),t.Q6J("ngIf",o.displaySellDialog),t.xp6(1),t.Akn(t.DdM(30,ue)),t.Q6J("closable",!0)("visible",o.showReprintForm)("baseZIndex",1e4),t.xp6(1),t.Q6J("ngIf",o.showReprintForm),t.xp6(1),t.Q6J("fullScreen",!0),t.xp6(2),t.Akn(t.DdM(31,he)),t.Q6J("header",o.displayItemsDialog?o.transactionToView.transaction_code:"")("closable",!0)("visible",o.displayItemsDialog)("baseZIndex",1e4),t.xp6(5),t.Q6J("ngIf",o.displayItemsDialog),t.xp6(1),t.Q6J("fullScreen",!0),t.xp6(2),t.Q6J("ngIf",o.showQuantityError),t.xp6(1),t.Akn(t.DdM(32,N)),t.Q6J("@enter",void 0)("showCloseIcon",!1),t.xp6(3),t.Akn(t.DdM(33,N)),t.Q6J("showCloseIcon",!1),t.xp6(3),t.Akn(t.DdM(34,L)),t.Q6J("baseZIndex",1e4),t.xp6(1),t.Q6J("fullScreen",!0))},dependencies:[_.sg,_.O5,U.Ro,h._Y,h.Fj,h.wV,h.JJ,h.JL,h.Q7,h.c5,h.On,h.F,V.V,C.$_,C.jx,$.Q,I.Hq,I.zx,A.iA,A.lQ,A.fz,W.NU,z.o,X.Lt,tt.T,et.H,it.q,ot.q,nt.EU,at.f,_.JJ,_.rS,_.uU],styles:["label[_ngcontent-%COMP%]{text-transform:none}[_nghost-%COMP%]     p-colorpicker .p-colorpicker .p-colorpicker-preview{border-radius:30px}[_nghost-%COMP%]     p-dialog .p-dialog-header{border-radius:30px!important}[_nghost-%COMP%]     .p-dialog .p-dialog-footer{border-bottom-right-radius:30px}"],data:{animation:[(0,f.X$)("enter",[(0,f.eR)("void => *",[(0,f.oB)({opacity:0}),(0,f.jt)(1e3,(0,f.oB)({opacity:1}))])])]}}),n})(),data:{title:"Transfer sale"}}];let me=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[M.Bz.forChild(ge),M.Bz]}),n})();var fe=l(4397);let xe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[me,fe.U]}),n})()}}]);