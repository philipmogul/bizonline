"use strict";(self.webpackChunkmatngular=self.webpackChunkmatngular||[]).push([[27],{6027:(Wt,k,l)=>{l.r(k),l.d(k,{SupplierModule:()=>Kt}),l(3434);var A=l(7340),t=l(4650),b=l(8423),J=l(3166),E=l(7185),L=l(1927),V=l(1932),T=l(805);function j(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return i.displayNewItemDialog=!0,t.KtG(i.buttonClicked=!1)}),t.qZA()}}function R(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"tr",19)(1,"th"),t._uU(2,"Supplier name"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Pending invoices "),t.qZA(),t._UZ(5,"th",20),t.qZA(),t.TgZ(6,"tr")(7,"th")(8,"input",21),t.NdJ("input",function(i){t.CHM(e),t.oxw();const n=t.MAs(10);return t.KtG(n.filter(i.target.value,"supplier_name","contains"))}),t.qZA()(),t._UZ(9,"th")(10,"th"),t.qZA()}}function $(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,n=t.oxw(2);return t.KtG(n.showPending(i))}),t._UZ(1,"i",30),t._uU(2," Show pending invoices "),t.qZA()}}function z(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"tr",22)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"p-badge",23),t.qZA(),t.TgZ(6,"td")(7,"div",24)(8,"button",25),t._uU(9," Select an action "),t.qZA(),t.TgZ(10,"div",26),t.YNc(11,$,3,0,"button",27),t.TgZ(12,"button",28),t.NdJ("click",function(){const n=t.CHM(e).$implicit,a=t.oxw(2);return a.supplierToView=n,a.newInvoiceModel.name="",a.displayNewInvoiceDialog=!0,t.KtG(a.buttonClicked=!1)}),t._UZ(13,"i",29),t._uU(14," Add a new invoice "),t.qZA()()()()()}if(2&s){const e=d.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,6,e.supplier_name)," "),t.xp6(3),t.Tol(e.today_invoices.length>0?"animate-flicker":""),t.Q6J("value",e.today_invoices.length)("severity",e.today_invoices.length>0?"warning":""),t.xp6(6),t.Q6J("ngIf",e.today_invoices.length>0)}}const W=function(){return[10,25,50]},X=function(){return["name","description"]};function tt(s,d){if(1&s&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.TgZ(2,"div",8)(3,"div",9)(4,"div",10)(5,"h4",11),t._uU(6," Suppliers "),t.YNc(7,j,1,0,"button",12),t.qZA()(),t.TgZ(8,"div",13)(9,"p-table",14,15),t.YNc(11,R,11,0,"ng-template",16),t.YNc(12,z,15,8,"ng-template",17),t.qZA()()()()()),2&s){const e=t.oxw();t.xp6(3),t.Q6J("@enter",void 0),t.xp6(4),t.Q6J("ngIf",e.userCanAddSuppliers),t.xp6(2),t.Q6J("value",e.suppliers)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(10,W))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(11,X))}}const F=function(){return{width:"25vw"}};function et(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"p-dialog",31),t.NdJ("visibleChange",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.displayNewItemDialog=i)}),t.TgZ(1,"form",32,33),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addSupplier())}),t.TgZ(3,"div",6)(4,"div",34)(5,"div",35)(6,"div",36)(7,"label",37),t._uU(8,"Supplier name"),t.qZA(),t.TgZ(9,"input",38),t.NdJ("ngModelChange",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.newSupplierModel.name=i)}),t.qZA()()()()(),t.TgZ(10,"p-footer"),t._UZ(11,"button",39),t.TgZ(12,"button",40),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return i.displayNewItemDialog=!1,t.KtG(i.newSupplierModel={})}),t.qZA()()(),t.TgZ(13,"ngx-spinner",41),t._UZ(14,"p",4),t.qZA()()}if(2&s){const e=t.MAs(2),o=t.oxw();t.Akn(t.DdM(8,F)),t.Q6J("closable",!1)("visible",o.displayNewItemDialog)("baseZIndex",1e4),t.xp6(9),t.Q6J("ngModel",o.newSupplierModel.name),t.xp6(2),t.Q6J("disabled",!e.valid||o.countCharactersExcludingSpaces(o.newSupplierModel.name)<1||o.buttonClicked),t.xp6(2),t.Q6J("fullScreen",!1)}}const it=function(){return{width:"60vw"}};function ot(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"p-dialog",42),t.NdJ("visibleChange",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.displayPendingDialog=i)}),t.ALo(1,"titlecase"),t.TgZ(2,"app-pending-invoices",43),t.NdJ("status",function(){t.CHM(e);const i=t.oxw();return i.displayPendingDialog=!1,t.KtG(i.ngOnInit())}),t.qZA(),t.TgZ(3,"p-footer")(4,"button",44),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.hidePending())}),t.qZA()()()}if(2&s){const e=t.oxw();t.Akn(t.DdM(9,it)),t.MGl("header","Pending invoices for ",t.lcZ(1,7,e.supplierToView.supplier_name),""),t.Q6J("closable",!1)("visible",e.displayPendingDialog)("baseZIndex",1e4),t.xp6(2),t.Q6J("invoices",e.supplierToView.today_invoices)}}function nt(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"p-dialog",42),t.NdJ("visibleChange",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.displayNewInvoiceDialog=i)}),t.ALo(1,"titlecase"),t.TgZ(2,"form",32,33),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addInvoice())}),t.TgZ(4,"div",6)(5,"div",34)(6,"div",35)(7,"div",36)(8,"label",37),t._uU(9,"Invoice number / name"),t.qZA(),t.TgZ(10,"input",38),t.NdJ("ngModelChange",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.newInvoiceModel.name=i)}),t.qZA()()()()(),t.TgZ(11,"p-footer"),t._UZ(12,"button",39),t.TgZ(13,"button",40),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return i.displayNewInvoiceDialog=!1,t.KtG(i.newInvoiceModel={})}),t.qZA()()(),t.TgZ(14,"ngx-spinner",45),t._UZ(15,"p",4),t.qZA()()}if(2&s){const e=t.MAs(3),o=t.oxw();t.Akn(t.DdM(11,F)),t.MGl("header","New invoice for ",t.lcZ(1,9,o.supplierToView.supplier_name),""),t.Q6J("closable",!1)("visible",o.displayNewInvoiceDialog)("baseZIndex",1e4),t.xp6(10),t.Q6J("ngModel",o.newInvoiceModel.name),t.xp6(2),t.Q6J("disabled",!e.valid||o.countCharactersExcludingSpaces(o.newInvoiceModel.name)<1),t.xp6(2),t.Q6J("fullScreen",!1)}}const st=function(){return{width:"30vw"}};let B=(()=>{class s{constructor(e,o,i,n,a,r){this.spinner=e,this.cryptoSrv=o,this.toastr=i,this.authSrv=n,this.apiSrv=a,this.confirmationService=r,this.loading=!0,this.suppliers=[],this.displayNewItemDialog=!1,this.newSupplierModel={},this.displayPendingDialog=!1,this.displayNewInvoiceDialog=!1,this.newInvoiceModel={},this.buttonClicked=!1,this.userCanAddSuppliers=!1}ngOnInit(){"1"===this.cryptoSrv.decryptEncodedText(this.authSrv.getRoleToken("adding_suppliers"))&&(this.userCanAddSuppliers=!0),"1"===this.cryptoSrv.decryptEncodedText(this.authSrv.getRoleToken("adding_supplier_stock"))||"admin"===this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("role"))?this.getSuppliers():(this.toastr.error("You have no rights to access that page!"),this.authSrv.logout())}getSuppliers(){this.spinner.show();const e={action:this.cryptoSrv.encodeEncryptText("get-today-suppliers"),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.suppliers=o.suppliers,this.suppliers=this.suppliers.sort((i,n)=>n.today_invoices.length-i.today_invoices.length),this.spinner.hide(),this.loading=!1):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide()})}countCharactersExcludingSpaces(e){const i=e.match(/[A-Za-z0-9]/g);return i?i.length:0}addSupplier(){this.buttonClicked=!0,this.spinner.show("new");const e={action:this.cryptoSrv.encodeEncryptText("add_new_supplier"),added_by:this.authSrv.getUserDetailToken("uid"),name:this.cryptoSrv.encodeEncryptText(this.newSupplierModel.name.toString())};this.apiSrv.post(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.suppliers.push({id:o.id,supplier_name:this.newSupplierModel.name,today_invoices:[]}),this.displayNewItemDialog=!1,this.newSupplierModel={},this.toastr.success("Supplier record added!"),this.spinner.hide("new")):(this.spinner.hide("new"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("new"),this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide("new")})}addInvoice(){this.buttonClicked=!0,this.spinner.show("newinv");const e={action:this.cryptoSrv.encodeEncryptText("add_new_supplier_invoice"),supplier:this.supplierToView.id,name:this.cryptoSrv.encodeEncryptText(this.newInvoiceModel.name.toString()),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(e).then(o=>{if("error"!=o.status)if("error2"!=o.status){const i=new Date,n={id:o.id,invoice_no:this.newInvoiceModel.name,date_supplied:i,date_created:i,uid:this.authSrv.getUserDetailToken("uid"),created_by:this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("nm")),total:0,items:[]};this.supplierToView.today_invoices.push(n),this.displayNewItemDialog=!1,this.newSupplierModel={},this.toastr.success("Invoice number added!"),this.ngOnInit(),this.spinner.hide("newinv"),this.displayNewInvoiceDialog=!1}else this.spinner.hide("newinv"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.spinner.hide("newinv"),this.toastr.error(o.message)}).catch(o=>{this.toastr.error(o),this.spinner.hide("newinv")})}showPending(e){this.supplierToView=e,this.displayPendingDialog=!0}hidePending(){this.displayPendingDialog=!1,this.getSuppliers()}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(b.t2),t.Y36(J.$),t.Y36(E._W),t.Y36(L.e),t.Y36(V.s),t.Y36(T.YP))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-supplier"]],decls:7,vars:10,consts:[["class","row",4,"ngIf"],["appendTo","body","modal","true","header","New supplier",3,"closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],["appendTo","body","modal","true",3,"header","closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],["bdOpacity","#fff","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[2,"color","#02926e"],["header","Confirm","icon","pi pi-exclamation-triangle","appendTo","body",3,"baseZIndex","closable"],[1,"row"],[1,"col-md-3"],[1,"col-md-6"],[1,"card"],[1,"card-header"],[1,"card-title","mb-4"],["pButton","","type","button","icon","pi pi-plus","label","Add a new supplier","class","p-button-success p-button-sm float-right mb-2",3,"click",4,"ngIf"],[1,"card-body","p-0","m-0"],["styleClass","p-datatable-customers","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","filterDelay","globalFilterFields"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pButton","","type","button","icon","pi pi-plus","label","Add a new supplier",1,"p-button-success","p-button-sm","float-right","mb-2",3,"click"],[1,"ui-selectable-row"],[2,"width","20rem"],["pInputText","","type","text","placeholder","Search supplier",1,"ui-column-filter",3,"input"],[2,"word-wrap","normal"],["size","",3,"value","severity"],["ngbDropdown","","container","body","placement","bottom-start",1,"d-inline-block"],["type","button","pButton","","id","dropdownBasic1","ngbDropdownToggle","",1,"p-button-primary","p-button-outlined"],["ngbDropdownMenu","","aria-labelledby","dropdownBasic1"],["ngbDropdownItem","",3,"click",4,"ngIf"],["ngbDropdownItem","",3,"click"],[1,"pi","pi-plus","mr-2"],[1,"pi","pi-list","mr-2"],["appendTo","body","modal","true","header","New supplier",3,"closable","visible","baseZIndex","visibleChange"],["autocomplete","off",3,"ngSubmit"],["form2","ngForm"],[1,"col-md-12"],[1,"ui-fluid"],[1,"p-field","pb-3"],["for","firstname3"],["id","firstname3","name","name","required","","type","text","pInputText","",1,"form-control",3,"ngModel","ngModelChange"],["type","submit","pButton","","icon","pi pi-check","label","Save",1,"p-button-success","p-button-sm","float-right",3,"disabled"],["type","button","pButton","","icon","pi pi-times","label","Cancel",1,"p-button-danger","mr-3","p-button-sm","float-right",3,"click"],["bdOpacity","#fff","name","new","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["appendTo","body","modal","true",3,"header","closable","visible","baseZIndex","visibleChange"],[3,"invoices","status"],["type","button","pButton","","icon","pi pi-times","label","Close",1,"p-button-danger","p-button-sm","float-right",3,"click"],["bdOpacity","#fff","name","newinv","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"]],template:function(e,o){1&e&&(t.YNc(0,tt,13,12,"div",0),t.YNc(1,et,15,9,"p-dialog",1),t.YNc(2,ot,5,10,"p-dialog",2),t.YNc(3,nt,16,12,"p-dialog",2),t.TgZ(4,"ngx-spinner",3),t._UZ(5,"p",4),t.qZA(),t._UZ(6,"p-confirmDialog",5)),2&e&&(t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf",o.displayNewItemDialog),t.xp6(1),t.Q6J("ngIf",o.displayPendingDialog),t.xp6(1),t.Q6J("ngIf",o.displayNewInvoiceDialog),t.xp6(1),t.Q6J("fullScreen",!0),t.xp6(2),t.Akn(t.DdM(9,st)),t.Q6J("baseZIndex",1e4)("closable",!1))},styles:["label[_ngcontent-%COMP%]{text-transform:none}[_nghost-%COMP%]     p-colorpicker .p-colorpicker .p-colorpicker-preview{border-radius:30px}[_nghost-%COMP%]     p-dialog .p-dialog-header{border-radius:30px!important}[_nghost-%COMP%]     .p-dialog .p-dialog-footer{border-bottom-right-radius:30px}"],data:{animation:[(0,A.X$)("enter",[(0,A.eR)("void => *",[(0,A.oB)({opacity:0}),(0,A.jt)(1e3,(0,A.oB)({opacity:1}))])])]}}),s})();var dt=l(4397),Q=l(2318);const at=[{path:"",component:B,data:{title:"Supplier"}}];let lt=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[Q.Bz.forChild(at),Q.Bz]}),s})();var _=l(6895),w=l(2841),rt=l(2340),pt=l(9775),c=l(4006),Y=l(1493),C=l(5593),H=l(3087),O=l(1740),ct=l(666),g=l(9091),_t=l(2665),ut=l(613),ht=l(3942);function gt(s,d){1&s&&(t.TgZ(0,"tr",7)(1,"th",8),t._uU(2,"Invoice number"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Date created "),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Created by "),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Invoice amount "),t.qZA(),t._UZ(9,"th",9),t.qZA())}function mt(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,n=t.oxw();return t.KtG(n.showPending(i))}),t._UZ(1,"i",18),t._uU(2," Review invoice "),t.qZA()}}function vt(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"tr",10)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"titlecase"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td")(14,"div",11)(15,"button",12),t._uU(16," Select an action "),t.qZA(),t.TgZ(17,"div",13),t.YNc(18,mt,3,0,"button",14),t.TgZ(19,"button",15),t.NdJ("click",function(){const n=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.continueAddingInvoice(n))}),t._UZ(20,"i",16),t._uU(21," View invoice "),t.qZA(),t.TgZ(22,"button",15),t.NdJ("click",function(){const n=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.confirmDeleteInvoice(n))}),t._UZ(23,"i",17),t._uU(24," Delete invoice "),t.qZA()()()()()}if(2&s){const e=d.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,5,e.invoice_no)," "),t.xp6(3),t.hij(" ",t.lcZ(6,7,e.date_created)," "),t.xp6(3),t.hij(" ",t.lcZ(9,9,e.created_by)," "),t.xp6(3),t.hij(" ",t.xi3(12,11,e.total,".2")," "),t.xp6(7),t.Q6J("ngIf","1"==e.approved)}}function Tt(s,d){1&s&&(t.TgZ(0,"tr",7)(1,"th"),t._uU(2,"Item "),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Location "),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Unit "),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Qty "),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Price "),t.qZA(),t.TgZ(11,"th"),t._uU(12,"VAT "),t.qZA()())}function xt(s,d){if(1&s&&(t.TgZ(0,"tr",10)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"titlecase"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"number"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA()()),2&s){const e=d.$implicit;t.xp6(1),t.Jzz("padding: 0.1rem 1rem; color: '",e.location.color,"'"),t.xp6(1),t.hij(" ",t.lcZ(3,12,e.item.item_name)," "),t.xp6(2),t.Jzz("padding: 0.1rem 1rem; color: '",e.location.color,"'"),t.xp6(1),t.hij(" ",t.xi3(6,14,e.location,"fullDate")," "),t.xp6(3),t.hij(" ",t.lcZ(9,17,e.unit)," "),t.xp6(3),t.hij(" ",t.xi3(12,19,e.unit_qty,".2")," "),t.xp6(3),t.hij(" ",t.xi3(15,22,e.buying_price,".2")," "),t.xp6(3),t.hij(" ",t.xi3(18,25,e.vat.vat_percent,".2")," ")}}const ft=function(){return{width:"80vw"}},y=function(){return[10,25,50]},M=function(){return["name","description"]};function At(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"p-dialog",19),t.NdJ("visibleChange",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.displayReviewDialog=i)}),t.TgZ(1,"p-table",0,1),t.YNc(3,Tt,13,0,"ng-template",2),t.YNc(4,xt,19,28,"ng-template",3),t.qZA(),t.TgZ(5,"p-footer")(6,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.displayReviewDialog=!1)}),t.qZA()(),t.TgZ(7,"ngx-spinner",21),t._UZ(8,"p",6),t.qZA()()}if(2&s){const e=t.oxw();t.Akn(t.DdM(15,ft)),t.MGl("header","Items for invoice number ",e.invoiceToView.invoice_no,""),t.Q6J("closable",!1)("visible",e.displayReviewDialog)("baseZIndex",1e4),t.xp6(1),t.Q6J("value",e.invoiceToView.items)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(16,y))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(17,M)),t.xp6(6),t.Q6J("fullScreen",!1)}}function bt(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"tr",7)(1,"th"),t._uU(2,"Item"),t.qZA(),t._UZ(3,"th",9),t.qZA(),t.TgZ(4,"tr")(5,"th")(6,"input",35),t.NdJ("input",function(i){t.CHM(e),t.oxw();const n=t.MAs(8);return t.KtG(n.filter(i.target.value,"name","contains"))}),t.qZA()(),t._UZ(7,"th"),t.qZA()}}function yt(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"p-button",38),t.NdJ("onClick",function(){t.CHM(e);const i=t.oxw().$implicit,n=t.oxw(3);return t.KtG(n.showItemAddDialog(i))}),t.qZA()}if(2&s){const e=t.oxw().$implicit,o=t.oxw(3);t.Q6J("loading",null!=o.itemToViewLocations&&o.itemToViewLocations.id===e.id&&o.loading2)}}function Mt(s,d){if(1&s&&t._UZ(0,"p-message",39),2&s){const e=t.oxw().$implicit;t.Q6J("text",0==e.min_unit_ok?"Missing units":"No stock")}}function Zt(s,d){if(1&s&&(t.TgZ(0,"tr",10)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t.YNc(5,yt,1,1,"p-button",36),t.YNc(6,Mt,1,1,"p-message",37),t.qZA()()),2&s){const e=d.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,3,e.name)," "),t.xp6(3),t.Q6J("ngIf",e.locations_count>0&&e.units>0&&1==e.min_unit_ok),t.xp6(1),t.Q6J("ngIf",e.units<1||e.locations_count<1||0==e.min_unit_ok)}}function wt(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"tr",7)(1,"th"),t._uU(2,"Item"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Location "),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Unit "),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Qty "),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Price "),t.qZA(),t.TgZ(11,"th"),t._uU(12,"VAT "),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Total "),t.qZA(),t._UZ(15,"th",9),t.qZA(),t.TgZ(16,"tr")(17,"th",40)(18,"input",35),t.NdJ("input",function(i){t.CHM(e),t.oxw();const n=t.MAs(18);return t.KtG(n.filter(i.target.value,"item.name","contains"))}),t.qZA()()()}}function Ct(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"tr",10)(1,"td"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"titlecase"),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"titlecase"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"number"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"number"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"number"),t.qZA(),t.TgZ(22,"td")(23,"button",41),t.NdJ("click",function(){const n=t.CHM(e).$implicit,a=t.oxw(3);return t.KtG(a.confirmDelete(n))}),t.qZA()()()}if(2&s){const e=d.$implicit;t.Udp("color",e.location.color),t.xp6(2),t.hij(" ",t.lcZ(3,9,e.item.name)," "),t.xp6(3),t.hij(" ",t.lcZ(6,11,e.location.name)," "),t.xp6(3),t.hij(" ",t.lcZ(9,13,e.unit.unit_name)," "),t.xp6(3),t.hij(" ",t.xi3(12,15,e.unit_qty,".2")," "),t.xp6(3),t.hij(" ",t.xi3(15,18,e.buying_price,".2")," "),t.xp6(3),t.hij(" ",t.lcZ(18,21,e.vat.vat_percent)," "),t.xp6(3),t.hij(" ",t.xi3(21,23,e.buying_price*e.unit_qty,".2")," ")}}function St(s,d){if(1&s&&(t.TgZ(0,"div",42)(1,"div",43)(2,"div",44)(3,"div",45)(4,"div",46)(5,"div",47)(6,"div",48)(7,"p",49),t._uU(8,"Goods amount"),t.qZA(),t.TgZ(9,"h5",50),t._uU(10),t.ALo(11,"number"),t.qZA()()()()()()(),t.TgZ(12,"div",43)(13,"div",44)(14,"div",45)(15,"div",46)(16,"div",47)(17,"div",48)(18,"p",49),t._uU(19,"VAT amount"),t.qZA(),t.TgZ(20,"h5",50),t._uU(21),t.ALo(22,"number"),t.qZA()()()()()()(),t.TgZ(23,"div",43)(24,"div",44)(25,"div",45)(26,"div",46)(27,"div",47)(28,"div",48)(29,"p",49),t._uU(30,"Total invoice amount"),t.qZA(),t.TgZ(31,"h5",50),t._uU(32),t.ALo(33,"number"),t.qZA()()()()()()()()),2&s){const e=t.oxw(3);t.xp6(10),t.hij("Ksh ",t.xi3(11,3,e.invoiceToView.total-e.totalInvoiceVAT,".2"),""),t.xp6(11),t.hij("Ksh ",t.xi3(22,6,e.totalInvoiceVAT,".2"),""),t.xp6(11),t.hij("Ksh ",t.xi3(33,9,e.invoiceToView.total,".2"),"")}}function It(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div",51)(1,"div",52)(2,"div",53)(3,"div",54)(4,"p-radioButton",55),t.NdJ("ngModelChange",function(i){t.CHM(e);const n=t.oxw(3);return t.KtG(n.printReceipt=i)}),t.qZA(),t.TgZ(5,"label",56),t._uU(6,"Print receipt"),t.qZA()(),t.TgZ(7,"div",54)(8,"p-radioButton",57),t.NdJ("ngModelChange",function(i){t.CHM(e);const n=t.oxw(3);return t.KtG(n.printReceipt=i)}),t.qZA(),t.TgZ(9,"label",58),t._uU(10,"No receipt"),t.qZA()()()(),t.TgZ(11,"div",59)(12,"button",60),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.confirmApproval())}),t.qZA()()()}if(2&s){const e=t.oxw(3);t.xp6(4),t.Q6J("ngModel",e.printReceipt),t.xp6(4),t.Q6J("ngModel",e.printReceipt),t.xp6(4),t.Q6J("disabled",e.buttonClicked)}}function qt(s,d){if(1&s&&(t.TgZ(0,"div",24)(1,"div",25)(2,"div",26)(3,"div",27)(4,"h4",28),t._uU(5," Select stock item to add "),t.qZA()(),t.TgZ(6,"div",29)(7,"p-table",0,1),t.YNc(9,bt,8,0,"ng-template",2),t.YNc(10,Zt,7,5,"ng-template",3),t.qZA()()()(),t.TgZ(11,"div",30)(12,"div",26)(13,"div",27)(14,"h4",28),t._uU(15," Invoice items "),t.qZA()(),t.TgZ(16,"div",29)(17,"p-table",0,31),t.YNc(19,wt,19,0,"ng-template",2),t.YNc(20,Ct,24,26,"ng-template",3),t.qZA(),t.YNc(21,St,34,12,"div",32),t.YNc(22,It,13,3,"div",33),t.qZA(),t.TgZ(23,"ngx-spinner",34),t._UZ(24,"p",6),t.qZA()()()()),2&s){const e=t.oxw(2);t.xp6(7),t.Q6J("value",e.allStock)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(19,y))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(20,M)),t.xp6(10),t.Q6J("value",e.invoiceToView.items)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(21,y))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(22,M)),t.xp6(4),t.Q6J("ngIf",e.invoiceToView.total>0),t.xp6(1),t.Q6J("ngIf",e.invoiceToView.total>0),t.xp6(1),t.Q6J("fullScreen",!1)}}function Dt(s,d){if(1&s&&t._UZ(0,"app-notification",61),2&s){const e=t.oxw(2);t.Q6J("message","Invoice approved successfully!")("showNotification",e.showNotification)}}const Pt=function(){return{width:"95vw"}};function Ut(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"p-dialog",19),t.NdJ("visibleChange",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.displayInvoiceApproveDialog=i)}),t.YNc(1,qt,25,23,"div",22),t.YNc(2,Dt,1,2,"app-notification",23),t.TgZ(3,"p-footer")(4,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.displayInvoiceApproveDialog=!1)}),t.qZA()()()}if(2&s){const e=t.oxw();t.Akn(t.DdM(8,Pt)),t.Q6J("header",e.showNotification1?"":"Add items for invoice number "+e.invoiceToView.invoice_no)("closable",!1)("visible",e.displayInvoiceApproveDialog)("baseZIndex",1e4),t.xp6(1),t.Q6J("ngIf",!e.showNotification1),t.xp6(1),t.Q6J("ngIf",e.showNotification1)}}function Nt(s,d){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=d.$implicit;t.xp6(1),t.Oqu(e.name)}}function kt(s,d){if(1&s&&(t.TgZ(0,"div",89)(1,"div"),t._uU(2),t.qZA()()),2&s){const e=d.$implicit;t.xp6(2),t.Oqu(e.name)}}function Jt(s,d){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=d.$implicit;t.xp6(1),t.Oqu(e.unit_name)}}function Et(s,d){if(1&s&&(t.TgZ(0,"div",89)(1,"div"),t._uU(2),t.qZA()()),2&s){const e=d.$implicit;t.xp6(2),t.Oqu(e.unit_name)}}function Lt(s,d){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=d.$implicit;t.xp6(1),t.Oqu(e.vat_percent)}}function Vt(s,d){if(1&s&&(t.TgZ(0,"div",89)(1,"div"),t._uU(2),t.qZA()()),2&s){const e=d.$implicit;t.xp6(2),t.Oqu(e.vat_percent)}}function Ft(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"form",69,70),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addItemToInvoice())}),t.TgZ(2,"div",71)(3,"div",72)(4,"label",73),t._uU(5,"Location to add item"),t.qZA(),t._UZ(6,"br"),t.TgZ(7,"p-dropdown",74),t.NdJ("onChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.updateLocationSelected(i))})("ngModelChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.itemToAddModel.location=i)}),t.YNc(8,Nt,2,1,"ng-template",75),t.YNc(9,kt,3,1,"ng-template",76),t.qZA()(),t.TgZ(10,"div",72)(11,"label",77),t._uU(12,"Unit to add"),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"p-dropdown",78),t.NdJ("onChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.updateUnitSelected(i))})("ngModelChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.itemToAddModel.unit=i)}),t.YNc(15,Jt,2,1,"ng-template",75),t.YNc(16,Et,3,1,"ng-template",76),t.qZA()(),t.TgZ(17,"div",72)(18,"label",79),t._uU(19,"Unit quantity"),t.qZA(),t.TgZ(20,"input",80),t.NdJ("input",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.updatePriceWithVAT())})("ngModelChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.itemToAddModel.unit_quantity=i)}),t.qZA()(),t.TgZ(21,"div",72)(22,"label",81),t._uU(23,"Buying price per unit (VAT Exclusive)"),t.qZA(),t.TgZ(24,"input",82),t.NdJ("input",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.updatePriceWithVAT())})("ngModelChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.itemToAddModel.buying_price=i)}),t.qZA()(),t.TgZ(25,"div",72)(26,"label",83),t._uU(27,"VAT"),t.qZA(),t._UZ(28,"br"),t.TgZ(29,"p-dropdown",84),t.NdJ("onChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.updateVatSelected(i))})("ngModelChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.itemToAddModel.vat=i)}),t.YNc(30,Lt,2,1,"ng-template",75),t.YNc(31,Vt,3,1,"ng-template",76),t.qZA()(),t.TgZ(32,"div",72)(33,"label",81),t._uU(34,"Buying price per unit (VAT Inclusive)"),t.qZA(),t.TgZ(35,"input",85),t.NdJ("input",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.updatePriceWithVAT2())})("ngModelChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.itemToAddModel.total=i)}),t.qZA()(),t.TgZ(36,"div",72)(37,"label",86),t._uU(38,"Total buying price (VAT Inclusive)"),t.qZA(),t.TgZ(39,"input",87),t.NdJ("ngModelChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.totalBp=i)}),t.qZA()(),t.TgZ(40,"div",72)(41,"label",86),t._uU(42,"Total VAT AMOUNT"),t.qZA(),t.TgZ(43,"input",88),t.NdJ("ngModelChange",function(i){t.CHM(e);const n=t.oxw(2);return t.KtG(n.totalVAT=i)}),t.qZA()()()()}if(2&s){const e=t.oxw(2);t.xp6(7),t.Q6J("options",e.locations)("ngModel",e.itemToAddModel.location),t.xp6(7),t.Q6J("options",e.itemToAdd.selling_units)("disabled",null==e.itemToAddModel.location||!e.activateSellForm)("ngModel",e.itemToAddModel.unit),t.xp6(6),t.Q6J("disabled",null==e.itemToAddModel.unit||!e.activateSellForm)("ngModel",e.itemToAddModel.unit_quantity),t.xp6(4),t.Q6J("disabled",e.itemToAddModel.unit_quantity<1||!e.activateSellForm)("ngModel",e.itemToAddModel.buying_price),t.xp6(5),t.Q6J("options",e.vat_records)("disabled",0==e.itemToAddModel.buying_price||null==e.itemToAddModel.unit||e.itemToAddModel.unit_quantity<1||!e.activateSellForm)("ngModel",e.itemToAddModel.vat),t.xp6(6),t.Q6J("disabled",e.itemToAddModel.vat.vat_percent<=0||e.itemToAddModel.unit_quantity<1||!e.activateSellForm)("ngModel",e.itemToAddModel.total),t.xp6(4),t.Q6J("disabled",!0)("ngModel",e.totalBp),t.xp6(4),t.Q6J("disabled",!0)("ngModel",e.totalVAT)}}function Bt(s,d){if(1&s&&t._UZ(0,"app-notification",61),2&s){const e=t.oxw(2);t.Q6J("message","Item added to invoice!")("showNotification",e.showNotification)}}const Qt=function(){return{width:"50vw"}};function Yt(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"p-dialog",19),t.NdJ("visibleChange",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.displayItemFormDialog=i)}),t.TgZ(1,"div",62)(2,"div",63)(3,"div",26)(4,"div",27)(5,"h6",64),t._uU(6," Invoice details "),t.qZA()(),t.TgZ(7,"div",46),t.YNc(8,Ft,44,18,"form",65),t.YNc(9,Bt,1,2,"app-notification",23),t.qZA()()()(),t.TgZ(10,"p-footer")(11,"button",66),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return i.displayItemFormDialog=!1,t.KtG(i.itemToAddModel={})}),t.qZA(),t.TgZ(12,"button",67),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addItemToInvoice())}),t.qZA()(),t.TgZ(13,"ngx-spinner",68),t._UZ(14,"p",6),t.qZA()()}if(2&s){const e=t.oxw();t.Akn(t.DdM(11,Qt)),t.s9C("header",e.itemToAdd.name),t.Q6J("closable",!1)("visible",e.displayItemFormDialog)("baseZIndex",1e4),t.xp6(8),t.Q6J("ngIf",!e.showNotification),t.xp6(1),t.Q6J("ngIf",e.showNotification),t.xp6(2),t.Q6J("disabled",e.buttonClicked),t.xp6(1),t.Q6J("disabled",e.itemToAddModel.total<1||!e.activateSellForm||e.itemToAddModel.unit_quantity<1||e.buttonClicked),t.xp6(1),t.Q6J("fullScreen",!1)}}let Ht=(()=>{class s{constructor(e,o,i,n,a,r,m,x,S){this.spinner=e,this.cryptoSrv=o,this.toastr=i,this.authSrv=n,this.apiSrv=a,this._decimalPipe=r,this.printSrv=m,this.confirmationService=x,this.locale=S,this.status=new t.vpe,this.displayReviewDialog=!1,this.displayInvoiceApproveDialog=!1,this.allStock=[],this.categories=[],this.locations=[],this.vat_records=[],this.itemToAdd={},this.displayItemFormDialog=!1,this.itemToAddModel={},this.showNotification=!1,this.showNotification1=!1,this.activateSellForm=!1,this.totalBp="0",this.totalPrice=0,this.totalVAT="0",this.userIsAdmin=!1,this.buttonClicked=!1,this.totalInvoiceVAT=0,this.printReceipt="no",this.shopLogoUrl=rt.N.shopLogoUrls,this.loading2=!1,this.itemToViewLocations={}}ngOnInit(){"admin"===this.cryptoSrv.decryptEncodedText(this.authSrv.getUserDetailToken("role"))&&(this.userIsAdmin=!0)}showPending(e){this.invoiceToView=e,this.displayReviewDialog=!0}continueAddingInvoice(e){this.invoiceToView=e,this.showNotification1=!1,this.spinner.show();const o={action:this.cryptoSrv.encodeEncryptText("get-all-stock-new"),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(o).then(i=>{"error"!=i.status?"error2"!=i.status?(this.allStock=i.data.stock,this.categories=i.data.categories,this.vat_records=i.data.vat_records,this.locations=i.data.locations,this.allStock.forEach(n=>{parseInt(n.prices_ok.toString())>0?(n.prices_ok=!1,n.sp_units_ok=!1,n.attention=1):(n.prices_ok=!0,n.sp_units_ok=!0),parseInt(n.min_qty_ok.toString())<1||parseInt(n.min_qty_ok.toString())>1?(n.min_qty_ok=!1,n.min_unit_ok=!1,n.attention=1):(n.min_qty_ok=!0,n.min_unit_ok=!0),n.locations_count=parseInt(n.locations_count.toString()),n.category=this.categories.find(a=>a.id===n.category_id),n.vat=this.vat_records.find(a=>a.id===n.vat_id)}),this.totalInvoiceVAT=0,this.invoiceToView.items.forEach(n=>{const a=n.buying_price*n.unit_qty,r=n.buying_price*n.unit_qty/(parseFloat(n.vat.vat_percent)/100+1);this.totalInvoiceVAT+=a-r}),this.spinner.hide(),this.displayInvoiceApproveDialog=!0):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(i.message))}).catch(i=>{this.toastr.error(i),this.spinner.hide()})}showItemAddDialog(e){if(e.selling_units)this.buttonClicked=!0,this.showNotification=!1,this.itemToAdd=e,this.itemToAddModel.buying_price=e.buying_price,this.itemToAddModel.unit_quantity=0,this.itemToAddModel.vat=this.vat_records.find(o=>o.id===this.itemToAdd.vat.id),this.itemToAddModel.vat_id=this.itemToAddModel.vat.id,this.buttonClicked=!1,this.itemToAddModel.total=0,this.itemToAddModel.location_id=this.locations[0].id,this.itemToAddModel.location=this.locations[0],this.itemToAddModel.unit=null,this.checkLockStatus(),this.displayItemFormDialog=!0;else{this.loading2=!0;let o=this.allStock.find(n=>n.id===e.id);this.itemToViewLocations=o;const i={action:this.cryptoSrv.encodeEncryptText("get_item_all_locations_quantity"),item_id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.read(i).then(n=>{"error"!=n.status?"error2"!=n.status?(o.selling_units=n.selling_units,o.locations_qty=n.locations_qty,o.total_qty=n.total_qty,o.locations=n.locations,this.buttonClicked=!0,this.showNotification=!1,this.itemToAdd=e,this.itemToAddModel.buying_price=e.buying_price,this.itemToAddModel.unit_quantity=0,this.itemToAddModel.vat=this.vat_records.find(a=>a.id===this.itemToAdd.vat.id),this.itemToAddModel.vat_id=this.itemToAddModel.vat.id,this.buttonClicked=!1,this.itemToAddModel.total=0,this.itemToAddModel.location_id=this.locations[0].id,this.itemToAddModel.location=this.locations[0],this.itemToAddModel.unit=null,this.checkLockStatus(),this.loading2=!1,this.displayItemFormDialog=!0):(this.loading2=!1,this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.loading2=!1,this.toastr.error(n.message))}).catch(n=>{this.toastr.error(n),this.loading2=!1})}}updateLocationSelected(e){this.itemToAddModel.location_id=e.value.id,this.itemToAddModel.location=e.value,this.itemToAddModel.unit=null,this.checkLockStatus()}updateUnitSelected(e){this.itemToAddModel.vat=this.itemToAdd.vat,this.itemToAddModel.unit_id=e.value.id,this.itemToAddModel.unit=e.value;const i=this.itemToAdd.selling_units.find(n=>n.id==this.itemToAddModel.unit.id).recom_selling_price;this.itemToAddModel.selling_price=i,0==this.itemToAddModel.vat.vat_percent?(this.itemToAddModel.buying_price=this.itemToAddModel.unit.unit_quantity*this.itemToAdd.buying_price,this.itemToAddModel.buying_price=parseFloat(this.itemToAddModel.buying_price.toString()).toFixed()):(this.itemToAddModel.buying_price=this.itemToAddModel.unit.unit_quantity*this.itemToAdd.buying_price/(this.itemToAddModel.vat.vat_percent/100+1),this.itemToAddModel.buying_price=parseFloat(this.itemToAddModel.buying_price.toString()).toFixed(2)),this.updatePriceWithVAT()}checkLockStatus(){this.spinner.show("add");const e={action:this.cryptoSrv.encodeEncryptText("check-lock-status-new"),item_id:this.itemToAdd.id,location_id:this.itemToAddModel.location_id,uid:this.authSrv.getUserDetailToken("uid"),right:this.cryptoSrv.encodeEncryptText("add_supplier_stock")};this.apiSrv.read(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.activateSellForm=!0,this.spinner.hide("add")):(this.spinner.hide("add"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("add"),"locked"===o.message?(this.activateSellForm=!1,this.toastr.warning("Item is locked by "+o.user)):(this.activateSellForm=!1,this.toastr.error(o.message)))}).catch(o=>{this.toastr.error(o),this.spinner.hide("add")})}updateVatSelected(e){this.itemToAddModel.vat_id=e.value.id,this.itemToAddModel.vat=e.value,this.updatePriceWithVAT()}updateTotalBuyingPrice(){if(null!=this.itemToAddModel.vat&&this.itemToAddModel.buying_price>0&&this.itemToAddModel.unit_quantity>0&&null!=this.itemToAddModel.unit){const e=this.itemToAddModel.buying_price/this.itemToAddModel.unit.unit_quantity,o=this.itemToAddModel.unit_quantity*this.itemToAddModel.unit.unit_quantity,i=this.itemToAddModel.vat.vat_percent/100+1,n=(e*o*i).toFixed(2),a=(e*o).toFixed(2);this.itemToAddModel.price_with_vat=e*i,this.itemToAddModel.total=this.itemToAddModel.vat.vat_percent>0?n:a}else this.itemToAddModel.total=0}updatePriceWithVAT(){this.itemToAddModel.total=this.itemToAddModel.buying_price*(this.itemToAddModel.vat.vat_percent/100+1),this.itemToAddModel.total=parseFloat(this.itemToAddModel.total.toFixed(2)),this.itemToAddModel.buying_price_vat_per_piece=this.itemToAddModel.total/this.itemToAddModel.unit.unit_quantity,this.formatNumber()}updatePriceWithVAT2(){this.itemToAddModel.buying_price=parseFloat((this.itemToAddModel.total/(this.itemToAddModel.vat.vat_percent/100+1)).toFixed(2)),this.itemToAddModel.buying_price_vat_per_piece=this.itemToAddModel.total/this.itemToAddModel.unit.unit_quantity,this.formatNumber()}formatNumber(){this.totalBp=this._decimalPipe.transform(this.itemToAddModel.total*this.itemToAddModel.unit_quantity,"1.2-2"),this.totalPrice=this.itemToAddModel.total*this.itemToAddModel.unit_quantity,this.totalVAT=this._decimalPipe.transform((this.itemToAddModel.total-this.itemToAddModel.buying_price)*this.itemToAddModel.unit_quantity,"1.2-2")}confirmDelete(e){this.confirmationService.confirm({message:"Are you sure you want to delete this item?",acceptButtonStyleClass:"p-button-primary p-button-sm",rejectButtonStyleClass:"p-button-danger p-button-sm",acceptLabel:"Delete",rejectLabel:"Cancel",accept:()=>{this.deleteItem(e)},reject:()=>{}})}deleteItem(e){this.spinner.show("invoice_items");const o={action:this.cryptoSrv.encodeEncryptText("delete_invoice_item"),id:e.id,item_id:e.item.id,item_nm:this.cryptoSrv.encodeEncryptText(e.item.name),invoice:this.invoiceToView.id,invoiceno:this.cryptoSrv.encodeEncryptText(this.invoiceToView.invoice_no),unit:e.unit.id,unitnm:this.cryptoSrv.encodeEncryptText(e.unit.name),unit_qty:this.cryptoSrv.encodeEncryptText(e.unit_qty.toString()),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(o).then(i=>{if("error"!=i.status)if("error2"!=i.status){if(this.invoiceToView.items=this.invoiceToView.items.filter(n=>n.id!==e.id),this.invoiceToView.total=this.invoiceToView.total-e.buying_price*e.unit_qty,this.invoiceToView.total>0){const n=e.buying_price*e.unit_qty;parseFloat(e.vat.vat_percent);let r=100*n/(100+parseInt(e.vat.vat_percent));this.totalInvoiceVAT-=n-r}else this.totalInvoiceVAT=0;this.toastr.success("Item deleted!"),this.spinner.hide("invoice_items")}else this.spinner.hide("invoice_items"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout();else this.spinner.hide("invoice_items"),this.toastr.error(i.message)}).catch(i=>{this.toastr.error(i),this.spinner.hide("invoice_items")})}addItemToInvoice(){if(this.buttonClicked=!0,this.itemToAdd.buying_price!=this.itemToAddModel.buying_price_vat_per_piece)this.confirmBuyingPriceUpdate(this.itemToAdd.buying_price>this.itemToAddModel.buying_price_vat_per_piece?"lower":"higher");else{this.spinner.show("add");const e=this.itemToAddModel.unit.unit_quantity*this.itemToAddModel.unit_quantity,o=this.itemToAdd.buying_price,n=this.itemToAdd.selling_units.find(r=>r.id==this.itemToAddModel.unit.id).recom_selling_price,a={action:this.cryptoSrv.encodeEncryptText("add_invoice_item"),item_id:this.itemToAdd.id,item_nm:this.cryptoSrv.encodeEncryptText(this.itemToAdd.name),invoice:this.invoiceToView.id,invoiceno:this.cryptoSrv.encodeEncryptText(this.invoiceToView.invoice_no),unit:this.itemToAddModel.unit_id,unitnm:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.unit.unit_name),unit_qty:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.unit_quantity.toString()),total_qty:this.cryptoSrv.encodeEncryptText(e.toString()),old_bp:this.cryptoSrv.encodeEncryptText(o.toString()),old_sp:this.cryptoSrv.encodeEncryptText(n.toString()),buying_price:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.buying_price.toString()),buying_price_vat:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.buying_price_vat_per_piece.toString()),selling_price:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.selling_price.toString()),vat:this.itemToAddModel.vat_id,update_old_bp:this.cryptoSrv.encodeEncryptText("0"),location:this.itemToAddModel.location_id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(a).then(r=>{"error"!=r.status?"error2"!=r.status?(this.invoiceToView.items.push({id:r.id,item:this.itemToAdd,location:this.itemToAddModel.location,unit:this.itemToAddModel.unit,unit_qty:this.itemToAddModel.unit_quantity,total_old_qty:0,old_bp:o,buying_price:this.itemToAddModel.buying_price_vat_per_piece*this.itemToAddModel.unit.unit_quantity,selling_price:this.itemToAddModel.selling_price,vat:this.itemToAddModel.vat}),this.invoiceToView.total+=this.itemToAddModel.buying_price_vat_per_piece*(this.itemToAddModel.unit.unit_quantity*this.itemToAddModel.unit_quantity),this.totalInvoiceVAT+=this.totalPrice-100*this.totalPrice/(100+parseInt(this.itemToAddModel.vat.vat_percent)),this.showNotification=!0,setTimeout(()=>{this.displayItemFormDialog=!1,this.buttonClicked=!1},1700),this.spinner.hide("add"),this.itemToAddModel={},this.itemToAdd={}):(this.spinner.hide("add"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("add"),this.toastr.error(r.message))}).catch(r=>{this.toastr.error(r),this.spinner.hide("add")})}}confirmBuyingPriceUpdate(e){this.confirmationService.confirm({message:"The buying price is "+e+" than the previous buying price. Do you want to apply the new buying price to both the old and new stock?",acceptButtonStyleClass:"p-button-primary p-button-sm",rejectButtonStyleClass:"p-button-danger p-button-sm",acceptLabel:"Yes",rejectLabel:"No",accept:()=>{this.itemToAddModel.update_old_bp=1,this.addItemToInvoice2()},reject:()=>{this.itemToAddModel.update_old_bp=0,this.addItemToInvoice2()}})}addItemToInvoice2(){this.buttonClicked=!0,this.spinner.show("add");const e=this.itemToAddModel.unit.unit_quantity*this.itemToAddModel.unit_quantity,o=this.itemToAdd.buying_price*this.itemToAddModel.unit_quantity,n=this.itemToAdd.selling_units.find(r=>r.id==this.itemToAddModel.unit.id).recom_selling_price,a={action:this.cryptoSrv.encodeEncryptText("add_invoice_item"),item_id:this.itemToAdd.id,item_nm:this.cryptoSrv.encodeEncryptText(this.itemToAdd.name),invoice:this.invoiceToView.id,invoiceno:this.cryptoSrv.encodeEncryptText(this.invoiceToView.invoice_no),unit:this.itemToAddModel.unit_id,unitnm:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.unit.unit_name),unit_qty:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.unit_quantity.toString()),total_qty:this.cryptoSrv.encodeEncryptText(e.toString()),old_bp:this.cryptoSrv.encodeEncryptText(o.toString()),old_sp:this.cryptoSrv.encodeEncryptText(n.toString()),buying_price:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.buying_price.toString()),buying_price_vat:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.buying_price_vat_per_piece.toString()),selling_price:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.selling_price.toString()),vat:this.itemToAddModel.vat_id,update_old_bp:this.cryptoSrv.encodeEncryptText(this.itemToAddModel.update_old_bp.toString()),location:this.itemToAddModel.location_id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(a).then(r=>{"error"!=r.status?"error2"!=r.status?(this.invoiceToView.items.push({id:r.id,item:this.itemToAdd,location:this.itemToAddModel.location,unit:this.itemToAddModel.unit,unit_qty:this.itemToAddModel.unit_quantity,total_old_qty:0,old_bp:o,buying_price:this.itemToAddModel.buying_price_vat_per_piece*this.itemToAddModel.unit.unit_quantity,selling_price:this.itemToAddModel.selling_price,vat:this.itemToAddModel.vat}),this.invoiceToView.total+=this.itemToAddModel.buying_price_vat_per_piece*(this.itemToAddModel.unit.unit_quantity*this.itemToAddModel.unit_quantity),this.totalInvoiceVAT+=this.totalPrice-100*this.totalPrice/(100+parseInt(this.itemToAddModel.vat.vat_percent)),this.showNotification=!0,setTimeout(()=>{this.displayItemFormDialog=!1},1700),this.spinner.hide("add"),this.itemToAddModel={},this.itemToAdd={},this.buttonClicked=!1):(this.spinner.hide("add"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("add"),this.toastr.error(r.message))}).catch(r=>{this.toastr.error(r),this.spinner.hide("add")})}confirmApproval(){this.buttonClicked=!0,this.confirmationService.confirm({message:"All items in this invoice will be added to stock. Do you want to complete this invoice approval?",acceptButtonStyleClass:"p-button-primary p-button-sm",rejectButtonStyleClass:"p-button-danger p-button-sm",acceptLabel:"Yes",rejectLabel:"No",accept:()=>{this.approveInvoice()},reject:()=>{this.buttonClicked=!1}})}approveInvoice(){this.spinner.show("invoice_items");const e={action:this.cryptoSrv.encodeEncryptText("approve_invoice"),invoice:this.invoiceToView.id,invoiceno:this.cryptoSrv.encodeEncryptText(this.invoiceToView.invoice_no),added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(e).then(o=>{"error"!=o.status?"error2"!=o.status?(this.showNotification1=!0,setTimeout(()=>{this.displayInvoiceApproveDialog=!1,this.invoices=this.invoices.filter(n=>n.id!=this.invoiceToView.id),"yes"===this.printReceipt&&(this.shopDetail=o.Shop,this.printSrv.printtest2(this.createPrintData())),this.invoices.length<1&&this.status.emit({status:!1})},1700),this.spinner.hide("invoice_items")):(this.spinner.hide("invoice_items"),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide("invoice_items"),this.toastr.error(o.message))}).catch(o=>{this.toastr.error(o),this.spinner.hide("invoice_items")})}confirmDeleteInvoice(e){this.confirmationService.confirm({message:"Are you sure you want to delete this invoice?",acceptButtonStyleClass:"p-button-primary p-button-sm",rejectButtonStyleClass:"p-button-danger p-button-sm",acceptLabel:"Delete",rejectLabel:"Cancel",accept:()=>{this.spinner.show();const o={action:this.cryptoSrv.encodeEncryptText("delete_invoice"),id:e.id,added_by:this.authSrv.getUserDetailToken("uid")};this.apiSrv.post(o).then(i=>{"error"!=i.status?"error2"!=i.status?(this.invoices=this.invoices.filter(n=>n.id!=e.id),this.toastr.success("Invoice deleted!"),this.spinner.hide()):(this.spinner.hide(),this.toastr.error("Please login again.","Login session expired!"),this.authSrv.logout()):(this.spinner.hide(),this.toastr.error(i.message))}).catch(i=>{this.toastr.error(i),this.spinner.hide("invoice_items")})},reject:()=>{}})}createPrintData(){this.shopDetail.name=this.cryptoSrv.decryptEncodedText(this.shopDetail.name),this.shopDetail.username=this.cryptoSrv.decryptEncodedText(this.shopDetail.username),this.shopDetail.location=this.cryptoSrv.decryptEncodedText(this.shopDetail.location),this.shopDetail.description=this.cryptoSrv.decryptEncodedText(this.shopDetail.description),this.shopDetail.contacts.forEach(p=>{p=this.cryptoSrv.decryptEncodedText(p)}),this.shopDetail.receipt_options.till=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.till),this.shopDetail.receipt_options.paybill=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.paybill),this.shopDetail.receipt_options.paybill_account=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.paybill_account),this.shopDetail.receipt_options.mpesa_business_name=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.mpesa_business_name),this.shopDetail.receipt_options.footer_message=this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.footer_message);var e="";e+="\x1b!\0";let i=0,n=0,a=0;this.invoiceToView.items.forEach(p=>{const h=p.unit.unit_name.length+p.unit.unit_quantity.toString().length;i=Math.max(i,h);const f=p.unit_qty.toString().length;n=Math.max(n,f);const Z=p.buying_price.toString().length;a=Math.max(a,Z)});const r="UNIT",x="@PRICE";let I=i-r.length+5,q=n-"QTY".length+6,D=a-x.length+3;I<1&&(I=5),q<1&&(q=6),D<1&&(D=3);const jt=r+" ".repeat(I)+"QTY"+" ".repeat(q)+x+" ".repeat(D)+"TOTAL";e+="\x1bE\r",e+="-----------------------------------------------\n",e+=jt+"\n",e+="-----------------------------------------------\n\n",e+="\x1bE\n",this.invoiceToView.items.forEach(p=>{e+=p.item.name+"  -  "+p.location.name+"\n";const h=p.buying_price,f=(0,w._)(p.unit.unit_name)+"("+(0,_.uf)(p.unit.unit_quantity,this.locale,".0")+")   x",v=(0,_.uf)(p.unit_qty,this.locale,".0"),Z=(0,_.uf)(parseFloat(h.toString()),this.locale,".2"),zt=(0,_.uf)(parseFloat(h.toString())*parseFloat(p.unit_qty.toString()),this.locale,".2");let P=i-f.length+5,U=n-v.length+6,N=a-Z.length+3;P<1&&(P=5),U<1&&(U=6),N<1&&(N=3),e+=f+" ".repeat(P)+v+" ".repeat(U)+Z+" ".repeat(N)+zt+"\n",e+="\n\n",e+="\x1ba0"}),new Date;var Rt=new _.uU("en-US");const $t=Date.now(),G=Rt.transform($t,"medium"),K=this.shopDetail.name.toUpperCase();if(""!==this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.image_url)){const p=(0,_.uf)(this.invoiceToView.total,this.locale,".2");let h="";return this.shopDetail.contacts.forEach(v=>{h+=this.cryptoSrv.decryptEncodedText(v)+", "}),["\x1b@","\x1ba1","\x1d!\x10","\x1bE\r","\x1d!\x10",K+"\n","\n",{type:"raw",format:"image",flavor:"file",data:this.shopLogoUrl+this.cryptoSrv.decryptEncodedText(this.shopDetail.receipt_options.image_url),options:{language:"ESCPOS",dotDensity:"single"}},"\x1bE\n","\x1d!\0","\x1d!\0","\n",this.shopDetail.description+"\n",this.shopDetail.location+"\n","FOR ENQUIRIES CALL: "+h+"\n","\n","\x1ba0","\x1bE\r","\n","ADDED STOCK FOR INV NO; "+this.invoiceToView.invoice_no+"\n","\x1bE\n","\n",e+"\n","-----------------------------------------------\n","\x1bE\r","\x1d!\x10","TOTAL     "+p,"\n","\x1d!\0","-----------------------------------------------\n","\x1ba1","\x1bE\n",this.shopDetail.receipt_options.footer_message+"\n","** THANK YOU AND WELCOME AGAIN **\n","RECEIPT # "+this.invoiceToView.invoice_no+"  "+G+"\n\n","Added by "+(0,w._)(this.shopDetail.username),"\n","\n\n\n\n\n\n\n","\x1dV\0"]}{const p=(0,_.uf)(this.invoiceToView.total,this.locale,".2");let h="";return this.shopDetail.contacts.forEach(v=>{h+=this.cryptoSrv.decryptEncodedText(v)+", "}),["\x1b@","\x1ba1","\x1d!\x10","\x1bE\r",K+"\n","\x1bE\n","\x1d!\0","\x1d!\0","\n",this.shopDetail.description+"\n",this.shopDetail.location+"\n","FOR ENQUIRIES CALL: "+h+"\n","\n","\x1ba0","\x1bE\r","ADDED STOCK FOR INV NO; "+this.invoiceToView.invoice_no+"\n","\x1bE\n","\n",e+"\n","-----------------------------------------------\n","\x1bE\r","\x1d!\x10","TOTAL     "+p,"\n","\x1bE\n","\x1d!\0","-----------------------------------------------\n","\x1ba1",this.shopDetail.receipt_options.footer_message+"\n","** THANK YOU AND WELCOME AGAIN **\n","RECEIPT # "+this.invoiceToView.invoice_no+"  "+G+"\n\n","Added by "+(0,w._)(this.shopDetail.username),"\n","\n\n\n\n\n\n\n","\x1dV\0"]}}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(b.t2),t.Y36(J.$),t.Y36(E._W),t.Y36(L.e),t.Y36(V.s),t.Y36(_.JJ),t.Y36(pt.$),t.Y36(T.YP),t.Y36(t.soG))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-pending-invoices"]],inputs:{invoices:"invoices"},outputs:{status:"status"},decls:9,vars:14,consts:[["styleClass","p-datatable-customers","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","filterDelay","globalFilterFields"],["dt",""],["pTemplate","header"],["pTemplate","body"],["appendTo","body","modal","true",3,"header","closable","visible","style","baseZIndex","visibleChange",4,"ngIf"],["bdOpacity","#fff","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],[2,"color","#02926e"],[1,"ui-selectable-row"],[2,"width","10rem"],[2,"width","12rem"],[2,"word-wrap","normal"],["ngbDropdown","","container","body","placement","bottom-start",1,"d-inline-block","custom-class"],["type","button","pButton","","id","dropdownBasic1","ngbDropdownToggle","",1,"p-button-primary","p-button-outlined"],["ngbDropdownMenu","","aria-labelledby","dropdownBasic1","container","body"],["ngbDropdownItem","",3,"click",4,"ngIf"],["ngbDropdownItem","",3,"click"],[1,"pi","pi-eye","mr-2"],[1,"pi","pi-trash","mr-2"],[1,"pi","pi-list","mr-2"],["appendTo","body","modal","true",3,"header","closable","visible","baseZIndex","visibleChange"],["type","button","pButton","","icon","pi pi-times","label","Close",1,"p-button-danger","p-button-sm","float-right",3,"click"],["bdOpacity","#fff","name","new","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["class","row",4,"ngIf"],[3,"message","showNotification",4,"ngIf"],[1,"row"],[1,"col-md-5"],[1,"card"],[1,"card-header"],[1,"card-title","mb-4"],[1,"card-body","p-0","m-0"],[1,"col-md-7"],["dt2",""],["class","row px-2",4,"ngIf"],["class","row mt-2",4,"ngIf"],["bdOpacity","#fff","name","invoice_items","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["pInputText","","type","text","placeholder","Search item name",1,"ui-column-filter",3,"input"],["label","Add quantity","icon","pi pi-plus","styleClass","p-button-success p-button-outlined p-button-sm",3,"loading","onClick",4,"ngIf"],["severity","warn","styleClass","mr-2",3,"text",4,"ngIf"],["label","Add quantity","icon","pi pi-plus","styleClass","p-button-success p-button-outlined p-button-sm",3,"loading","onClick"],["severity","warn","styleClass","mr-2",3,"text"],["colspan","8"],["pButton","","type","button","icon","pi pi-trash","label","Delete",1,"p-button-danger","p-button-outlined","p-button-sm",3,"click"],[1,"row","px-2"],[1,"col-4"],[1,"card","card-inverse","bg-secondary"],[1,"card-content"],[1,"card-body"],[1,"media"],[1,"media-body","text-center"],[2,"margin-bottom","0.99rem"],[1,"card-text"],[1,"row","mt-2"],[1,"col-md-12","flex","justify-content-center"],[1,"p-field"],[1,"field-radiobutton"],["name","receipt1","value","yes","inputId","receipt1",3,"ngModel","ngModelChange"],["for","receipt1"],["name","receipt2","value","no","inputId","receipt2",3,"ngModel","ngModelChange"],["for","receipt2"],[1,"col-md-12","text-center"],["pButton","","type","button","icon","pi pi-check","label","Approve invoice",1,"p-button-success","p-button-sm","mb-2",3,"disabled","click"],[3,"message","showNotification"],[1,"row",2,"background","#F7F7F8"],[1,"col-md-12"],[1,"card-title"],["autocomplete","off",3,"ngSubmit",4,"ngIf"],["type","button","pButton","","icon","pi pi-times","label","Cancel",1,"p-button-danger","p-button-sm","float-right","mt-2",3,"disabled","click"],["pButton","","icon","pi pi-check","label","Save",1,"p-button-success","p-button-sm","mr-3","float-right","mt-2",3,"disabled","click"],["bdOpacity","#fff","name","add","bdColor","rgba(255,255,255,0.76)","size","medium","color","#02926e","type","ball-clip-rotate",3,"fullScreen"],["autocomplete","off",3,"ngSubmit"],["form2","ngForm"],[1,"ui-fluid"],[1,"p-field","pb-3"],["for","location"],["placeholder","Select location","name","location","appendTo","body","optionLabel","name","filter","true",3,"options","ngModel","onChange","ngModelChange"],["pTemplate","selectedItem"],["pTemplate","item"],["for","unit"],["placeholder","Select item unit","name","unit","appendTo","body","optionLabel","unit_name","filter","true",3,"options","disabled","ngModel","onChange","ngModelChange"],["for","unitq"],["id","unitq","name","unit_quantity","pattern","[0-9]+","required","","type","number","pInputNumber","",1,"form-control",3,"disabled","ngModel","input","ngModelChange"],["for","bp"],["id","bp","name","buying_price","required","","type","number","pInputNumber","",1,"form-control",3,"disabled","ngModel","input","ngModelChange"],["for","vat"],["placeholder","Select VAT","name","vat","appendTo","body","optionLabel","vat_percent","filter","true",3,"options","disabled","ngModel","onChange","ngModelChange"],["id","bp","name","total","required","","type","number","pInputNumber","",1,"form-control",3,"disabled","ngModel","input","ngModelChange"],["for","tbp"],["id","tbp","name","totalbp","required","","type","text","pInputText","",1,"form-control",3,"disabled","ngModel","ngModelChange"],["id","tbp","name","totalVAT","required","","type","text","pInputText","",1,"form-control",3,"disabled","ngModel","ngModelChange"],[1,"ui-helper-clearfix"]],template:function(e,o){1&e&&(t.TgZ(0,"p-table",0,1),t.YNc(2,gt,10,0,"ng-template",2),t.YNc(3,vt,25,14,"ng-template",3),t.qZA(),t.YNc(4,At,9,18,"p-dialog",4),t.YNc(5,Ut,5,9,"p-dialog",4),t.YNc(6,Yt,15,12,"p-dialog",4),t.TgZ(7,"ngx-spinner",5),t._UZ(8,"p",6),t.qZA()),2&e&&(t.Q6J("value",o.invoices)("rowHover",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(12,y))("paginator",!0)("filterDelay",0)("globalFilterFields",t.DdM(13,M)),t.xp6(4),t.Q6J("ngIf",o.displayReviewDialog),t.xp6(1),t.Q6J("ngIf",o.displayInvoiceApproveDialog),t.xp6(1),t.Q6J("ngIf",o.displayItemFormDialog),t.xp6(1),t.Q6J("fullScreen",!0))},dependencies:[_.O5,b.Ro,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.Q7,c.c5,c.On,c.F,Y.V,T.$_,T.jx,C.Hq,C.zx,H.iA,O.o,ct.Lt,g.jt,g.iD,g.Vi,g.TH,_t.q,ut.EU,ht.c,_.JJ,_.rS,_.uU],styles:[".dropdown[_ngcontent-%COMP%]{z-index:20000!important}label[_ngcontent-%COMP%]{text-transform:none}[_nghost-%COMP%]     p-colorpicker .p-colorpicker .p-colorpicker-preview{border-radius:30px}[_nghost-%COMP%]     p-dialog .p-dialog-header{border-radius:30px!important}[_nghost-%COMP%]     .p-dialog .p-dialog-footer{border-bottom-right-radius:30px}"]}),s})();var Ot=l(2137),Gt=l(8639);let Kt=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[lt,dt.U]}),s})();t.B6R(B,[_.O5,b.Ro,c._Y,c.Fj,c.JJ,c.JL,c.Q7,c.On,c.F,Y.V,T.$_,T.jx,Ot.Q,C.Hq,H.iA,O.o,Gt.Ct,g.jt,g.iD,g.Vi,g.TH,Ht],[_.rS])}}]);